2024-10-03 17:29:21,981 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-03 17:29:21,981 - root - INFO - Data path is ../data.
2024-10-03 17:29:21,981 - root - INFO - Export path is ../log/mnist_test.
2024-10-03 17:29:21,981 - root - INFO - Dataset: ParT
2024-10-03 17:29:21,982 - root - INFO - Normal class: 0
2024-10-03 17:29:21,982 - root - INFO - Network: ParT
2024-10-03 17:29:21,982 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-03 17:29:21,982 - root - INFO - Nu-paramerter: 0.02
2024-10-03 17:29:22,033 - root - INFO - Computation device: cuda
2024-10-03 17:29:22,033 - root - INFO - Number of dataloader workers: 0
2024-10-03 17:29:22,033 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-03 17:29:22,377 - root - INFO - Pretraining: False
2024-10-03 17:29:22,378 - root - INFO - Training optimizer: adam
2024-10-03 17:29:22,378 - root - INFO - Training learning rate: 0.0001
2024-10-03 17:29:22,378 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-03 17:29:22,378 - root - INFO - Training batch size: 512
2024-10-03 17:29:22,378 - root - INFO - Training weight decay: 5e-07
2024-10-03 17:29:22,947 - root - INFO - Initializing center c...
2024-10-03 17:29:23,576 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_350pt.root"
  ]
}
2024-10-07 10:09:36,867 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-07 10:09:36,867 - root - INFO - Data path is ../data.
2024-10-07 10:09:36,867 - root - INFO - Export path is ../log/mnist_test.
2024-10-07 10:09:36,867 - root - INFO - Dataset: ParT
2024-10-07 10:09:36,867 - root - INFO - Normal class: 0
2024-10-07 10:09:36,867 - root - INFO - Network: ParT
2024-10-07 10:09:36,867 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-07 10:09:36,867 - root - INFO - Nu-paramerter: 0.02
2024-10-07 10:09:36,919 - root - INFO - Computation device: cuda
2024-10-07 10:09:36,920 - root - INFO - Number of dataloader workers: 0
2024-10-07 10:09:36,920 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-07 10:09:36,956 - root - INFO - Pretraining: False
2024-10-07 10:09:36,956 - root - INFO - Training optimizer: adam
2024-10-07 10:09:36,956 - root - INFO - Training learning rate: 0.0001
2024-10-07 10:09:36,956 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-07 10:09:36,956 - root - INFO - Training batch size: 512
2024-10-07 10:09:36,956 - root - INFO - Training weight decay: 5e-07
2024-10-07 10:09:37,120 - root - INFO - Initializing center c...
2024-10-07 10:09:37,192 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_350pt.root"
  ]
}
2024-10-08 10:07:02,274 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-08 10:07:02,275 - root - INFO - Data path is ../data.
2024-10-08 10:07:02,275 - root - INFO - Export path is ../log/mnist_test.
2024-10-08 10:07:02,275 - root - INFO - Dataset: ParT
2024-10-08 10:07:02,275 - root - INFO - Normal class: 0
2024-10-08 10:07:02,275 - root - INFO - Network: ParT
2024-10-08 10:07:02,275 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-08 10:07:02,275 - root - INFO - Nu-paramerter: 0.02
2024-10-08 10:07:02,325 - root - INFO - Computation device: cuda
2024-10-08 10:07:02,325 - root - INFO - Number of dataloader workers: 0
2024-10-08 10:07:02,325 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-08 10:07:02,359 - root - INFO - Pretraining: False
2024-10-08 10:07:02,359 - root - INFO - Training optimizer: adam
2024-10-08 10:07:02,359 - root - INFO - Training learning rate: 0.0001
2024-10-08 10:07:02,359 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-08 10:07:02,359 - root - INFO - Training batch size: 512
2024-10-08 10:07:02,359 - root - INFO - Training weight decay: 5e-07
2024-10-08 10:07:02,519 - root - INFO - Initializing center c...
2024-10-08 10:07:02,582 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_350pt.root"
  ]
}
2024-10-08 14:13:12,963 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-08 14:13:12,963 - root - INFO - Data path is ../data.
2024-10-08 14:13:12,963 - root - INFO - Export path is ../log/mnist_test.
2024-10-08 14:13:12,963 - root - INFO - Dataset: ParT
2024-10-08 14:13:12,963 - root - INFO - Normal class: 0
2024-10-08 14:13:12,963 - root - INFO - Network: ParT
2024-10-08 14:13:12,963 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-08 14:13:12,963 - root - INFO - Nu-paramerter: 0.02
2024-10-08 14:13:13,010 - root - INFO - Computation device: cuda
2024-10-08 14:13:13,010 - root - INFO - Number of dataloader workers: 0
2024-10-08 14:13:13,010 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-08 14:13:13,044 - root - INFO - Pretraining: False
2024-10-08 14:13:13,044 - root - INFO - Training optimizer: adam
2024-10-08 14:13:13,044 - root - INFO - Training learning rate: 0.0001
2024-10-08 14:13:13,044 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-08 14:13:13,044 - root - INFO - Training batch size: 512
2024-10-08 14:13:13,045 - root - INFO - Training weight decay: 5e-07
2024-10-08 14:13:13,219 - root - INFO - Initializing center c...
2024-10-08 14:13:13,299 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-08 14:45:43,107 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-08 14:45:43,107 - root - INFO - Data path is ../data.
2024-10-08 14:45:43,107 - root - INFO - Export path is ../log/mnist_test.
2024-10-08 14:45:43,107 - root - INFO - Dataset: ParT
2024-10-08 14:45:43,107 - root - INFO - Normal class: 0
2024-10-08 14:45:43,107 - root - INFO - Network: ParT
2024-10-08 14:45:43,108 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-08 14:45:43,108 - root - INFO - Nu-paramerter: 0.02
2024-10-08 14:45:43,156 - root - INFO - Computation device: cuda
2024-10-08 14:45:43,156 - root - INFO - Number of dataloader workers: 0
2024-10-08 14:45:43,156 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-08 14:45:43,190 - root - INFO - Pretraining: False
2024-10-08 14:45:43,190 - root - INFO - Training optimizer: adam
2024-10-08 14:45:43,190 - root - INFO - Training learning rate: 0.0001
2024-10-08 14:45:43,190 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-08 14:45:43,190 - root - INFO - Training batch size: 512
2024-10-08 14:45:43,190 - root - INFO - Training weight decay: 5e-07
2024-10-08 14:45:43,331 - root - INFO - Initializing center c...
2024-10-08 14:45:43,420 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-10 16:18:45,872 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-10 16:18:45,872 - root - INFO - Data path is ../data.
2024-10-10 16:18:45,873 - root - INFO - Export path is ../log/mnist_test.
2024-10-10 16:18:45,873 - root - INFO - Dataset: ParT
2024-10-10 16:18:45,873 - root - INFO - Normal class: 0
2024-10-10 16:18:45,873 - root - INFO - Network: ParT
2024-10-10 16:18:45,873 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-10 16:18:45,873 - root - INFO - Nu-paramerter: 0.02
2024-10-10 16:18:45,921 - root - INFO - Computation device: cuda
2024-10-10 16:18:45,921 - root - INFO - Number of dataloader workers: 0
2024-10-10 16:18:45,921 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-10 16:18:45,969 - root - INFO - Pretraining: False
2024-10-10 16:18:45,969 - root - INFO - Training optimizer: adam
2024-10-10 16:18:45,969 - root - INFO - Training learning rate: 0.0001
2024-10-10 16:18:45,969 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-10 16:18:45,969 - root - INFO - Training batch size: 512
2024-10-10 16:18:45,969 - root - INFO - Training weight decay: 5e-07
2024-10-10 16:18:46,121 - root - INFO - Initializing center c...
2024-10-10 16:18:46,198 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:16:57,646 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:16:57,646 - root - INFO - Data path is ../data.
2024-10-15 11:16:57,646 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:16:57,646 - root - INFO - Dataset: ParT
2024-10-15 11:16:57,646 - root - INFO - Normal class: 0
2024-10-15 11:16:57,647 - root - INFO - Network: ParT
2024-10-15 11:16:57,647 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:16:57,647 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:16:57,700 - root - INFO - Computation device: cuda
2024-10-15 11:16:57,701 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:16:57,701 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:16:57,739 - root - INFO - Pretraining: False
2024-10-15 11:16:57,739 - root - INFO - Training optimizer: adam
2024-10-15 11:16:57,739 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:16:57,739 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:16:57,739 - root - INFO - Training batch size: 512
2024-10-15 11:16:57,739 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:16:57,899 - root - INFO - Initializing center c...
2024-10-15 11:16:57,986 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:26:01,960 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:26:01,960 - root - INFO - Data path is ../data.
2024-10-15 11:26:01,960 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:26:01,960 - root - INFO - Dataset: ParT
2024-10-15 11:26:01,960 - root - INFO - Normal class: 0
2024-10-15 11:26:01,960 - root - INFO - Network: ParT
2024-10-15 11:26:01,960 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:26:01,960 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:26:02,011 - root - INFO - Computation device: cuda
2024-10-15 11:26:02,011 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:26:02,012 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:26:02,047 - root - INFO - Pretraining: False
2024-10-15 11:26:02,048 - root - INFO - Training optimizer: adam
2024-10-15 11:26:02,048 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:26:02,048 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:26:02,048 - root - INFO - Training batch size: 512
2024-10-15 11:26:02,048 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:26:02,224 - root - INFO - Initializing center c...
2024-10-15 11:26:02,297 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:26:51,605 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:26:51,605 - root - INFO - Data path is ../data.
2024-10-15 11:26:51,605 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:26:51,605 - root - INFO - Dataset: ParT
2024-10-15 11:26:51,605 - root - INFO - Normal class: 0
2024-10-15 11:26:51,605 - root - INFO - Network: ParT
2024-10-15 11:26:51,605 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:26:51,605 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:26:51,656 - root - INFO - Computation device: cuda
2024-10-15 11:26:51,656 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:26:51,656 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:26:51,691 - root - INFO - Pretraining: False
2024-10-15 11:26:51,691 - root - INFO - Training optimizer: adam
2024-10-15 11:26:51,691 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:26:51,691 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:26:51,691 - root - INFO - Training batch size: 512
2024-10-15 11:26:51,692 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:26:51,842 - root - INFO - Initializing center c...
2024-10-15 11:26:51,917 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:31:26,131 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:31:26,131 - root - INFO - Data path is ../data.
2024-10-15 11:31:26,131 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:31:26,131 - root - INFO - Dataset: ParT
2024-10-15 11:31:26,132 - root - INFO - Normal class: 0
2024-10-15 11:31:26,132 - root - INFO - Network: ParT
2024-10-15 11:31:26,132 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:31:26,133 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:31:26,185 - root - INFO - Computation device: cuda
2024-10-15 11:31:26,186 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:31:26,186 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:31:26,233 - root - INFO - Pretraining: False
2024-10-15 11:31:26,233 - root - INFO - Training optimizer: adam
2024-10-15 11:31:26,233 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:31:26,234 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:31:26,234 - root - INFO - Training batch size: 512
2024-10-15 11:31:26,234 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:31:26,399 - root - INFO - Initializing center c...
2024-10-15 11:31:26,489 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:25,981 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:40:25,981 - root - INFO - Data path is ../data.
2024-10-15 11:40:25,982 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:40:25,982 - root - INFO - Dataset: ParT
2024-10-15 11:40:25,983 - root - INFO - Normal class: 0
2024-10-15 11:40:25,983 - root - INFO - Network: ParT
2024-10-15 11:40:25,984 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:40:25,984 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:40:26,031 - root - INFO - Computation device: cuda
2024-10-15 11:40:26,031 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:40:26,031 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:40:26,079 - root - INFO - Pretraining: False
2024-10-15 11:40:26,079 - root - INFO - Training optimizer: adam
2024-10-15 11:40:26,079 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:40:26,079 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:40:26,080 - root - INFO - Training batch size: 512
2024-10-15 11:40:26,080 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:40:26,240 - root - INFO - Initializing center c...
2024-10-15 11:40:26,333 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:31,395 - root - INFO - Center c initialized.
2024-10-15 11:40:31,396 - root - INFO - Starting training...
2024-10-15 11:40:31,454 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:32,458 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:33,176 - root - INFO -   Epoch 1/220	 Time: 1.776	 Loss: 11095.47265625
2024-10-15 11:40:33,233 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:34,128 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:34,844 - root - INFO -   Epoch 2/220	 Time: 1.667	 Loss: 8283.50390625
2024-10-15 11:40:34,906 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:35,779 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:36,503 - root - INFO -   Epoch 3/220	 Time: 1.659	 Loss: 6430.45751953
2024-10-15 11:40:36,565 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:37,442 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:38,159 - root - INFO -   Epoch 4/220	 Time: 1.655	 Loss: 4510.06396484
2024-10-15 11:40:38,222 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:39,321 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:40,044 - root - INFO -   Epoch 5/220	 Time: 1.884	 Loss: 3495.28808594
2024-10-15 11:40:40,106 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:41,014 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:41,726 - root - INFO -   Epoch 6/220	 Time: 1.682	 Loss: 3117.86157227
2024-10-15 11:40:41,789 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:42,689 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:43,404 - root - INFO -   Epoch 7/220	 Time: 1.677	 Loss: 2617.21582031
2024-10-15 11:40:43,467 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:40:44,367 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:17,230 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:41:17,230 - root - INFO - Data path is ../data.
2024-10-15 11:41:17,230 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:41:17,231 - root - INFO - Dataset: ParT
2024-10-15 11:41:17,231 - root - INFO - Normal class: 0
2024-10-15 11:41:17,231 - root - INFO - Network: ParT
2024-10-15 11:41:17,232 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:41:17,232 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:41:17,263 - root - INFO - Computation device: cuda
2024-10-15 11:41:17,263 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:41:17,264 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:41:17,314 - root - INFO - Pretraining: False
2024-10-15 11:41:17,314 - root - INFO - Training optimizer: adam
2024-10-15 11:41:17,314 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:41:17,314 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:41:17,315 - root - INFO - Training batch size: 512
2024-10-15 11:41:17,315 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:41:17,449 - root - INFO - Initializing center c...
2024-10-15 11:41:17,511 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:22,899 - root - INFO - Center c initialized.
2024-10-15 11:41:22,899 - root - INFO - Starting training...
2024-10-15 11:41:22,956 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:23,961 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:24,673 - root - INFO -   Epoch 1/10	 Time: 1.771	 Loss: 13382.70605469
2024-10-15 11:41:24,732 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:25,632 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:26,352 - root - INFO -   Epoch 2/10	 Time: 1.678	 Loss: 8553.04687500
2024-10-15 11:41:26,418 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:27,317 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:28,034 - root - INFO -   Epoch 3/10	 Time: 1.681	 Loss: 6680.94482422
2024-10-15 11:41:28,095 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:29,000 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:29,718 - root - INFO -   Epoch 4/10	 Time: 1.684	 Loss: 5016.46191406
2024-10-15 11:41:29,779 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:30,686 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:31,404 - root - INFO -   Epoch 5/10	 Time: 1.685	 Loss: 4123.60937500
2024-10-15 11:41:31,467 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:32,344 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:33,065 - root - INFO -   Epoch 6/10	 Time: 1.660	 Loss: 3200.96215820
2024-10-15 11:41:33,126 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:34,041 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:34,761 - root - INFO -   Epoch 7/10	 Time: 1.696	 Loss: 2814.98388672
2024-10-15 11:41:34,822 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:35,739 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:36,461 - root - INFO -   Epoch 8/10	 Time: 1.699	 Loss: 2592.20263672
2024-10-15 11:41:36,522 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:37,438 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:38,156 - root - INFO -   Epoch 9/10	 Time: 1.695	 Loss: 2208.44506836
2024-10-15 11:41:38,217 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:39,133 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:39,853 - root - INFO -   Epoch 10/10	 Time: 1.696	 Loss: 1942.89892578
2024-10-15 11:41:39,854 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-15 11:41:39,854 - root - INFO - Final loss condition training = 70514.75383812189
2024-10-15 11:41:39,854 - root - INFO - Final loss condition validation = 19765.366871118546
2024-10-15 11:41:39,855 - root - INFO - Training time: 16.955
2024-10-15 11:41:39,855 - root - INFO - Finished training.
2024-10-15 11:41:39,872 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:41:39,873 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:41:39,873 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:41:39,873 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:41:39,874 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:41:39,874 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:41:39,874 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:41:39,875 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:41:39,875 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:41:39,875 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:41:39,876 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:41:39,888 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:41:39,889 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:41:39,889 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:41:39,889 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:41:39,890 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:41:39,890 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:41:39,890 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:41:39,891 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:41:39,891 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:41:39,891 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:41:39,891 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:41:39,893 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-15 11:41:39,905 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:41:39,905 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:41:39,905 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:41:39,906 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:41:39,906 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:41:39,906 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:41:39,907 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:41:39,907 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:41:39,908 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:41:39,908 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:41:39,908 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:41:39,921 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:41:39,921 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:41:39,921 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:41:39,921 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:41:39,922 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:41:39,922 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:41:39,922 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:41:39,922 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:41:39,923 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:41:39,924 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:41:39,924 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:41:39,928 - root - INFO - Starting testing...
2024-10-15 11:41:39,987 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:41:41,017 - root - INFO - Testing time: 1.088
2024-10-15 11:41:41,017 - root - INFO - Finished testing.
2024-10-15 11:41:41,260 - weaver - INFO - [1mWritten output to training/Test/20241015//114116_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-15 11:41:41,273 - weaver - INFO - [1mWritten output to training/Test/20241015//114116_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-15 11:43:04,856 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:43:04,856 - root - INFO - Data path is ../data.
2024-10-15 11:43:04,856 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:43:04,857 - root - INFO - Dataset: ParT
2024-10-15 11:43:04,857 - root - INFO - Normal class: 0
2024-10-15 11:43:04,857 - root - INFO - Network: ParT
2024-10-15 11:43:04,858 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:43:04,858 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:43:04,887 - root - INFO - Computation device: cuda
2024-10-15 11:43:04,887 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:43:04,887 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:43:04,938 - root - INFO - Pretraining: False
2024-10-15 11:43:04,938 - root - INFO - Training optimizer: adam
2024-10-15 11:43:04,938 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:43:04,938 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:43:04,938 - root - INFO - Training batch size: 512
2024-10-15 11:43:04,939 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:43:05,078 - root - INFO - Initializing center c...
2024-10-15 11:43:05,141 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:10,871 - root - INFO - Center c initialized.
2024-10-15 11:43:10,872 - root - INFO - Starting training...
2024-10-15 11:43:10,929 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:11,941 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:12,662 - root - INFO -   Epoch 1/10	 Time: 1.787	 Loss: 8503.93652344
2024-10-15 11:43:12,723 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:13,628 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:14,354 - root - INFO -   Epoch 2/10	 Time: 1.691	 Loss: 6340.36621094
2024-10-15 11:43:14,415 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:15,300 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:16,026 - root - INFO -   Epoch 3/10	 Time: 1.671	 Loss: 4357.23291016
2024-10-15 11:43:16,086 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:17,003 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:17,732 - root - INFO -   Epoch 4/10	 Time: 1.705	 Loss: 3272.99340820
2024-10-15 11:43:17,792 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:18,695 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:19,417 - root - INFO -   Epoch 5/10	 Time: 1.685	 Loss: 2703.94580078
2024-10-15 11:43:19,479 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:20,398 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:21,127 - root - INFO -   Epoch 6/10	 Time: 1.709	 Loss: 2417.65869141
2024-10-15 11:43:21,188 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:22,111 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:22,832 - root - INFO -   Epoch 7/10	 Time: 1.705	 Loss: 2110.86816406
2024-10-15 11:43:22,892 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:23,810 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:24,535 - root - INFO -   Epoch 8/10	 Time: 1.703	 Loss: 1829.94592285
2024-10-15 11:43:24,595 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:25,497 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:26,223 - root - INFO -   Epoch 9/10	 Time: 1.687	 Loss: 1647.89929199
2024-10-15 11:43:26,284 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:27,204 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 11:43:27,928 - root - INFO -   Epoch 10/10	 Time: 1.705	 Loss: 1546.04113770
2024-10-15 11:43:27,929 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-15 11:43:27,929 - root - INFO - Final loss condition training = 10375.083596765995
2024-10-15 11:43:27,929 - root - INFO - Final loss condition validation = 10408.233829081059
2024-10-15 11:43:27,930 - root - INFO - Training time: 17.058
2024-10-15 11:43:27,930 - root - INFO - Finished training.
2024-10-15 11:43:27,948 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:43:27,948 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:43:27,949 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:43:27,949 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:43:27,950 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:43:27,950 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:43:27,950 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:43:27,951 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:43:27,951 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:43:27,951 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:43:27,952 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:43:27,964 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:43:27,964 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:43:27,965 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:43:27,965 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:43:27,966 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:43:27,967 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:43:27,967 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:43:27,967 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:43:27,968 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:43:27,968 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:43:27,969 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:43:27,970 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-15 11:43:27,982 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:43:27,982 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:43:27,983 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:43:27,983 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:43:27,984 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:43:27,984 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:43:27,984 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:43:27,984 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:43:27,985 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:43:27,985 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:43:27,985 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:43:27,997 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 11:43:27,998 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 11:43:27,998 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 11:43:27,998 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 11:43:27,999 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 11:43:27,999 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 11:43:28,000 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 11:43:28,000 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 11:43:28,001 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 11:43:28,001 - weaver - INFO - [0;37mobserver_names: ('width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 11:43:28,002 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 11:43:28,006 - root - INFO - Starting testing...
2024-10-15 11:43:28,064 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 11:43:29,011 - root - INFO - Testing time: 1.005
2024-10-15 11:43:29,011 - root - INFO - Finished testing.
2024-10-15 11:43:29,130 - weaver - INFO - [1mWritten output to training/Test/20241015//114304_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-15 11:43:29,143 - weaver - INFO - [1mWritten output to training/Test/20241015//114304_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-15 11:49:50,666 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 11:49:50,666 - root - INFO - Data path is ../data.
2024-10-15 11:49:50,666 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 11:49:50,666 - root - INFO - Dataset: ParT
2024-10-15 11:49:50,667 - root - INFO - Normal class: 0
2024-10-15 11:49:50,667 - root - INFO - Network: ParT
2024-10-15 11:49:50,667 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 11:49:50,668 - root - INFO - Nu-paramerter: 0.02
2024-10-15 11:49:50,700 - root - INFO - Computation device: cuda
2024-10-15 11:49:50,700 - root - INFO - Number of dataloader workers: 0
2024-10-15 11:49:50,700 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 11:49:50,736 - root - INFO - Pretraining: False
2024-10-15 11:49:50,736 - root - INFO - Training optimizer: adam
2024-10-15 11:49:50,736 - root - INFO - Training learning rate: 0.0001
2024-10-15 11:49:50,736 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 11:49:50,737 - root - INFO - Training batch size: 512
2024-10-15 11:49:50,737 - root - INFO - Training weight decay: 5e-07
2024-10-15 11:49:50,875 - root - INFO - Initializing center c...
2024-10-15 11:49:50,975 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:04:00,904 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 12:04:00,904 - root - INFO - Data path is ../data.
2024-10-15 12:04:00,904 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 12:04:00,905 - root - INFO - Dataset: ParT
2024-10-15 12:04:00,905 - root - INFO - Normal class: 0
2024-10-15 12:04:00,905 - root - INFO - Network: ParT
2024-10-15 12:04:00,905 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 12:04:00,905 - root - INFO - Nu-paramerter: 0.02
2024-10-15 12:04:00,937 - root - INFO - Computation device: cuda
2024-10-15 12:04:00,937 - root - INFO - Number of dataloader workers: 0
2024-10-15 12:04:00,938 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 12:04:00,973 - root - INFO - Pretraining: False
2024-10-15 12:04:00,973 - root - INFO - Training optimizer: adam
2024-10-15 12:04:00,973 - root - INFO - Training learning rate: 0.0001
2024-10-15 12:04:00,974 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 12:04:00,974 - root - INFO - Training batch size: 512
2024-10-15 12:04:00,974 - root - INFO - Training weight decay: 5e-07
2024-10-15 12:04:01,109 - root - INFO - Initializing center c...
2024-10-15 12:04:01,179 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:01,246 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-15 12:14:01,246 - root - INFO - Data path is ../data.
2024-10-15 12:14:01,246 - root - INFO - Export path is ../log/mnist_test.
2024-10-15 12:14:01,247 - root - INFO - Dataset: ParT
2024-10-15 12:14:01,247 - root - INFO - Normal class: 0
2024-10-15 12:14:01,247 - root - INFO - Network: ParT
2024-10-15 12:14:01,248 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-15 12:14:01,248 - root - INFO - Nu-paramerter: 0.02
2024-10-15 12:14:01,278 - root - INFO - Computation device: cuda
2024-10-15 12:14:01,279 - root - INFO - Number of dataloader workers: 0
2024-10-15 12:14:01,279 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-15 12:14:01,314 - root - INFO - Pretraining: False
2024-10-15 12:14:01,314 - root - INFO - Training optimizer: adam
2024-10-15 12:14:01,314 - root - INFO - Training learning rate: 0.0001
2024-10-15 12:14:01,315 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-15 12:14:01,315 - root - INFO - Training batch size: 512
2024-10-15 12:14:01,315 - root - INFO - Training weight decay: 5e-07
2024-10-15 12:14:01,450 - root - INFO - Initializing center c...
2024-10-15 12:14:01,514 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:06,914 - root - INFO - Center c initialized.
2024-10-15 12:14:06,914 - root - INFO - Starting training...
2024-10-15 12:14:06,972 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:08,035 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:08,818 - root - INFO -   Epoch 1/10	 Time: 1.902	 Loss: 10022.05566406
2024-10-15 12:14:08,878 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:09,834 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:10,628 - root - INFO -   Epoch 2/10	 Time: 1.809	 Loss: 7098.89306641
2024-10-15 12:14:10,690 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:11,651 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:12,446 - root - INFO -   Epoch 3/10	 Time: 1.818	 Loss: 5277.06347656
2024-10-15 12:14:12,508 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:13,476 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:14,271 - root - INFO -   Epoch 4/10	 Time: 1.824	 Loss: 3727.91748047
2024-10-15 12:14:14,333 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:15,301 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:16,104 - root - INFO -   Epoch 5/10	 Time: 1.832	 Loss: 2984.66113281
2024-10-15 12:14:16,164 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:17,135 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:17,938 - root - INFO -   Epoch 6/10	 Time: 1.834	 Loss: 2792.82177734
2024-10-15 12:14:18,000 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:18,971 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:19,768 - root - INFO -   Epoch 7/10	 Time: 1.829	 Loss: 2279.70410156
2024-10-15 12:14:19,826 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:20,778 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:21,577 - root - INFO -   Epoch 8/10	 Time: 1.808	 Loss: 2061.23535156
2024-10-15 12:14:21,638 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:22,607 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:23,404 - root - INFO -   Epoch 9/10	 Time: 1.827	 Loss: 1976.43579102
2024-10-15 12:14:23,463 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:24,430 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-15 12:14:25,228 - root - INFO -   Epoch 10/10	 Time: 1.822	 Loss: 1793.12207031
2024-10-15 12:14:25,228 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-15 12:14:25,229 - root - INFO - Final loss condition training = 33603.92019802332
2024-10-15 12:14:25,229 - root - INFO - Final loss condition validation = 44854.03822697699
2024-10-15 12:14:25,230 - root - INFO - Training time: 18.315
2024-10-15 12:14:25,230 - root - INFO - Finished training.
2024-10-15 12:14:25,247 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 12:14:25,247 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 12:14:25,247 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 12:14:25,248 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 12:14:25,248 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 12:14:25,248 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 12:14:25,249 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 12:14:25,249 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 12:14:25,250 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 12:14:25,250 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 12:14:25,250 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 12:14:25,264 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 12:14:25,264 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 12:14:25,265 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 12:14:25,265 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 12:14:25,266 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 12:14:25,266 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 12:14:25,266 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 12:14:25,267 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 12:14:25,267 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 12:14:25,267 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 12:14:25,268 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 12:14:25,269 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-15 12:14:25,281 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 12:14:25,281 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 12:14:25,281 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 12:14:25,282 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 12:14:25,282 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 12:14:25,282 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 12:14:25,283 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 12:14:25,283 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 12:14:25,284 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 12:14:25,284 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 12:14:25,285 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 12:14:25,297 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-15 12:14:25,297 - weaver - INFO - [0;37mselection: None[0m
2024-10-15 12:14:25,297 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-15 12:14:25,298 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-15 12:14:25,298 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-15 12:14:25,298 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-15 12:14:25,298 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-15 12:14:25,299 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-15 12:14:25,299 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-15 12:14:25,300 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-15 12:14:25,300 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-15 12:14:25,304 - root - INFO - Starting testing...
2024-10-15 12:14:25,365 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-15 12:14:26,309 - root - INFO - Testing time: 1.004
2024-10-15 12:14:26,309 - root - INFO - Finished testing.
2024-10-15 12:14:26,427 - weaver - INFO - [1mWritten output to training/Test/20241015//121400_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-15 12:14:26,440 - weaver - INFO - [1mWritten output to training/Test/20241015//121400_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-25 14:45:25,085 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-25 14:45:25,085 - root - INFO - Data path is ../data.
2024-10-25 14:45:25,085 - root - INFO - Export path is ../log/mnist_test.
2024-10-25 14:45:25,086 - root - INFO - Dataset: ParT
2024-10-25 14:45:25,086 - root - INFO - Normal class: 0
2024-10-25 14:45:25,086 - root - INFO - Network: ParT
2024-10-25 14:45:25,087 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-25 14:45:25,087 - root - INFO - Nu-paramerter: 0.10
2024-10-25 14:45:25,134 - root - INFO - Computation device: cuda
2024-10-25 14:45:25,134 - root - INFO - Number of dataloader workers: 0
2024-10-25 14:45:25,134 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-25 14:45:25,180 - root - INFO - Pretraining: False
2024-10-25 14:45:25,180 - root - INFO - Training optimizer: adam
2024-10-25 14:45:25,180 - root - INFO - Training learning rate: 0.001
2024-10-25 14:45:25,181 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-25 14:45:25,181 - root - INFO - Training batch size: 512
2024-10-25 14:45:25,182 - root - INFO - Training weight decay: 0.01
2024-10-25 14:45:25,328 - root - INFO - Initializing center c...
2024-10-25 14:45:25,389 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:30,690 - root - INFO - Center c initialized.
2024-10-25 14:45:30,691 - root - INFO - Starting training...
2024-10-25 14:45:30,745 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:31,793 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:32,568 - root - INFO -   Epoch 1/10	 Time: 1.875	 Loss: 2088.65649414
2024-10-25 14:45:32,626 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:33,572 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:34,368 - root - INFO -   Epoch 2/10	 Time: 1.799	 Loss: 13569.03515625
2024-10-25 14:45:34,427 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:35,391 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:36,181 - root - INFO -   Epoch 3/10	 Time: 1.813	 Loss: 4068.38159180
2024-10-25 14:45:36,242 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:37,198 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:37,986 - root - INFO -   Epoch 4/10	 Time: 1.804	 Loss: 5260.79833984
2024-10-25 14:45:38,046 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:39,001 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:39,790 - root - INFO -   Epoch 5/10	 Time: 1.803	 Loss: 3639.99975586
2024-10-25 14:45:39,849 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:40,800 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:41,580 - root - INFO -   Epoch 6/10	 Time: 1.790	 Loss: 2735.80224609
2024-10-25 14:45:41,640 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:42,591 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:43,377 - root - INFO -   Epoch 7/10	 Time: 1.795	 Loss: 1872.97338867
2024-10-25 14:45:43,436 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:44,394 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:45,180 - root - INFO -   Epoch 8/10	 Time: 1.803	 Loss: 1119.86071777
2024-10-25 14:45:45,239 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:46,194 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:46,977 - root - INFO -   Epoch 9/10	 Time: 1.796	 Loss: 654.20379639
2024-10-25 14:45:47,035 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:47,998 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 14:45:48,787 - root - INFO -   Epoch 10/10	 Time: 1.809	 Loss: 534.80285645
2024-10-25 14:45:48,787 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-25 14:45:48,789 - root - INFO - Final loss condition training = 14256.584458891302
2024-10-25 14:45:48,789 - root - INFO - Final loss condition validation = 11711.112908139825
2024-10-25 14:45:48,790 - root - INFO - Training time: 18.099
2024-10-25 14:45:48,790 - root - INFO - Finished training.
2024-10-25 14:45:48,807 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 14:45:48,808 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 14:45:48,808 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 14:45:48,808 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 14:45:48,809 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 14:45:48,810 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 14:45:48,811 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 14:45:48,811 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 14:45:48,812 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 14:45:48,813 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 14:45:48,813 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 14:45:48,827 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 14:45:48,828 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 14:45:48,828 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 14:45:48,829 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 14:45:48,830 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 14:45:48,830 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 14:45:48,831 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 14:45:48,831 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 14:45:48,831 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 14:45:48,831 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 14:45:48,832 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 14:45:48,833 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-25 14:45:48,845 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 14:45:48,845 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 14:45:48,846 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 14:45:48,846 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 14:45:48,847 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 14:45:48,847 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 14:45:48,848 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 14:45:48,848 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 14:45:48,849 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 14:45:48,849 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 14:45:48,849 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 14:45:48,862 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 14:45:48,862 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 14:45:48,862 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 14:45:48,863 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 14:45:48,863 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 14:45:48,864 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 14:45:48,864 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 14:45:48,864 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 14:45:48,865 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 14:45:48,865 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 14:45:48,866 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 14:45:48,870 - root - INFO - Starting testing...
2024-10-25 14:45:48,925 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-25 14:45:49,864 - root - INFO - Testing time: 0.994
2024-10-25 14:45:49,865 - root - INFO - Finished testing.
2024-10-25 14:45:49,988 - weaver - INFO - [1mWritten output to training/Test/20241025//144524_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-25 14:45:50,001 - weaver - INFO - [1mWritten output to training/Test/20241025//144524_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-25 15:03:11,714 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-25 15:03:11,714 - root - INFO - Data path is ../data.
2024-10-25 15:03:11,714 - root - INFO - Export path is ../log/mnist_test.
2024-10-25 15:03:11,714 - root - INFO - Dataset: ParT
2024-10-25 15:03:11,714 - root - INFO - Normal class: 0
2024-10-25 15:03:11,715 - root - INFO - Network: ParT
2024-10-25 15:03:11,715 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-25 15:03:11,715 - root - INFO - Nu-paramerter: 0.10
2024-10-25 15:03:11,767 - root - INFO - Computation device: cuda
2024-10-25 15:03:11,767 - root - INFO - Number of dataloader workers: 0
2024-10-25 15:03:11,767 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-25 15:03:11,802 - root - INFO - Pretraining: False
2024-10-25 15:03:11,802 - root - INFO - Training optimizer: adam
2024-10-25 15:03:11,802 - root - INFO - Training learning rate: 0.001
2024-10-25 15:03:11,803 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-25 15:03:11,803 - root - INFO - Training batch size: 512
2024-10-25 15:03:11,803 - root - INFO - Training weight decay: 0.01
2024-10-25 15:03:11,970 - root - INFO - Initializing center c...
2024-10-25 15:03:12,034 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:17,374 - root - INFO - Center c initialized.
2024-10-25 15:03:17,374 - root - INFO - Starting training...
2024-10-25 15:03:17,429 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:18,477 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:19,251 - root - INFO -   Epoch 1/10	 Time: 1.874	 Loss: 3000.73999023
2024-10-25 15:03:19,309 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:20,210 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:20,988 - root - INFO -   Epoch 2/10	 Time: 1.736	 Loss: 9418.29199219
2024-10-25 15:03:21,045 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:21,981 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:22,761 - root - INFO -   Epoch 3/10	 Time: 1.773	 Loss: 5603.76708984
2024-10-25 15:03:22,820 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:23,771 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:24,554 - root - INFO -   Epoch 4/10	 Time: 1.792	 Loss: 4828.88916016
2024-10-25 15:03:24,613 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:25,565 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:26,348 - root - INFO -   Epoch 5/10	 Time: 1.793	 Loss: 3665.86718750
2024-10-25 15:03:26,406 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:27,357 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:28,137 - root - INFO -   Epoch 6/10	 Time: 1.788	 Loss: 2048.75390625
2024-10-25 15:03:28,196 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:29,181 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:30,161 - root - INFO -   Epoch 7/10	 Time: 2.023	 Loss: 1306.68273926
2024-10-25 15:03:30,219 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:31,161 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:31,941 - root - INFO -   Epoch 8/10	 Time: 1.780	 Loss: 986.30383301
2024-10-25 15:03:32,001 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:32,951 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:33,732 - root - INFO -   Epoch 9/10	 Time: 1.790	 Loss: 690.49206543
2024-10-25 15:03:33,791 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:34,738 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:03:35,518 - root - INFO -   Epoch 10/10	 Time: 1.786	 Loss: 674.70202637
2024-10-25 15:03:35,519 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-25 15:03:35,519 - root - INFO - Final loss condition training = 249.32533359527588
2024-10-25 15:03:35,519 - root - INFO - Final loss condition validation = 4703.361062049866
2024-10-25 15:03:35,520 - root - INFO - Training time: 18.145
2024-10-25 15:03:35,520 - root - INFO - Finished training.
2024-10-25 15:03:35,538 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:03:35,538 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:03:35,538 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:03:35,539 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:03:35,539 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:03:35,539 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:03:35,540 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:03:35,540 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:03:35,540 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:03:35,541 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:03:35,541 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:03:35,555 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:03:35,555 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:03:35,555 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:03:35,555 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:03:35,555 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:03:35,556 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:03:35,557 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:03:35,557 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:03:35,557 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:03:35,557 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:03:35,558 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:03:35,559 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-25 15:03:35,571 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:03:35,571 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:03:35,571 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:03:35,572 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:03:35,572 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:03:35,572 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:03:35,573 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:03:35,573 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:03:35,573 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:03:35,574 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:03:35,574 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:03:35,586 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:03:35,586 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:03:35,587 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:03:35,587 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:03:35,588 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:03:35,588 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:03:35,588 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:03:35,589 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:03:35,589 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:03:35,589 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:03:35,590 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:03:35,593 - root - INFO - Starting testing...
2024-10-25 15:03:35,650 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-25 15:03:36,585 - root - INFO - Testing time: 0.992
2024-10-25 15:03:36,585 - root - INFO - Finished testing.
2024-10-25 15:03:36,709 - weaver - INFO - [1mWritten output to training/Test/20241025//150311_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-25 15:03:36,724 - weaver - INFO - [1mWritten output to training/Test/20241025//150311_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-25 15:34:40,442 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-25 15:34:40,442 - root - INFO - Data path is ../data.
2024-10-25 15:34:40,442 - root - INFO - Export path is ../log/mnist_test.
2024-10-25 15:34:40,442 - root - INFO - Dataset: ParT
2024-10-25 15:34:40,443 - root - INFO - Normal class: 0
2024-10-25 15:34:40,443 - root - INFO - Network: ParT
2024-10-25 15:34:40,443 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-25 15:34:40,444 - root - INFO - Nu-paramerter: 0.43
2024-10-25 15:34:40,495 - root - INFO - Computation device: cuda
2024-10-25 15:34:40,496 - root - INFO - Number of dataloader workers: 0
2024-10-25 15:34:40,496 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-25 15:34:40,531 - root - INFO - Pretraining: False
2024-10-25 15:34:40,531 - root - INFO - Training optimizer: adam
2024-10-25 15:34:40,531 - root - INFO - Training learning rate: 0.00106108
2024-10-25 15:34:40,532 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-25 15:34:40,532 - root - INFO - Training batch size: 512
2024-10-25 15:34:40,533 - root - INFO - Training weight decay: 0.055769
2024-10-25 15:34:40,689 - root - INFO - Initializing center c...
2024-10-25 15:34:40,752 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:46,084 - root - INFO - Center c initialized.
2024-10-25 15:34:46,084 - root - INFO - Starting training...
2024-10-25 15:34:46,139 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:47,170 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:47,941 - root - INFO -   Epoch 1/10	 Time: 1.854	 Loss: 628.50982666
2024-10-25 15:34:47,998 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:48,932 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:49,710 - root - INFO -   Epoch 2/10	 Time: 1.768	 Loss: 2744.06469727
2024-10-25 15:34:49,766 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:50,658 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:51,434 - root - INFO -   Epoch 3/10	 Time: 1.724	 Loss: 1432.77478027
2024-10-25 15:34:51,492 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:52,431 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:53,211 - root - INFO -   Epoch 4/10	 Time: 1.777	 Loss: 1205.13598633
2024-10-25 15:34:53,269 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:54,185 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:54,964 - root - INFO -   Epoch 5/10	 Time: 1.752	 Loss: 860.94616699
2024-10-25 15:34:55,022 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:55,967 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:56,749 - root - INFO -   Epoch 6/10	 Time: 1.785	 Loss: 688.13018799
2024-10-25 15:34:56,806 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:57,751 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:58,527 - root - INFO -   Epoch 7/10	 Time: 1.778	 Loss: 476.77700806
2024-10-25 15:34:58,582 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:34:59,521 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:35:00,301 - root - INFO -   Epoch 8/10	 Time: 1.773	 Loss: 311.26660156
2024-10-25 15:35:00,359 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:35:01,305 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:35:02,088 - root - INFO -   Epoch 9/10	 Time: 1.787	 Loss: 186.92884827
2024-10-25 15:35:02,147 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:35:03,100 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:35:03,879 - root - INFO -   Epoch 10/10	 Time: 1.790	 Loss: 148.73309326
2024-10-25 15:35:03,879 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-25 15:35:03,880 - root - INFO - Final loss condition training = 1458.9157003930304
2024-10-25 15:35:03,880 - root - INFO - Final loss condition validation = 561.8135407278314
2024-10-25 15:35:03,881 - root - INFO - Training time: 17.796
2024-10-25 15:35:03,881 - root - INFO - Finished training.
2024-10-25 15:35:03,899 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:35:03,899 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:35:03,900 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:35:03,900 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:35:03,901 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:35:03,901 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:35:03,901 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:35:03,902 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:35:03,902 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:35:03,902 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:35:03,903 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:35:03,918 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:35:03,918 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:35:03,918 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:35:03,919 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:35:03,919 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:35:03,920 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:35:03,920 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:35:03,921 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:35:03,921 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:35:03,922 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:35:03,922 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:35:03,924 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-25 15:35:03,936 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:35:03,936 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:35:03,936 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:35:03,937 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:35:03,937 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:35:03,937 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:35:03,938 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:35:03,938 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:35:03,938 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:35:03,939 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:35:03,939 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:35:03,952 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:35:03,952 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:35:03,953 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:35:03,954 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:35:03,955 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:35:03,955 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:35:03,956 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:35:03,957 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:35:03,958 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:35:03,958 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:35:03,958 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:35:03,963 - root - INFO - Starting testing...
2024-10-25 15:35:04,019 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-25 15:35:04,962 - root - INFO - Testing time: 0.999
2024-10-25 15:35:04,962 - root - INFO - Finished testing.
2024-10-25 15:35:05,085 - weaver - INFO - [1mWritten output to training/Test/20241025//153440_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-25 15:35:05,102 - weaver - INFO - [1mWritten output to training/Test/20241025//153440_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-25 15:38:35,506 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-25 15:38:35,506 - root - INFO - Data path is ../data.
2024-10-25 15:38:35,506 - root - INFO - Export path is ../log/mnist_test.
2024-10-25 15:38:35,506 - root - INFO - Dataset: ParT
2024-10-25 15:38:35,507 - root - INFO - Normal class: 0
2024-10-25 15:38:35,507 - root - INFO - Network: ParT
2024-10-25 15:38:35,507 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-25 15:38:35,508 - root - INFO - Nu-paramerter: 0.54
2024-10-25 15:38:35,560 - root - INFO - Computation device: cuda
2024-10-25 15:38:35,560 - root - INFO - Number of dataloader workers: 0
2024-10-25 15:38:35,561 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-25 15:38:35,606 - root - INFO - Pretraining: False
2024-10-25 15:38:35,607 - root - INFO - Training optimizer: adam
2024-10-25 15:38:35,607 - root - INFO - Training learning rate: 7.00212e-06
2024-10-25 15:38:35,607 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-25 15:38:35,607 - root - INFO - Training batch size: 512
2024-10-25 15:38:35,608 - root - INFO - Training weight decay: 2.81085e-06
2024-10-25 15:38:35,779 - root - INFO - Initializing center c...
2024-10-25 15:38:35,840 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:41,186 - root - INFO - Center c initialized.
2024-10-25 15:38:41,186 - root - INFO - Starting training...
2024-10-25 15:38:41,241 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:42,300 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:43,090 - root - INFO -   Epoch 1/10	 Time: 1.901	 Loss: 458.69030762
2024-10-25 15:38:43,146 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:44,093 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:44,889 - root - INFO -   Epoch 2/10	 Time: 1.799	 Loss: 437.67694092
2024-10-25 15:38:44,947 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:45,899 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:46,694 - root - INFO -   Epoch 3/10	 Time: 1.804	 Loss: 421.56991577
2024-10-25 15:38:46,752 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:47,704 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:48,501 - root - INFO -   Epoch 4/10	 Time: 1.806	 Loss: 392.04434204
2024-10-25 15:38:48,560 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:49,490 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:50,288 - root - INFO -   Epoch 5/10	 Time: 1.786	 Loss: 377.65893555
2024-10-25 15:38:50,347 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:51,313 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:52,108 - root - INFO -   Epoch 6/10	 Time: 1.819	 Loss: 364.58087158
2024-10-25 15:38:52,166 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:53,107 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:53,907 - root - INFO -   Epoch 7/10	 Time: 1.798	 Loss: 350.58236694
2024-10-25 15:38:53,965 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:54,918 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:55,719 - root - INFO -   Epoch 8/10	 Time: 1.812	 Loss: 336.29214478
2024-10-25 15:38:55,778 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:56,724 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:57,519 - root - INFO -   Epoch 9/10	 Time: 1.799	 Loss: 324.45291138
2024-10-25 15:38:57,578 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:58,542 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-25 15:38:59,337 - root - INFO -   Epoch 10/10	 Time: 1.817	 Loss: 318.56411743
2024-10-25 15:38:59,337 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-25 15:38:59,337 - root - INFO - Final loss condition training = 34.67789413034916
2024-10-25 15:38:59,338 - root - INFO - Final loss condition validation = 61.33115328848362
2024-10-25 15:38:59,338 - root - INFO - Training time: 18.152
2024-10-25 15:38:59,339 - root - INFO - Finished training.
2024-10-25 15:38:59,356 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:38:59,357 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:38:59,357 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:38:59,357 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:38:59,357 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:38:59,357 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:38:59,358 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:38:59,358 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:38:59,358 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:38:59,359 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:38:59,359 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:38:59,373 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:38:59,373 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:38:59,373 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:38:59,374 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:38:59,374 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:38:59,374 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:38:59,375 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:38:59,375 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:38:59,376 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:38:59,376 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:38:59,376 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:38:59,377 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-25 15:38:59,389 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:38:59,389 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:38:59,389 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:38:59,389 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:38:59,390 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:38:59,390 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:38:59,391 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:38:59,391 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:38:59,391 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:38:59,391 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:38:59,392 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:38:59,404 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-25 15:38:59,404 - weaver - INFO - [0;37mselection: None[0m
2024-10-25 15:38:59,404 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-25 15:38:59,405 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-25 15:38:59,405 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-25 15:38:59,405 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-25 15:38:59,406 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-25 15:38:59,406 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-25 15:38:59,407 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-25 15:38:59,407 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-25 15:38:59,407 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-25 15:38:59,411 - root - INFO - Starting testing...
2024-10-25 15:38:59,468 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-25 15:39:00,404 - root - INFO - Testing time: 0.993
2024-10-25 15:39:00,404 - root - INFO - Finished testing.
2024-10-25 15:39:00,529 - weaver - INFO - [1mWritten output to training/Test/20241025//153835_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-25 15:39:00,543 - weaver - INFO - [1mWritten output to training/Test/20241025//153835_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 09:58:55,944 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 09:58:55,944 - root - INFO - Data path is ../data.
2024-10-28 09:58:55,944 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 09:58:55,944 - root - INFO - Dataset: ParT
2024-10-28 09:58:55,944 - root - INFO - Normal class: 0
2024-10-28 09:58:55,944 - root - INFO - Network: ParT
2024-10-28 09:58:55,944 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 09:58:55,945 - root - INFO - Nu-paramerter: 0.44
2024-10-28 09:58:55,995 - root - INFO - Computation device: cuda
2024-10-28 09:58:55,995 - root - INFO - Number of dataloader workers: 0
2024-10-28 09:58:55,996 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 09:58:56,031 - root - INFO - Pretraining: False
2024-10-28 09:58:56,031 - root - INFO - Training optimizer: adam
2024-10-28 09:58:56,031 - root - INFO - Training learning rate: 0.076868
2024-10-28 09:58:56,031 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 09:58:56,031 - root - INFO - Training batch size: 512
2024-10-28 09:58:56,031 - root - INFO - Training weight decay: 0.000140122
2024-10-28 09:58:56,187 - root - INFO - Initializing center c...
2024-10-28 09:58:56,250 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:01,578 - root - INFO - Center c initialized.
2024-10-28 09:59:01,578 - root - INFO - Starting training...
2024-10-28 09:59:01,634 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:02,684 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:03,461 - root - INFO -   Epoch 1/10	 Time: 1.880	 Loss: 406.19198608
2024-10-28 09:59:03,523 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:04,466 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:05,250 - root - INFO -   Epoch 2/10	 Time: 1.788	 Loss: 150780.89062500
2024-10-28 09:59:05,308 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:06,247 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:07,033 - root - INFO -   Epoch 3/10	 Time: 1.782	 Loss: 88427.71093750
2024-10-28 09:59:07,091 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:08,036 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:08,824 - root - INFO -   Epoch 4/10	 Time: 1.790	 Loss: 271059.43750000
2024-10-28 09:59:08,881 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:09,825 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:10,609 - root - INFO -   Epoch 5/10	 Time: 1.784	 Loss: 75308.25000000
2024-10-28 09:59:10,668 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:11,611 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:12,398 - root - INFO -   Epoch 6/10	 Time: 1.789	 Loss: 199018.73437500
2024-10-28 09:59:12,457 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:13,383 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:14,171 - root - INFO -   Epoch 7/10	 Time: 1.772	 Loss: 244245.54687500
2024-10-28 09:59:14,230 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:15,176 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:15,964 - root - INFO -   Epoch 8/10	 Time: 1.792	 Loss: 52426.05859375
2024-10-28 09:59:16,022 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:16,969 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:17,758 - root - INFO -   Epoch 9/10	 Time: 1.793	 Loss: 84383.54687500
2024-10-28 09:59:17,816 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:18,772 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 09:59:19,562 - root - INFO -   Epoch 10/10	 Time: 1.804	 Loss: 38818.11328125
2024-10-28 09:59:19,562 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 09:59:19,562 - root - INFO - Final loss condition training = 2076208738.586441
2024-10-28 09:59:19,562 - root - INFO - Final loss condition validation = 405623533.60328674
2024-10-28 09:59:19,563 - root - INFO - Training time: 17.985
2024-10-28 09:59:19,563 - root - INFO - Finished training.
2024-10-28 09:59:19,581 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 09:59:19,581 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 09:59:19,581 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 09:59:19,582 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 09:59:19,582 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 09:59:19,583 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 09:59:19,583 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 09:59:19,583 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 09:59:19,584 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 09:59:19,584 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 09:59:19,585 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 09:59:19,599 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 09:59:19,599 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 09:59:19,599 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 09:59:19,599 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 09:59:19,600 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 09:59:19,600 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 09:59:19,601 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 09:59:19,601 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 09:59:19,601 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 09:59:19,602 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 09:59:19,602 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 09:59:19,604 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 09:59:19,616 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 09:59:19,616 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 09:59:19,616 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 09:59:19,616 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 09:59:19,616 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 09:59:19,617 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 09:59:19,617 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 09:59:19,617 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 09:59:19,617 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 09:59:19,617 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 09:59:19,618 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 09:59:19,630 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 09:59:19,630 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 09:59:19,630 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 09:59:19,631 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 09:59:19,631 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 09:59:19,632 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 09:59:19,632 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 09:59:19,632 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 09:59:19,633 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 09:59:19,633 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 09:59:19,633 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 09:59:19,638 - root - INFO - Starting testing...
2024-10-28 09:59:19,693 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 09:59:20,630 - root - INFO - Testing time: 0.992
2024-10-28 09:59:20,631 - root - INFO - Finished testing.
2024-10-28 09:59:20,756 - weaver - INFO - [1mWritten output to training/Test/20241028//095855_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 09:59:20,771 - weaver - INFO - [1mWritten output to training/Test/20241028//095855_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:03:22,363 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:03:22,363 - root - INFO - Data path is ../data.
2024-10-28 10:03:22,363 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:03:22,363 - root - INFO - Dataset: ParT
2024-10-28 10:03:22,363 - root - INFO - Normal class: 0
2024-10-28 10:03:22,363 - root - INFO - Network: ParT
2024-10-28 10:03:22,363 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:03:22,363 - root - INFO - Nu-paramerter: 0.45
2024-10-28 10:03:22,414 - root - INFO - Computation device: cuda
2024-10-28 10:03:22,415 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:03:22,415 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:03:22,450 - root - INFO - Pretraining: False
2024-10-28 10:03:22,450 - root - INFO - Training optimizer: adam
2024-10-28 10:03:22,450 - root - INFO - Training learning rate: 2.82852e-05
2024-10-28 10:03:22,450 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:03:22,450 - root - INFO - Training batch size: 512
2024-10-28 10:03:22,450 - root - INFO - Training weight decay: 5.62856e-06
2024-10-28 10:03:22,598 - root - INFO - Initializing center c...
2024-10-28 10:03:22,678 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:28,746 - root - INFO - Center c initialized.
2024-10-28 10:03:28,746 - root - INFO - Starting training...
2024-10-28 10:03:28,802 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:29,844 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:30,617 - root - INFO -   Epoch 1/10	 Time: 1.868	 Loss: 562.00830078
2024-10-28 10:03:30,675 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:31,602 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:32,380 - root - INFO -   Epoch 2/10	 Time: 1.763	 Loss: 446.19274902
2024-10-28 10:03:32,439 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:33,382 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:34,155 - root - INFO -   Epoch 3/10	 Time: 1.774	 Loss: 374.91336060
2024-10-28 10:03:34,214 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:35,108 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:35,882 - root - INFO -   Epoch 4/10	 Time: 1.727	 Loss: 320.89392090
2024-10-28 10:03:35,942 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:36,883 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:37,665 - root - INFO -   Epoch 5/10	 Time: 1.782	 Loss: 281.45019531
2024-10-28 10:03:37,724 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:38,674 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:39,450 - root - INFO -   Epoch 6/10	 Time: 1.784	 Loss: 251.68550110
2024-10-28 10:03:39,508 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:40,452 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:41,236 - root - INFO -   Epoch 7/10	 Time: 1.786	 Loss: 227.22703552
2024-10-28 10:03:41,296 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:42,230 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:43,009 - root - INFO -   Epoch 8/10	 Time: 1.772	 Loss: 202.48518372
2024-10-28 10:03:43,069 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:44,029 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:44,813 - root - INFO -   Epoch 9/10	 Time: 1.803	 Loss: 181.77481079
2024-10-28 10:03:44,871 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:45,839 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:03:46,622 - root - INFO -   Epoch 10/10	 Time: 1.808	 Loss: 167.03295898
2024-10-28 10:03:46,623 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:03:46,623 - root - INFO - Final loss condition training = 217.32219468895346
2024-10-28 10:03:46,623 - root - INFO - Final loss condition validation = 75.65012671262957
2024-10-28 10:03:46,623 - root - INFO - Training time: 17.877
2024-10-28 10:03:46,623 - root - INFO - Finished training.
2024-10-28 10:03:46,641 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:03:46,641 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:03:46,641 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:03:46,642 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:03:46,642 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:03:46,642 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:03:46,643 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:03:46,643 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:03:46,644 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:03:46,644 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:03:46,644 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:03:46,658 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:03:46,658 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:03:46,658 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:03:46,659 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:03:46,659 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:03:46,659 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:03:46,659 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:03:46,660 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:03:46,660 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:03:46,660 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:03:46,661 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:03:46,662 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:03:46,674 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:03:46,674 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:03:46,674 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:03:46,674 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:03:46,675 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:03:46,675 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:03:46,676 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:03:46,676 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:03:46,676 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:03:46,676 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:03:46,677 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:03:46,689 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:03:46,689 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:03:46,689 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:03:46,689 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:03:46,690 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:03:46,690 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:03:46,690 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:03:46,690 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:03:46,691 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:03:46,692 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:03:46,692 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:03:46,696 - root - INFO - Starting testing...
2024-10-28 10:03:46,752 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:03:47,684 - root - INFO - Testing time: 0.987
2024-10-28 10:03:47,684 - root - INFO - Finished testing.
2024-10-28 10:03:47,803 - weaver - INFO - [1mWritten output to training/Test/20241028//100322_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:03:47,817 - weaver - INFO - [1mWritten output to training/Test/20241028//100322_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:03:57,675 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:03:57,675 - root - INFO - Data path is ../data.
2024-10-28 10:03:57,675 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:03:57,675 - root - INFO - Dataset: ParT
2024-10-28 10:03:57,675 - root - INFO - Normal class: 0
2024-10-28 10:03:57,675 - root - INFO - Network: ParT
2024-10-28 10:03:57,675 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:03:57,675 - root - INFO - Nu-paramerter: 0.40
2024-10-28 10:03:57,727 - root - INFO - Computation device: cuda
2024-10-28 10:03:57,727 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:03:57,727 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:03:57,762 - root - INFO - Pretraining: False
2024-10-28 10:03:57,762 - root - INFO - Training optimizer: adam
2024-10-28 10:03:57,762 - root - INFO - Training learning rate: 0.0187717
2024-10-28 10:03:57,763 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:03:57,763 - root - INFO - Training batch size: 512
2024-10-28 10:03:57,763 - root - INFO - Training weight decay: 2.29167e-07
2024-10-28 10:03:57,908 - root - INFO - Initializing center c...
2024-10-28 10:03:57,969 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:03,296 - root - INFO - Center c initialized.
2024-10-28 10:04:03,297 - root - INFO - Starting training...
2024-10-28 10:04:03,356 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:04,396 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:05,173 - root - INFO -   Epoch 1/10	 Time: 1.874	 Loss: 488.27178955
2024-10-28 10:04:05,231 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:06,148 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:06,933 - root - INFO -   Epoch 2/10	 Time: 1.759	 Loss: 75908.25781250
2024-10-28 10:04:06,993 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:07,945 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:08,735 - root - INFO -   Epoch 3/10	 Time: 1.801	 Loss: 10789.11425781
2024-10-28 10:04:08,794 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:09,750 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:10,532 - root - INFO -   Epoch 4/10	 Time: 1.797	 Loss: 7223.26025391
2024-10-28 10:04:10,593 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:11,537 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:12,331 - root - INFO -   Epoch 5/10	 Time: 1.798	 Loss: 6334.52441406
2024-10-28 10:04:12,392 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:13,349 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:14,134 - root - INFO -   Epoch 6/10	 Time: 1.802	 Loss: 11964.33398438
2024-10-28 10:04:14,194 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:15,149 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:15,940 - root - INFO -   Epoch 7/10	 Time: 1.805	 Loss: 9746.22363281
2024-10-28 10:04:16,000 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:16,913 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:17,705 - root - INFO -   Epoch 8/10	 Time: 1.765	 Loss: 7682.56640625
2024-10-28 10:04:17,763 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:18,721 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:19,510 - root - INFO -   Epoch 9/10	 Time: 1.804	 Loss: 6171.97314453
2024-10-28 10:04:19,569 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:20,502 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:21,288 - root - INFO -   Epoch 10/10	 Time: 1.778	 Loss: 16298.33105469
2024-10-28 10:04:21,288 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:04:21,289 - root - INFO - Final loss condition training = 102543124.52458405
2024-10-28 10:04:21,289 - root - INFO - Final loss condition validation = 97425517.16320896
2024-10-28 10:04:21,289 - root - INFO - Training time: 17.992
2024-10-28 10:04:21,289 - root - INFO - Finished training.
2024-10-28 10:04:21,307 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:21,308 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:21,308 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:21,308 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:21,309 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:21,309 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:21,309 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:21,310 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:21,310 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:21,311 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:21,311 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:21,325 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:21,325 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:21,325 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:21,325 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:21,326 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:21,326 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:21,327 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:21,327 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:21,327 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:21,328 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:21,328 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:21,330 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:04:21,341 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:21,342 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:21,342 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:21,342 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:21,343 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:21,343 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:21,343 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:21,343 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:21,344 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:21,344 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:21,344 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:21,356 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:21,357 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:21,357 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:21,357 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:21,357 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:21,358 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:21,358 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:21,358 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:21,359 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:21,359 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:21,360 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:21,364 - root - INFO - Starting testing...
2024-10-28 10:04:21,420 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:04:22,365 - root - INFO - Testing time: 1.001
2024-10-28 10:04:22,365 - root - INFO - Finished testing.
2024-10-28 10:04:22,483 - weaver - INFO - [1mWritten output to training/Test/20241028//100357_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:04:22,497 - weaver - INFO - [1mWritten output to training/Test/20241028//100357_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:04:32,939 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:04:32,939 - root - INFO - Data path is ../data.
2024-10-28 10:04:32,939 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:04:32,939 - root - INFO - Dataset: ParT
2024-10-28 10:04:32,939 - root - INFO - Normal class: 0
2024-10-28 10:04:32,939 - root - INFO - Network: ParT
2024-10-28 10:04:32,939 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:04:32,939 - root - INFO - Nu-paramerter: 0.66
2024-10-28 10:04:32,991 - root - INFO - Computation device: cuda
2024-10-28 10:04:32,991 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:04:32,991 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:04:33,026 - root - INFO - Pretraining: False
2024-10-28 10:04:33,026 - root - INFO - Training optimizer: adam
2024-10-28 10:04:33,026 - root - INFO - Training learning rate: 0.000278942
2024-10-28 10:04:33,026 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:04:33,026 - root - INFO - Training batch size: 512
2024-10-28 10:04:33,026 - root - INFO - Training weight decay: 0.00157972
2024-10-28 10:04:33,174 - root - INFO - Initializing center c...
2024-10-28 10:04:33,269 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:38,540 - root - INFO - Center c initialized.
2024-10-28 10:04:38,540 - root - INFO - Starting training...
2024-10-28 10:04:38,597 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:39,613 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:40,384 - root - INFO -   Epoch 1/10	 Time: 1.842	 Loss: 305.09603882
2024-10-28 10:04:40,438 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:41,378 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:42,157 - root - INFO -   Epoch 2/10	 Time: 1.772	 Loss: 411.24819946
2024-10-28 10:04:42,212 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:43,158 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:43,948 - root - INFO -   Epoch 3/10	 Time: 1.791	 Loss: 262.25537109
2024-10-28 10:04:44,007 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:44,929 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:45,710 - root - INFO -   Epoch 4/10	 Time: 1.761	 Loss: 198.30915833
2024-10-28 10:04:45,769 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:46,710 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:47,492 - root - INFO -   Epoch 5/10	 Time: 1.782	 Loss: 159.69635010
2024-10-28 10:04:47,551 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:48,514 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:49,294 - root - INFO -   Epoch 6/10	 Time: 1.801	 Loss: 116.95296478
2024-10-28 10:04:49,354 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:50,305 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:51,089 - root - INFO -   Epoch 7/10	 Time: 1.794	 Loss: 101.36809540
2024-10-28 10:04:51,149 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:52,095 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:52,876 - root - INFO -   Epoch 8/10	 Time: 1.787	 Loss: 87.88767242
2024-10-28 10:04:52,932 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:53,882 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:54,672 - root - INFO -   Epoch 9/10	 Time: 1.795	 Loss: 70.76270294
2024-10-28 10:04:54,732 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:55,675 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:04:56,465 - root - INFO -   Epoch 10/10	 Time: 1.792	 Loss: 64.64334106
2024-10-28 10:04:56,465 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:04:56,465 - root - INFO - Final loss condition training = 37.44658978708321
2024-10-28 10:04:56,465 - root - INFO - Final loss condition validation = 0.9736409928300418
2024-10-28 10:04:56,466 - root - INFO - Training time: 17.926
2024-10-28 10:04:56,466 - root - INFO - Finished training.
2024-10-28 10:04:56,479 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:56,480 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:56,480 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:56,480 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:56,480 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:56,481 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:56,481 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:56,481 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:56,481 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:56,482 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:56,482 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:56,492 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:56,492 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:56,492 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:56,493 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:56,493 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:56,493 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:56,494 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:56,494 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:56,494 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:56,494 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:56,495 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:56,496 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:04:56,505 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:56,505 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:56,505 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:56,505 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:56,506 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:56,506 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:56,506 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:56,506 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:56,507 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:56,507 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:56,507 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:56,516 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:04:56,516 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:04:56,517 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:04:56,517 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:04:56,517 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:04:56,517 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:04:56,518 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:04:56,518 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:04:56,518 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:04:56,519 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:04:56,519 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:04:56,522 - root - INFO - Starting testing...
2024-10-28 10:04:56,576 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:04:57,513 - root - INFO - Testing time: 0.991
2024-10-28 10:04:57,513 - root - INFO - Finished testing.
2024-10-28 10:04:57,631 - weaver - INFO - [1mWritten output to training/Test/20241028//100432_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:04:57,644 - weaver - INFO - [1mWritten output to training/Test/20241028//100432_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:05:07,308 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:05:07,308 - root - INFO - Data path is ../data.
2024-10-28 10:05:07,308 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:05:07,308 - root - INFO - Dataset: ParT
2024-10-28 10:05:07,308 - root - INFO - Normal class: 0
2024-10-28 10:05:07,308 - root - INFO - Network: ParT
2024-10-28 10:05:07,308 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:05:07,308 - root - INFO - Nu-paramerter: 0.46
2024-10-28 10:05:07,360 - root - INFO - Computation device: cuda
2024-10-28 10:05:07,360 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:05:07,361 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:05:07,395 - root - INFO - Pretraining: False
2024-10-28 10:05:07,396 - root - INFO - Training optimizer: adam
2024-10-28 10:05:07,396 - root - INFO - Training learning rate: 0.0169347
2024-10-28 10:05:07,396 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:05:07,396 - root - INFO - Training batch size: 512
2024-10-28 10:05:07,396 - root - INFO - Training weight decay: 9.03748e-05
2024-10-28 10:05:07,550 - root - INFO - Initializing center c...
2024-10-28 10:05:07,611 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:12,917 - root - INFO - Center c initialized.
2024-10-28 10:05:12,917 - root - INFO - Starting training...
2024-10-28 10:05:12,973 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:14,023 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:14,806 - root - INFO -   Epoch 1/10	 Time: 1.886	 Loss: 501.52175903
2024-10-28 10:05:14,864 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:15,794 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:16,587 - root - INFO -   Epoch 2/10	 Time: 1.781	 Loss: 48191.80468750
2024-10-28 10:05:16,647 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:17,582 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:18,367 - root - INFO -   Epoch 3/10	 Time: 1.780	 Loss: 11726.75292969
2024-10-28 10:05:18,428 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:19,366 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:20,158 - root - INFO -   Epoch 4/10	 Time: 1.790	 Loss: 5667.96093750
2024-10-28 10:05:20,218 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:21,159 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:21,949 - root - INFO -   Epoch 5/10	 Time: 1.790	 Loss: 9078.46582031
2024-10-28 10:05:22,008 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:22,926 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:23,705 - root - INFO -   Epoch 6/10	 Time: 1.756	 Loss: 16891.56054688
2024-10-28 10:05:23,764 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:24,706 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:25,486 - root - INFO -   Epoch 7/10	 Time: 1.780	 Loss: 23857.39257812
2024-10-28 10:05:25,546 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:26,479 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:27,258 - root - INFO -   Epoch 8/10	 Time: 1.771	 Loss: 24745.98046875
2024-10-28 10:05:27,318 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:28,221 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:29,004 - root - INFO -   Epoch 9/10	 Time: 1.745	 Loss: 15529.21484375
2024-10-28 10:05:29,063 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:29,989 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:30,768 - root - INFO -   Epoch 10/10	 Time: 1.763	 Loss: 22176.80664062
2024-10-28 10:05:30,768 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:05:30,768 - root - INFO - Final loss condition training = 44190476.69787979
2024-10-28 10:05:30,768 - root - INFO - Final loss condition validation = 217813.62994766235
2024-10-28 10:05:30,769 - root - INFO - Training time: 17.852
2024-10-28 10:05:30,769 - root - INFO - Finished training.
2024-10-28 10:05:30,786 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:05:30,787 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:05:30,787 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:05:30,787 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:05:30,788 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:05:30,788 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:05:30,789 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:05:30,789 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:05:30,789 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:05:30,790 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:05:30,790 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:05:30,804 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:05:30,805 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:05:30,805 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:05:30,805 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:05:30,806 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:05:30,806 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:05:30,806 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:05:30,807 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:05:30,807 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:05:30,808 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:05:30,808 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:05:30,810 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:05:30,821 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:05:30,821 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:05:30,822 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:05:30,822 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:05:30,823 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:05:30,823 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:05:30,824 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:05:30,824 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:05:30,824 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:05:30,825 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:05:30,825 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:05:30,838 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:05:30,838 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:05:30,838 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:05:30,838 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:05:30,839 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:05:30,839 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:05:30,839 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:05:30,840 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:05:30,840 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:05:30,841 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:05:30,841 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:05:30,845 - root - INFO - Starting testing...
2024-10-28 10:05:30,901 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:05:31,836 - root - INFO - Testing time: 0.991
2024-10-28 10:05:31,837 - root - INFO - Finished testing.
2024-10-28 10:05:31,951 - weaver - INFO - [1mWritten output to training/Test/20241028//100507_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:05:31,965 - weaver - INFO - [1mWritten output to training/Test/20241028//100507_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:05:42,324 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:05:42,324 - root - INFO - Data path is ../data.
2024-10-28 10:05:42,324 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:05:42,324 - root - INFO - Dataset: ParT
2024-10-28 10:05:42,324 - root - INFO - Normal class: 0
2024-10-28 10:05:42,324 - root - INFO - Network: ParT
2024-10-28 10:05:42,324 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:05:42,324 - root - INFO - Nu-paramerter: 0.56
2024-10-28 10:05:42,376 - root - INFO - Computation device: cuda
2024-10-28 10:05:42,376 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:05:42,376 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:05:42,411 - root - INFO - Pretraining: False
2024-10-28 10:05:42,411 - root - INFO - Training optimizer: adam
2024-10-28 10:05:42,411 - root - INFO - Training learning rate: 0.000153867
2024-10-28 10:05:42,411 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:05:42,411 - root - INFO - Training batch size: 512
2024-10-28 10:05:42,411 - root - INFO - Training weight decay: 0.000503689
2024-10-28 10:05:42,557 - root - INFO - Initializing center c...
2024-10-28 10:05:42,618 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:48,713 - root - INFO - Center c initialized.
2024-10-28 10:05:48,713 - root - INFO - Starting training...
2024-10-28 10:05:48,770 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:49,830 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:50,605 - root - INFO -   Epoch 1/10	 Time: 1.889	 Loss: 364.75283813
2024-10-28 10:05:50,667 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:51,613 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:52,400 - root - INFO -   Epoch 2/10	 Time: 1.795	 Loss: 410.98989868
2024-10-28 10:05:52,460 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:53,397 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:54,177 - root - INFO -   Epoch 3/10	 Time: 1.776	 Loss: 214.91545105
2024-10-28 10:05:54,236 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:55,176 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:55,962 - root - INFO -   Epoch 4/10	 Time: 1.785	 Loss: 200.02854919
2024-10-28 10:05:56,024 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:56,966 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:57,760 - root - INFO -   Epoch 5/10	 Time: 1.798	 Loss: 151.73554993
2024-10-28 10:05:57,821 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:58,755 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:05:59,539 - root - INFO -   Epoch 6/10	 Time: 1.778	 Loss: 108.89979553
2024-10-28 10:05:59,599 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:00,548 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:01,337 - root - INFO -   Epoch 7/10	 Time: 1.798	 Loss: 95.84976959
2024-10-28 10:06:01,396 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:02,341 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:03,122 - root - INFO -   Epoch 8/10	 Time: 1.785	 Loss: 91.40587616
2024-10-28 10:06:03,183 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:04,121 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:04,904 - root - INFO -   Epoch 9/10	 Time: 1.781	 Loss: 82.80646515
2024-10-28 10:06:04,964 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:05,903 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:06,684 - root - INFO -   Epoch 10/10	 Time: 1.780	 Loss: 73.55122375
2024-10-28 10:06:06,684 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:06:06,685 - root - INFO - Final loss condition training = 85.65949326200644
2024-10-28 10:06:06,685 - root - INFO - Final loss condition validation = 120.50686638109619
2024-10-28 10:06:06,685 - root - INFO - Training time: 17.971
2024-10-28 10:06:06,685 - root - INFO - Finished training.
2024-10-28 10:06:06,703 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:06,703 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:06,703 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:06,704 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:06,704 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:06,704 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:06,704 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:06,705 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:06,705 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:06,705 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:06,705 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:06,719 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:06,719 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:06,719 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:06,720 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:06,720 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:06,721 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:06,721 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:06,721 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:06,721 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:06,722 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:06,722 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:06,724 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:06:06,735 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:06,736 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:06,736 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:06,736 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:06,737 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:06,737 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:06,737 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:06,737 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:06,738 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:06,738 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:06,738 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:06,751 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:06,751 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:06,751 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:06,751 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:06,752 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:06,752 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:06,752 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:06,753 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:06,753 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:06,753 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:06,754 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:06,758 - root - INFO - Starting testing...
2024-10-28 10:06:06,815 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:06:07,753 - root - INFO - Testing time: 0.995
2024-10-28 10:06:07,753 - root - INFO - Finished testing.
2024-10-28 10:06:07,869 - weaver - INFO - [1mWritten output to training/Test/20241028//100542_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:06:07,884 - weaver - INFO - [1mWritten output to training/Test/20241028//100542_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:06:17,837 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:06:17,837 - root - INFO - Data path is ../data.
2024-10-28 10:06:17,837 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:06:17,837 - root - INFO - Dataset: ParT
2024-10-28 10:06:17,837 - root - INFO - Normal class: 0
2024-10-28 10:06:17,837 - root - INFO - Network: ParT
2024-10-28 10:06:17,837 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:06:17,837 - root - INFO - Nu-paramerter: 0.51
2024-10-28 10:06:17,889 - root - INFO - Computation device: cuda
2024-10-28 10:06:17,889 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:06:17,890 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:06:17,924 - root - INFO - Pretraining: False
2024-10-28 10:06:17,925 - root - INFO - Training optimizer: adam
2024-10-28 10:06:17,925 - root - INFO - Training learning rate: 3.59027e-06
2024-10-28 10:06:17,925 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:06:17,925 - root - INFO - Training batch size: 512
2024-10-28 10:06:17,925 - root - INFO - Training weight decay: 5.43763e-06
2024-10-28 10:06:18,078 - root - INFO - Initializing center c...
2024-10-28 10:06:18,139 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:24,343 - root - INFO - Center c initialized.
2024-10-28 10:06:24,343 - root - INFO - Starting training...
2024-10-28 10:06:24,402 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:25,474 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:26,253 - root - INFO -   Epoch 1/10	 Time: 1.906	 Loss: 422.78991699
2024-10-28 10:06:26,313 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:27,261 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:28,045 - root - INFO -   Epoch 2/10	 Time: 1.792	 Loss: 405.99386597
2024-10-28 10:06:28,106 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:29,051 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:29,835 - root - INFO -   Epoch 3/10	 Time: 1.789	 Loss: 396.18350220
2024-10-28 10:06:29,896 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:30,838 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:31,624 - root - INFO -   Epoch 4/10	 Time: 1.789	 Loss: 381.77078247
2024-10-28 10:06:31,685 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:32,632 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:33,420 - root - INFO -   Epoch 5/10	 Time: 1.795	 Loss: 372.39962769
2024-10-28 10:06:33,479 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:34,424 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:35,213 - root - INFO -   Epoch 6/10	 Time: 1.792	 Loss: 358.30166626
2024-10-28 10:06:35,272 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:36,217 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:37,004 - root - INFO -   Epoch 7/10	 Time: 1.790	 Loss: 343.85922241
2024-10-28 10:06:37,064 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:38,006 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:38,795 - root - INFO -   Epoch 8/10	 Time: 1.791	 Loss: 340.36944580
2024-10-28 10:06:38,855 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:39,798 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:40,582 - root - INFO -   Epoch 9/10	 Time: 1.786	 Loss: 331.84823608
2024-10-28 10:06:40,642 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:41,583 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:42,369 - root - INFO -   Epoch 10/10	 Time: 1.787	 Loss: 321.69638062
2024-10-28 10:06:42,369 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:06:42,369 - root - INFO - Final loss condition training = 103.06016945838928
2024-10-28 10:06:42,369 - root - INFO - Final loss condition validation = 62.57443434000015
2024-10-28 10:06:42,370 - root - INFO - Training time: 18.026
2024-10-28 10:06:42,370 - root - INFO - Finished training.
2024-10-28 10:06:42,388 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:42,389 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:42,389 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:42,389 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:42,390 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:42,390 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:42,391 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:42,391 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:42,391 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:42,392 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:42,392 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:42,406 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:42,406 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:42,406 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:42,406 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:42,407 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:42,407 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:42,407 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:42,407 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:42,408 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:42,408 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:42,408 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:42,409 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:06:42,421 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:42,421 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:42,421 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:42,422 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:42,422 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:42,422 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:42,423 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:42,423 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:42,423 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:42,423 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:42,424 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:42,436 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:06:42,436 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:06:42,436 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:06:42,437 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:06:42,437 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:06:42,438 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:06:42,438 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:06:42,438 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:06:42,439 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:06:42,439 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:06:42,440 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:06:42,444 - root - INFO - Starting testing...
2024-10-28 10:06:42,502 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:06:43,450 - root - INFO - Testing time: 1.006
2024-10-28 10:06:43,451 - root - INFO - Finished testing.
2024-10-28 10:06:43,585 - weaver - INFO - [1mWritten output to training/Test/20241028//100617_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:06:43,599 - weaver - INFO - [1mWritten output to training/Test/20241028//100617_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:06:53,850 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:06:53,850 - root - INFO - Data path is ../data.
2024-10-28 10:06:53,850 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:06:53,850 - root - INFO - Dataset: ParT
2024-10-28 10:06:53,850 - root - INFO - Normal class: 0
2024-10-28 10:06:53,850 - root - INFO - Network: ParT
2024-10-28 10:06:53,850 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:06:53,850 - root - INFO - Nu-paramerter: 0.10
2024-10-28 10:06:53,902 - root - INFO - Computation device: cuda
2024-10-28 10:06:53,902 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:06:53,903 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:06:53,938 - root - INFO - Pretraining: False
2024-10-28 10:06:53,938 - root - INFO - Training optimizer: adam
2024-10-28 10:06:53,938 - root - INFO - Training learning rate: 4.54095e-07
2024-10-28 10:06:53,938 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:06:53,938 - root - INFO - Training batch size: 512
2024-10-28 10:06:53,938 - root - INFO - Training weight decay: 0.024517
2024-10-28 10:06:54,087 - root - INFO - Initializing center c...
2024-10-28 10:06:54,148 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:06:59,563 - root - INFO - Center c initialized.
2024-10-28 10:06:59,563 - root - INFO - Starting training...
2024-10-28 10:06:59,621 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:00,673 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:01,455 - root - INFO -   Epoch 1/10	 Time: 1.889	 Loss: 2368.33398438
2024-10-28 10:07:01,515 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:02,468 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:03,255 - root - INFO -   Epoch 2/10	 Time: 1.799	 Loss: 2379.98437500
2024-10-28 10:07:03,314 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:04,250 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:05,038 - root - INFO -   Epoch 3/10	 Time: 1.782	 Loss: 2368.80468750
2024-10-28 10:07:05,097 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:06,015 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:06,802 - root - INFO -   Epoch 4/10	 Time: 1.764	 Loss: 2331.19531250
2024-10-28 10:07:06,863 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:07,779 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:08,562 - root - INFO -   Epoch 5/10	 Time: 1.759	 Loss: 2352.14843750
2024-10-28 10:07:08,622 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:09,577 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:10,372 - root - INFO -   Epoch 6/10	 Time: 1.810	 Loss: 2337.36328125
2024-10-28 10:07:10,434 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:11,369 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:12,165 - root - INFO -   Epoch 7/10	 Time: 1.792	 Loss: 2299.91210938
2024-10-28 10:07:12,226 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:13,175 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:13,965 - root - INFO -   Epoch 8/10	 Time: 1.799	 Loss: 2281.99291992
2024-10-28 10:07:14,026 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:14,990 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:15,784 - root - INFO -   Epoch 9/10	 Time: 1.819	 Loss: 2329.01318359
2024-10-28 10:07:15,845 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:16,806 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:17,595 - root - INFO -   Epoch 10/10	 Time: 1.810	 Loss: 2300.56518555
2024-10-28 10:07:17,596 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:07:17,596 - root - INFO - Final loss condition training = 809.2885928750038
2024-10-28 10:07:17,596 - root - INFO - Final loss condition validation = 3460.0732941776514
2024-10-28 10:07:17,597 - root - INFO - Training time: 18.033
2024-10-28 10:07:17,597 - root - INFO - Finished training.
2024-10-28 10:07:17,614 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:17,614 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:17,614 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:17,615 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:17,615 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:17,616 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:17,616 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:17,616 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:17,617 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:17,617 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:17,618 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:17,632 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:17,632 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:17,632 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:17,632 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:17,633 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:17,633 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:17,633 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:17,634 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:17,634 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:17,635 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:17,635 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:17,637 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:07:17,648 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:17,648 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:17,648 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:17,649 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:17,650 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:17,650 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:17,650 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:17,651 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:17,651 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:17,652 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:17,652 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:17,664 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:17,665 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:17,665 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:17,665 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:17,666 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:17,666 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:17,666 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:17,667 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:17,667 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:17,668 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:17,668 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:17,672 - root - INFO - Starting testing...
2024-10-28 10:07:17,731 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:07:18,675 - root - INFO - Testing time: 1.003
2024-10-28 10:07:18,676 - root - INFO - Finished testing.
2024-10-28 10:07:18,795 - weaver - INFO - [1mWritten output to training/Test/20241028//100653_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:07:18,809 - weaver - INFO - [1mWritten output to training/Test/20241028//100653_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:07:28,643 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:07:28,643 - root - INFO - Data path is ../data.
2024-10-28 10:07:28,643 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:07:28,643 - root - INFO - Dataset: ParT
2024-10-28 10:07:28,643 - root - INFO - Normal class: 0
2024-10-28 10:07:28,644 - root - INFO - Network: ParT
2024-10-28 10:07:28,644 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:07:28,644 - root - INFO - Nu-paramerter: 0.53
2024-10-28 10:07:28,698 - root - INFO - Computation device: cuda
2024-10-28 10:07:28,698 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:07:28,699 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:07:28,747 - root - INFO - Pretraining: False
2024-10-28 10:07:28,747 - root - INFO - Training optimizer: adam
2024-10-28 10:07:28,747 - root - INFO - Training learning rate: 6.22658e-05
2024-10-28 10:07:28,747 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:07:28,747 - root - INFO - Training batch size: 512
2024-10-28 10:07:28,747 - root - INFO - Training weight decay: 9.54278e-05
2024-10-28 10:07:28,896 - root - INFO - Initializing center c...
2024-10-28 10:07:28,956 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:34,640 - root - INFO - Center c initialized.
2024-10-28 10:07:34,640 - root - INFO - Starting training...
2024-10-28 10:07:34,698 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:35,746 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:36,524 - root - INFO -   Epoch 1/10	 Time: 1.881	 Loss: 374.89523315
2024-10-28 10:07:36,584 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:37,507 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:38,291 - root - INFO -   Epoch 2/10	 Time: 1.766	 Loss: 263.87048340
2024-10-28 10:07:38,349 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:39,278 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:40,067 - root - INFO -   Epoch 3/10	 Time: 1.776	 Loss: 192.87799072
2024-10-28 10:07:40,158 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:41,295 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:42,081 - root - INFO -   Epoch 4/10	 Time: 2.014	 Loss: 151.80790710
2024-10-28 10:07:42,141 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:43,082 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:43,877 - root - INFO -   Epoch 5/10	 Time: 1.795	 Loss: 123.91058350
2024-10-28 10:07:43,937 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:44,903 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:45,690 - root - INFO -   Epoch 6/10	 Time: 1.813	 Loss: 103.60266876
2024-10-28 10:07:45,750 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:46,706 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:47,489 - root - INFO -   Epoch 7/10	 Time: 1.798	 Loss: 90.36042023
2024-10-28 10:07:47,549 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:48,511 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:49,296 - root - INFO -   Epoch 8/10	 Time: 1.806	 Loss: 81.81366730
2024-10-28 10:07:49,357 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:50,314 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:51,099 - root - INFO -   Epoch 9/10	 Time: 1.802	 Loss: 73.19057465
2024-10-28 10:07:51,161 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:52,106 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:07:52,891 - root - INFO -   Epoch 10/10	 Time: 1.791	 Loss: 67.34081268
2024-10-28 10:07:52,891 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:07:52,891 - root - INFO - Final loss condition training = 34.21971502248198
2024-10-28 10:07:52,891 - root - INFO - Final loss condition validation = 36.63171450630762
2024-10-28 10:07:52,892 - root - INFO - Training time: 18.251
2024-10-28 10:07:52,892 - root - INFO - Finished training.
2024-10-28 10:07:52,910 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:52,910 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:52,911 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:52,911 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:52,911 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:52,912 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:52,912 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:52,912 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:52,913 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:52,913 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:52,913 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:52,927 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:52,927 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:52,928 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:52,928 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:52,928 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:52,929 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:52,929 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:52,929 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:52,930 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:52,930 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:52,930 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:52,932 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:07:52,944 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:52,944 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:52,944 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:52,944 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:52,945 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:52,945 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:52,946 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:52,946 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:52,946 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:52,947 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:52,947 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:52,959 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:07:52,960 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:07:52,960 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:07:52,960 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:07:52,961 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:07:52,961 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:07:52,961 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:07:52,962 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:07:52,962 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:07:52,963 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:07:52,963 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:07:52,967 - root - INFO - Starting testing...
2024-10-28 10:07:53,025 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:07:53,966 - root - INFO - Testing time: 0.998
2024-10-28 10:07:53,966 - root - INFO - Finished testing.
2024-10-28 10:07:54,084 - weaver - INFO - [1mWritten output to training/Test/20241028//100728_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:07:54,097 - weaver - INFO - [1mWritten output to training/Test/20241028//100728_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:08:04,358 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:08:04,359 - root - INFO - Data path is ../data.
2024-10-28 10:08:04,359 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:08:04,359 - root - INFO - Dataset: ParT
2024-10-28 10:08:04,359 - root - INFO - Normal class: 0
2024-10-28 10:08:04,359 - root - INFO - Network: ParT
2024-10-28 10:08:04,359 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:08:04,359 - root - INFO - Nu-paramerter: 0.90
2024-10-28 10:08:04,410 - root - INFO - Computation device: cuda
2024-10-28 10:08:04,410 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:08:04,410 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:08:04,445 - root - INFO - Pretraining: False
2024-10-28 10:08:04,445 - root - INFO - Training optimizer: adam
2024-10-28 10:08:04,445 - root - INFO - Training learning rate: 1.08451e-07
2024-10-28 10:08:04,445 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:08:04,445 - root - INFO - Training batch size: 512
2024-10-28 10:08:04,445 - root - INFO - Training weight decay: 0.000258508
2024-10-28 10:08:04,594 - root - INFO - Initializing center c...
2024-10-28 10:08:04,656 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:09,928 - root - INFO - Center c initialized.
2024-10-28 10:08:09,929 - root - INFO - Starting training...
2024-10-28 10:08:09,986 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:11,017 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:11,790 - root - INFO -   Epoch 1/10	 Time: 1.859	 Loss: 253.48832703
2024-10-28 10:08:11,850 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:12,793 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:13,579 - root - INFO -   Epoch 2/10	 Time: 1.788	 Loss: 250.41685486
2024-10-28 10:08:13,639 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:14,593 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:15,382 - root - INFO -   Epoch 3/10	 Time: 1.803	 Loss: 251.90068054
2024-10-28 10:08:15,444 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:16,400 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:17,183 - root - INFO -   Epoch 4/10	 Time: 1.800	 Loss: 253.23110962
2024-10-28 10:08:17,245 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:18,154 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:18,938 - root - INFO -   Epoch 5/10	 Time: 1.754	 Loss: 254.61677551
2024-10-28 10:08:18,999 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:19,956 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:20,743 - root - INFO -   Epoch 6/10	 Time: 1.804	 Loss: 251.85273743
2024-10-28 10:08:20,805 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:21,741 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:22,525 - root - INFO -   Epoch 7/10	 Time: 1.781	 Loss: 250.22026062
2024-10-28 10:08:22,586 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:23,537 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:24,322 - root - INFO -   Epoch 8/10	 Time: 1.797	 Loss: 251.84164429
2024-10-28 10:08:24,384 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:25,341 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:26,130 - root - INFO -   Epoch 9/10	 Time: 1.807	 Loss: 250.20800781
2024-10-28 10:08:26,191 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:27,149 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:27,937 - root - INFO -   Epoch 10/10	 Time: 1.807	 Loss: 252.86795044
2024-10-28 10:08:27,937 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:08:27,937 - root - INFO - Final loss condition training = 7.0752947786822915
2024-10-28 10:08:27,937 - root - INFO - Final loss condition validation = 2.338468917645514
2024-10-28 10:08:27,938 - root - INFO - Training time: 18.009
2024-10-28 10:08:27,938 - root - INFO - Finished training.
2024-10-28 10:08:27,956 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:08:27,956 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:08:27,956 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:08:27,957 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:08:27,957 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:08:27,957 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:08:27,958 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:08:27,958 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:08:27,959 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:08:27,959 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:08:27,959 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:08:27,973 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:08:27,973 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:08:27,973 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:08:27,974 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:08:27,974 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:08:27,974 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:08:27,975 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:08:27,975 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:08:27,975 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:08:27,976 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:08:27,976 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:08:27,977 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:08:27,989 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:08:27,989 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:08:27,989 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:08:27,990 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:08:27,990 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:08:27,990 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:08:27,991 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:08:27,991 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:08:27,991 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:08:27,992 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:08:27,992 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:08:28,004 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:08:28,005 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:08:28,005 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:08:28,005 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:08:28,006 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:08:28,006 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:08:28,007 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:08:28,007 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:08:28,007 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:08:28,008 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:08:28,008 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:08:28,012 - root - INFO - Starting testing...
2024-10-28 10:08:28,071 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:08:29,016 - root - INFO - Testing time: 1.004
2024-10-28 10:08:29,016 - root - INFO - Finished testing.
2024-10-28 10:08:29,133 - weaver - INFO - [1mWritten output to training/Test/20241028//100804_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:08:29,147 - weaver - INFO - [1mWritten output to training/Test/20241028//100804_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:08:38,800 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:08:38,800 - root - INFO - Data path is ../data.
2024-10-28 10:08:38,801 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:08:38,801 - root - INFO - Dataset: ParT
2024-10-28 10:08:38,801 - root - INFO - Normal class: 0
2024-10-28 10:08:38,801 - root - INFO - Network: ParT
2024-10-28 10:08:38,801 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:08:38,801 - root - INFO - Nu-paramerter: 0.66
2024-10-28 10:08:38,852 - root - INFO - Computation device: cuda
2024-10-28 10:08:38,852 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:08:38,853 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:08:38,887 - root - INFO - Pretraining: False
2024-10-28 10:08:38,887 - root - INFO - Training optimizer: adam
2024-10-28 10:08:38,887 - root - INFO - Training learning rate: 0.0944743
2024-10-28 10:08:38,888 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:08:38,888 - root - INFO - Training batch size: 512
2024-10-28 10:08:38,888 - root - INFO - Training weight decay: 4.80931e-05
2024-10-28 10:08:39,048 - root - INFO - Initializing center c...
2024-10-28 10:08:39,110 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:44,390 - root - INFO - Center c initialized.
2024-10-28 10:08:44,390 - root - INFO - Starting training...
2024-10-28 10:08:44,449 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:45,510 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:46,288 - root - INFO -   Epoch 1/10	 Time: 1.895	 Loss: 366.00677490
2024-10-28 10:08:46,348 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:47,298 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:48,080 - root - INFO -   Epoch 2/10	 Time: 1.791	 Loss: 91036.07031250
2024-10-28 10:08:48,141 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:49,098 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:49,884 - root - INFO -   Epoch 3/10	 Time: 1.804	 Loss: 23187.99218750
2024-10-28 10:08:49,944 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:50,898 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:51,680 - root - INFO -   Epoch 4/10	 Time: 1.795	 Loss: 59343.87109375
2024-10-28 10:08:51,741 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:52,690 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:53,475 - root - INFO -   Epoch 5/10	 Time: 1.794	 Loss: 206838.17187500
2024-10-28 10:08:53,535 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:54,483 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:55,269 - root - INFO -   Epoch 6/10	 Time: 1.794	 Loss: 378137.09375000
2024-10-28 10:08:55,330 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:56,294 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:57,079 - root - INFO -   Epoch 7/10	 Time: 1.809	 Loss: 72844.32812500
2024-10-28 10:08:57,140 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:58,109 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:58,911 - root - INFO -   Epoch 8/10	 Time: 1.831	 Loss: 33064.22265625
2024-10-28 10:08:58,974 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:08:59,921 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:09:00,712 - root - INFO -   Epoch 9/10	 Time: 1.801	 Loss: 10776.45996094
2024-10-28 10:09:00,777 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:09:01,731 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:09:02,512 - root - INFO -   Epoch 10/10	 Time: 1.800	 Loss: 51165.05078125
2024-10-28 10:09:02,513 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:09:02,513 - root - INFO - Final loss condition training = 1631238268.4506311
2024-10-28 10:09:02,513 - root - INFO - Final loss condition validation = 15527193577.52565
2024-10-28 10:09:02,514 - root - INFO - Training time: 18.123
2024-10-28 10:09:02,514 - root - INFO - Finished training.
2024-10-28 10:09:02,531 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:09:02,532 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:09:02,532 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:09:02,532 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:09:02,533 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:09:02,533 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:09:02,534 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:09:02,534 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:09:02,534 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:09:02,535 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:09:02,535 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:09:02,549 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:09:02,549 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:09:02,549 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:09:02,550 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:09:02,550 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:09:02,551 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:09:02,551 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:09:02,551 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:09:02,552 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:09:02,552 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:09:02,553 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:09:02,554 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:09:02,566 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:09:02,566 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:09:02,566 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:09:02,566 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:09:02,567 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:09:02,567 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:09:02,567 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:09:02,567 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:09:02,568 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:09:02,568 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:09:02,568 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:09:02,581 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:09:02,581 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:09:02,581 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:09:02,581 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:09:02,582 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:09:02,582 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:09:02,583 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:09:02,583 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:09:02,583 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:09:02,584 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:09:02,584 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:09:02,588 - root - INFO - Starting testing...
2024-10-28 10:09:02,646 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:09:03,586 - root - INFO - Testing time: 0.997
2024-10-28 10:09:03,586 - root - INFO - Finished testing.
2024-10-28 10:09:03,702 - weaver - INFO - [1mWritten output to training/Test/20241028//100838_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:09:03,715 - weaver - INFO - [1mWritten output to training/Test/20241028//100838_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:54:58,345 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:54:58,345 - root - INFO - Data path is ../data.
2024-10-28 10:54:58,345 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:54:58,345 - root - INFO - Dataset: ParT
2024-10-28 10:54:58,345 - root - INFO - Normal class: 0
2024-10-28 10:54:58,345 - root - INFO - Network: ParT
2024-10-28 10:54:58,345 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:54:58,345 - root - INFO - Nu-paramerter: 0.89
2024-10-28 10:54:58,397 - root - INFO - Computation device: cuda
2024-10-28 10:54:58,398 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:54:58,398 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:54:58,445 - root - INFO - Pretraining: False
2024-10-28 10:54:58,445 - root - INFO - Training optimizer: adam
2024-10-28 10:54:58,445 - root - INFO - Training learning rate: 0.000120214
2024-10-28 10:54:58,445 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:54:58,446 - root - INFO - Training batch size: 512
2024-10-28 10:54:58,446 - root - INFO - Training weight decay: 1.35466e-05
2024-10-28 10:54:58,604 - root - INFO - Initializing center c...
2024-10-28 10:54:58,669 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:03,936 - root - INFO - Center c initialized.
2024-10-28 10:55:03,937 - root - INFO - Starting training...
2024-10-28 10:55:03,991 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:05,034 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:05,809 - root - INFO -   Epoch 1/10	 Time: 1.870	 Loss: 253.10176086
2024-10-28 10:55:05,866 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:06,808 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:07,589 - root - INFO -   Epoch 2/10	 Time: 1.779	 Loss: 209.49250793
2024-10-28 10:55:07,649 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:08,603 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:09,379 - root - INFO -   Epoch 3/10	 Time: 1.789	 Loss: 123.61196899
2024-10-28 10:55:09,438 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:10,388 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:11,171 - root - INFO -   Epoch 4/10	 Time: 1.791	 Loss: 107.10339355
2024-10-28 10:55:11,231 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:12,185 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:12,970 - root - INFO -   Epoch 5/10	 Time: 1.798	 Loss: 80.13702393
2024-10-28 10:55:13,029 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:13,989 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:14,773 - root - INFO -   Epoch 6/10	 Time: 1.802	 Loss: 64.51935577
2024-10-28 10:55:14,832 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:15,786 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:16,572 - root - INFO -   Epoch 7/10	 Time: 1.799	 Loss: 57.68821716
2024-10-28 10:55:16,631 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:17,583 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:18,363 - root - INFO -   Epoch 8/10	 Time: 1.790	 Loss: 54.79944611
2024-10-28 10:55:18,425 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:19,380 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:20,160 - root - INFO -   Epoch 9/10	 Time: 1.796	 Loss: 47.03827286
2024-10-28 10:55:20,220 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:21,171 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:21,956 - root - INFO -   Epoch 10/10	 Time: 1.796	 Loss: 41.32496643
2024-10-28 10:55:21,957 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:55:21,957 - root - INFO - Final loss condition training = 32.641870328821824
2024-10-28 10:55:21,957 - root - INFO - Final loss condition validation = 5.988828975256183
2024-10-28 10:55:21,957 - root - INFO - Training time: 18.020
2024-10-28 10:55:21,957 - root - INFO - Finished training.
2024-10-28 10:55:21,975 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:21,975 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:21,975 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:21,976 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:21,976 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:21,977 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:21,977 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:21,978 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:21,978 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:21,978 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:21,979 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:21,993 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:21,993 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:21,993 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:21,994 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:21,994 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:21,994 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:21,995 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:21,995 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:21,996 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:21,996 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:21,996 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:21,998 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:55:22,009 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:22,010 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:22,010 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:22,010 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:22,011 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:22,011 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:22,011 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:22,012 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:22,012 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:22,013 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:22,013 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:22,025 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:22,025 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:22,026 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:22,026 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:22,026 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:22,027 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:22,027 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:22,027 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:22,028 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:22,028 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:22,029 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:22,033 - root - INFO - Starting testing...
2024-10-28 10:55:22,088 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:55:23,027 - root - INFO - Testing time: 0.995
2024-10-28 10:55:23,028 - root - INFO - Finished testing.
2024-10-28 10:55:23,175 - weaver - INFO - [1mWritten output to training/Test/20241028//105458_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:55:23,188 - weaver - INFO - [1mWritten output to training/Test/20241028//105458_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:55:32,882 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:55:32,882 - root - INFO - Data path is ../data.
2024-10-28 10:55:32,882 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:55:32,883 - root - INFO - Dataset: ParT
2024-10-28 10:55:32,883 - root - INFO - Normal class: 0
2024-10-28 10:55:32,883 - root - INFO - Network: ParT
2024-10-28 10:55:32,883 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:55:32,883 - root - INFO - Nu-paramerter: 0.61
2024-10-28 10:55:32,934 - root - INFO - Computation device: cuda
2024-10-28 10:55:32,935 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:55:32,935 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:55:32,971 - root - INFO - Pretraining: False
2024-10-28 10:55:32,971 - root - INFO - Training optimizer: adam
2024-10-28 10:55:32,971 - root - INFO - Training learning rate: 4.59696e-05
2024-10-28 10:55:32,971 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:55:32,971 - root - INFO - Training batch size: 512
2024-10-28 10:55:32,971 - root - INFO - Training weight decay: 1.39638e-06
2024-10-28 10:55:33,126 - root - INFO - Initializing center c...
2024-10-28 10:55:33,207 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:38,450 - root - INFO - Center c initialized.
2024-10-28 10:55:38,450 - root - INFO - Starting training...
2024-10-28 10:55:38,505 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:39,552 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:40,331 - root - INFO -   Epoch 1/10	 Time: 1.879	 Loss: 234.89671326
2024-10-28 10:55:40,390 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:41,318 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:42,100 - root - INFO -   Epoch 2/10	 Time: 1.768	 Loss: 190.95747375
2024-10-28 10:55:42,159 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:43,095 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:43,880 - root - INFO -   Epoch 3/10	 Time: 1.779	 Loss: 154.30918884
2024-10-28 10:55:43,938 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:44,888 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:45,671 - root - INFO -   Epoch 4/10	 Time: 1.791	 Loss: 132.64816284
2024-10-28 10:55:45,729 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:46,672 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:47,459 - root - INFO -   Epoch 5/10	 Time: 1.787	 Loss: 113.24283600
2024-10-28 10:55:47,518 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:48,476 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:49,262 - root - INFO -   Epoch 6/10	 Time: 1.803	 Loss: 100.46846008
2024-10-28 10:55:49,322 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:50,285 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:51,073 - root - INFO -   Epoch 7/10	 Time: 1.810	 Loss: 87.92814636
2024-10-28 10:55:51,132 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:52,077 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:52,864 - root - INFO -   Epoch 8/10	 Time: 1.791	 Loss: 80.08009338
2024-10-28 10:55:52,924 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:53,877 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:54,658 - root - INFO -   Epoch 9/10	 Time: 1.793	 Loss: 73.57790375
2024-10-28 10:55:54,718 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:55,663 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:55:56,446 - root - INFO -   Epoch 10/10	 Time: 1.787	 Loss: 66.28192139
2024-10-28 10:55:56,446 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:55:56,446 - root - INFO - Final loss condition training = 53.23135860968614
2024-10-28 10:55:56,446 - root - INFO - Final loss condition validation = 11.92660154402256
2024-10-28 10:55:56,447 - root - INFO - Training time: 17.997
2024-10-28 10:55:56,447 - root - INFO - Finished training.
2024-10-28 10:55:56,465 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:56,465 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:56,465 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:56,466 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:56,466 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:56,466 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:56,467 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:56,467 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:56,467 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:56,468 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:56,468 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:56,482 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:56,483 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:56,483 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:56,483 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:56,484 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:56,484 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:56,484 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:56,485 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:56,485 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:56,486 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:56,486 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:56,487 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:55:56,500 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:56,500 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:56,500 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:56,500 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:56,501 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:56,501 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:56,502 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:56,502 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:56,503 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:56,503 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:56,504 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:56,516 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:55:56,516 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:55:56,517 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:55:56,517 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:55:56,517 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:55:56,518 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:55:56,518 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:55:56,518 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:55:56,519 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:55:56,519 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:55:56,519 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:55:56,524 - root - INFO - Starting testing...
2024-10-28 10:55:56,580 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:55:57,513 - root - INFO - Testing time: 0.989
2024-10-28 10:55:57,513 - root - INFO - Finished testing.
2024-10-28 10:55:57,631 - weaver - INFO - [1mWritten output to training/Test/20241028//105532_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:55:57,644 - weaver - INFO - [1mWritten output to training/Test/20241028//105532_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:56:07,853 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:56:07,854 - root - INFO - Data path is ../data.
2024-10-28 10:56:07,854 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:56:07,854 - root - INFO - Dataset: ParT
2024-10-28 10:56:07,854 - root - INFO - Normal class: 0
2024-10-28 10:56:07,854 - root - INFO - Network: ParT
2024-10-28 10:56:07,854 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:56:07,854 - root - INFO - Nu-paramerter: 0.90
2024-10-28 10:56:07,905 - root - INFO - Computation device: cuda
2024-10-28 10:56:07,905 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:56:07,906 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:56:07,941 - root - INFO - Pretraining: False
2024-10-28 10:56:07,941 - root - INFO - Training optimizer: adam
2024-10-28 10:56:07,941 - root - INFO - Training learning rate: 1.81005e-07
2024-10-28 10:56:07,941 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:56:07,941 - root - INFO - Training batch size: 512
2024-10-28 10:56:07,941 - root - INFO - Training weight decay: 1.53425e-07
2024-10-28 10:56:08,095 - root - INFO - Initializing center c...
2024-10-28 10:56:08,156 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:13,906 - root - INFO - Center c initialized.
2024-10-28 10:56:13,906 - root - INFO - Starting training...
2024-10-28 10:56:13,963 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:15,008 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:15,790 - root - INFO -   Epoch 1/10	 Time: 1.882	 Loss: 363.23782349
2024-10-28 10:56:15,849 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:16,772 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:17,549 - root - INFO -   Epoch 2/10	 Time: 1.758	 Loss: 368.44418335
2024-10-28 10:56:17,604 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:18,538 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:19,320 - root - INFO -   Epoch 3/10	 Time: 1.770	 Loss: 362.98300171
2024-10-28 10:56:19,380 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:20,322 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:21,110 - root - INFO -   Epoch 4/10	 Time: 1.790	 Loss: 362.71975708
2024-10-28 10:56:21,167 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:22,097 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:22,881 - root - INFO -   Epoch 5/10	 Time: 1.770	 Loss: 362.15383911
2024-10-28 10:56:22,940 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:23,883 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:24,668 - root - INFO -   Epoch 6/10	 Time: 1.786	 Loss: 359.63265991
2024-10-28 10:56:24,727 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:25,651 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:26,434 - root - INFO -   Epoch 7/10	 Time: 1.766	 Loss: 355.12963867
2024-10-28 10:56:26,490 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:27,426 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:28,209 - root - INFO -   Epoch 8/10	 Time: 1.774	 Loss: 356.94052124
2024-10-28 10:56:28,268 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:29,186 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:29,969 - root - INFO -   Epoch 9/10	 Time: 1.760	 Loss: 357.10705566
2024-10-28 10:56:30,028 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:30,968 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:31,759 - root - INFO -   Epoch 10/10	 Time: 1.789	 Loss: 358.13079834
2024-10-28 10:56:31,759 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:56:31,759 - root - INFO - Final loss condition training = 1.0480490662157536
2024-10-28 10:56:31,760 - root - INFO - Final loss condition validation = 0.28498941008001566
2024-10-28 10:56:31,760 - root - INFO - Training time: 17.854
2024-10-28 10:56:31,760 - root - INFO - Finished training.
2024-10-28 10:56:31,779 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:56:31,779 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:56:31,780 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:56:31,780 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:56:31,780 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:56:31,781 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:56:31,781 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:56:31,782 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:56:31,782 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:56:31,782 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:56:31,782 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:56:31,797 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:56:31,798 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:56:31,798 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:56:31,798 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:56:31,799 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:56:31,799 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:56:31,799 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:56:31,799 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:56:31,800 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:56:31,800 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:56:31,800 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:56:31,801 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:56:31,814 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:56:31,814 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:56:31,815 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:56:31,815 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:56:31,816 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:56:31,816 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:56:31,816 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:56:31,817 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:56:31,817 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:56:31,818 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:56:31,818 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:56:31,831 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:56:31,832 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:56:31,832 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:56:31,832 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:56:31,833 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:56:31,833 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:56:31,834 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:56:31,834 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:56:31,834 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:56:31,835 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:56:31,835 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:56:31,839 - root - INFO - Starting testing...
2024-10-28 10:56:31,892 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:56:32,832 - root - INFO - Testing time: 0.993
2024-10-28 10:56:32,832 - root - INFO - Finished testing.
2024-10-28 10:56:32,950 - weaver - INFO - [1mWritten output to training/Test/20241028//105607_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:56:32,963 - weaver - INFO - [1mWritten output to training/Test/20241028//105607_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:56:43,096 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:56:43,097 - root - INFO - Data path is ../data.
2024-10-28 10:56:43,097 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:56:43,097 - root - INFO - Dataset: ParT
2024-10-28 10:56:43,097 - root - INFO - Normal class: 0
2024-10-28 10:56:43,097 - root - INFO - Network: ParT
2024-10-28 10:56:43,097 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:56:43,097 - root - INFO - Nu-paramerter: 0.22
2024-10-28 10:56:43,147 - root - INFO - Computation device: cuda
2024-10-28 10:56:43,148 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:56:43,148 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:56:43,183 - root - INFO - Pretraining: False
2024-10-28 10:56:43,183 - root - INFO - Training optimizer: adam
2024-10-28 10:56:43,183 - root - INFO - Training learning rate: 0.0953682
2024-10-28 10:56:43,183 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:56:43,183 - root - INFO - Training batch size: 512
2024-10-28 10:56:43,183 - root - INFO - Training weight decay: 0.000383199
2024-10-28 10:56:43,333 - root - INFO - Initializing center c...
2024-10-28 10:56:43,407 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:48,709 - root - INFO - Center c initialized.
2024-10-28 10:56:48,709 - root - INFO - Starting training...
2024-10-28 10:56:48,765 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:49,797 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:50,569 - root - INFO -   Epoch 1/10	 Time: 1.857	 Loss: 1096.28332520
2024-10-28 10:56:50,628 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:51,570 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:52,345 - root - INFO -   Epoch 2/10	 Time: 1.776	 Loss: 289080.06250000
2024-10-28 10:56:52,407 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:53,352 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:54,147 - root - INFO -   Epoch 3/10	 Time: 1.801	 Loss: 30367.11914062
2024-10-28 10:56:54,209 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:55,142 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:55,935 - root - INFO -   Epoch 4/10	 Time: 1.787	 Loss: 103284.00781250
2024-10-28 10:56:55,995 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:56,949 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:57,739 - root - INFO -   Epoch 5/10	 Time: 1.803	 Loss: 114821.80468750
2024-10-28 10:56:57,799 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:58,755 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:56:59,544 - root - INFO -   Epoch 6/10	 Time: 1.805	 Loss: 125133.57031250
2024-10-28 10:56:59,604 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:00,557 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:01,337 - root - INFO -   Epoch 7/10	 Time: 1.793	 Loss: 907761.25000000
2024-10-28 10:57:01,398 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:02,355 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:03,143 - root - INFO -   Epoch 8/10	 Time: 1.806	 Loss: 380639.21875000
2024-10-28 10:57:03,204 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:04,164 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:04,957 - root - INFO -   Epoch 9/10	 Time: 1.813	 Loss: 271559.37500000
2024-10-28 10:57:05,019 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:05,977 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:06,770 - root - INFO -   Epoch 10/10	 Time: 1.813	 Loss: 99008.18750000
2024-10-28 10:57:06,771 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:57:06,771 - root - INFO - Final loss condition training = 29773912307.660156
2024-10-28 10:57:06,771 - root - INFO - Final loss condition validation = 653226139.8023071
2024-10-28 10:57:06,771 - root - INFO - Training time: 18.062
2024-10-28 10:57:06,771 - root - INFO - Finished training.
2024-10-28 10:57:06,789 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:06,789 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:06,789 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:06,790 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:06,790 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:06,791 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:06,791 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:06,791 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:06,791 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:06,792 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:06,792 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:06,806 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:06,807 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:06,807 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:06,807 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:06,808 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:06,808 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:06,808 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:06,809 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:06,809 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:06,810 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:06,810 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:06,811 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:57:06,823 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:06,823 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:06,823 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:06,824 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:06,824 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:06,825 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:06,825 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:06,826 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:06,826 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:06,826 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:06,827 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:06,839 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:06,839 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:06,839 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:06,840 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:06,840 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:06,841 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:06,841 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:06,842 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:06,842 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:06,842 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:06,843 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:06,847 - root - INFO - Starting testing...
2024-10-28 10:57:06,906 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:57:07,840 - root - INFO - Testing time: 0.993
2024-10-28 10:57:07,841 - root - INFO - Finished testing.
2024-10-28 10:57:07,959 - weaver - INFO - [1mWritten output to training/Test/20241028//105642_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:57:07,974 - weaver - INFO - [1mWritten output to training/Test/20241028//105642_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:57:18,557 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:57:18,557 - root - INFO - Data path is ../data.
2024-10-28 10:57:18,557 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:57:18,557 - root - INFO - Dataset: ParT
2024-10-28 10:57:18,557 - root - INFO - Normal class: 0
2024-10-28 10:57:18,557 - root - INFO - Network: ParT
2024-10-28 10:57:18,557 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:57:18,557 - root - INFO - Nu-paramerter: 0.54
2024-10-28 10:57:18,610 - root - INFO - Computation device: cuda
2024-10-28 10:57:18,610 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:57:18,610 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:57:18,645 - root - INFO - Pretraining: False
2024-10-28 10:57:18,645 - root - INFO - Training optimizer: adam
2024-10-28 10:57:18,646 - root - INFO - Training learning rate: 2.68533e-07
2024-10-28 10:57:18,646 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:57:18,646 - root - INFO - Training batch size: 512
2024-10-28 10:57:18,646 - root - INFO - Training weight decay: 1.61098e-06
2024-10-28 10:57:18,802 - root - INFO - Initializing center c...
2024-10-28 10:57:18,863 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:24,166 - root - INFO - Center c initialized.
2024-10-28 10:57:24,166 - root - INFO - Starting training...
2024-10-28 10:57:24,225 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:25,275 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:26,064 - root - INFO -   Epoch 1/10	 Time: 1.896	 Loss: 391.26968384
2024-10-28 10:57:26,124 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:27,059 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:27,848 - root - INFO -   Epoch 2/10	 Time: 1.783	 Loss: 382.21902466
2024-10-28 10:57:27,907 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:28,855 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:29,644 - root - INFO -   Epoch 3/10	 Time: 1.795	 Loss: 387.96456909
2024-10-28 10:57:29,705 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:30,646 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:31,441 - root - INFO -   Epoch 4/10	 Time: 1.797	 Loss: 385.45956421
2024-10-28 10:57:31,500 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:32,439 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:33,233 - root - INFO -   Epoch 5/10	 Time: 1.791	 Loss: 385.99719238
2024-10-28 10:57:33,293 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:34,241 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:35,034 - root - INFO -   Epoch 6/10	 Time: 1.800	 Loss: 386.60620117
2024-10-28 10:57:35,092 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:36,023 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:36,815 - root - INFO -   Epoch 7/10	 Time: 1.780	 Loss: 385.74234009
2024-10-28 10:57:36,875 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:37,819 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:38,604 - root - INFO -   Epoch 8/10	 Time: 1.789	 Loss: 378.99710083
2024-10-28 10:57:38,664 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:39,605 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:40,577 - root - INFO -   Epoch 9/10	 Time: 1.972	 Loss: 379.83700562
2024-10-28 10:57:40,635 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:41,587 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:42,378 - root - INFO -   Epoch 10/10	 Time: 1.800	 Loss: 383.88388062
2024-10-28 10:57:42,378 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:57:42,378 - root - INFO - Final loss condition training = 16.377197265625
2024-10-28 10:57:42,378 - root - INFO - Final loss condition validation = 35.76673651114106
2024-10-28 10:57:42,379 - root - INFO - Training time: 18.213
2024-10-28 10:57:42,379 - root - INFO - Finished training.
2024-10-28 10:57:42,396 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:42,397 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:42,397 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:42,397 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:42,398 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:42,398 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:42,398 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:42,398 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:42,399 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:42,399 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:42,399 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:42,413 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:42,413 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:42,413 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:42,414 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:42,414 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:42,415 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:42,415 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:42,416 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:42,416 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:42,416 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:42,417 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:42,418 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:57:42,430 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:42,430 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:42,430 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:42,430 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:42,431 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:42,431 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:42,431 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:42,431 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:42,431 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:42,431 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:42,432 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:42,444 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:57:42,444 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:57:42,444 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:57:42,445 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:57:42,445 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:57:42,445 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:57:42,445 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:57:42,446 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:57:42,446 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:57:42,447 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:57:42,447 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:57:42,451 - root - INFO - Starting testing...
2024-10-28 10:57:42,508 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:57:43,445 - root - INFO - Testing time: 0.994
2024-10-28 10:57:43,445 - root - INFO - Finished testing.
2024-10-28 10:57:43,564 - weaver - INFO - [1mWritten output to training/Test/20241028//105718_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:57:43,577 - weaver - INFO - [1mWritten output to training/Test/20241028//105718_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:57:53,699 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:57:53,699 - root - INFO - Data path is ../data.
2024-10-28 10:57:53,699 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:57:53,699 - root - INFO - Dataset: ParT
2024-10-28 10:57:53,699 - root - INFO - Normal class: 0
2024-10-28 10:57:53,699 - root - INFO - Network: ParT
2024-10-28 10:57:53,699 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:57:53,699 - root - INFO - Nu-paramerter: 0.62
2024-10-28 10:57:53,752 - root - INFO - Computation device: cuda
2024-10-28 10:57:53,752 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:57:53,752 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:57:53,787 - root - INFO - Pretraining: False
2024-10-28 10:57:53,787 - root - INFO - Training optimizer: adam
2024-10-28 10:57:53,787 - root - INFO - Training learning rate: 0.000354461
2024-10-28 10:57:53,788 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:57:53,788 - root - INFO - Training batch size: 512
2024-10-28 10:57:53,788 - root - INFO - Training weight decay: 6.42714e-05
2024-10-28 10:57:53,934 - root - INFO - Initializing center c...
2024-10-28 10:57:53,995 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:57:59,268 - root - INFO - Center c initialized.
2024-10-28 10:57:59,268 - root - INFO - Starting training...
2024-10-28 10:57:59,327 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:00,372 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:01,142 - root - INFO -   Epoch 1/10	 Time: 1.871	 Loss: 305.18899536
2024-10-28 10:58:01,203 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:02,144 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:02,918 - root - INFO -   Epoch 2/10	 Time: 1.775	 Loss: 574.73321533
2024-10-28 10:58:02,979 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:03,927 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:04,703 - root - INFO -   Epoch 3/10	 Time: 1.785	 Loss: 464.80569458
2024-10-28 10:58:04,765 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:05,705 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:06,474 - root - INFO -   Epoch 4/10	 Time: 1.771	 Loss: 236.04685974
2024-10-28 10:58:06,535 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:07,481 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:08,255 - root - INFO -   Epoch 5/10	 Time: 1.780	 Loss: 192.24130249
2024-10-28 10:58:08,316 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:09,255 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:10,036 - root - INFO -   Epoch 6/10	 Time: 1.780	 Loss: 171.97732544
2024-10-28 10:58:10,097 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:11,050 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:11,820 - root - INFO -   Epoch 7/10	 Time: 1.783	 Loss: 137.96592712
2024-10-28 10:58:11,881 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:12,824 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:13,594 - root - INFO -   Epoch 8/10	 Time: 1.773	 Loss: 113.62004089
2024-10-28 10:58:13,655 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:14,593 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:15,369 - root - INFO -   Epoch 9/10	 Time: 1.774	 Loss: 99.83730316
2024-10-28 10:58:15,433 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:16,381 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:17,158 - root - INFO -   Epoch 10/10	 Time: 1.789	 Loss: 82.07662201
2024-10-28 10:58:17,159 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:58:17,159 - root - INFO - Final loss condition training = 315.4417949952185
2024-10-28 10:58:17,159 - root - INFO - Final loss condition validation = 210.4930053560529
2024-10-28 10:58:17,159 - root - INFO - Training time: 17.891
2024-10-28 10:58:17,159 - root - INFO - Finished training.
2024-10-28 10:58:17,177 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:17,177 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:17,177 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:17,178 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:17,178 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:17,178 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:17,179 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:17,179 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:17,179 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:17,180 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:17,180 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:17,194 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:17,194 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:17,194 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:17,195 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:17,195 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:17,196 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:17,196 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:17,196 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:17,197 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:17,197 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:17,198 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:17,199 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:58:17,211 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:17,211 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:17,211 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:17,212 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:17,212 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:17,212 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:17,212 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:17,212 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:17,212 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:17,212 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:17,213 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:17,225 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:17,225 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:17,225 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:17,226 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:17,226 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:17,226 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:17,227 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:17,227 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:17,227 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:17,228 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:17,228 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:17,232 - root - INFO - Starting testing...
2024-10-28 10:58:17,290 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:58:18,236 - root - INFO - Testing time: 1.003
2024-10-28 10:58:18,236 - root - INFO - Finished testing.
2024-10-28 10:58:18,371 - weaver - INFO - [1mWritten output to training/Test/20241028//105753_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:58:18,388 - weaver - INFO - [1mWritten output to training/Test/20241028//105753_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:58:29,287 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:58:29,287 - root - INFO - Data path is ../data.
2024-10-28 10:58:29,287 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:58:29,287 - root - INFO - Dataset: ParT
2024-10-28 10:58:29,287 - root - INFO - Normal class: 0
2024-10-28 10:58:29,288 - root - INFO - Network: ParT
2024-10-28 10:58:29,288 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:58:29,288 - root - INFO - Nu-paramerter: 0.48
2024-10-28 10:58:29,339 - root - INFO - Computation device: cuda
2024-10-28 10:58:29,339 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:58:29,340 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:58:29,375 - root - INFO - Pretraining: False
2024-10-28 10:58:29,375 - root - INFO - Training optimizer: adam
2024-10-28 10:58:29,375 - root - INFO - Training learning rate: 9.1066e-05
2024-10-28 10:58:29,375 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:58:29,375 - root - INFO - Training batch size: 512
2024-10-28 10:58:29,375 - root - INFO - Training weight decay: 0.0198774
2024-10-28 10:58:29,524 - root - INFO - Initializing center c...
2024-10-28 10:58:29,585 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:34,812 - root - INFO - Center c initialized.
2024-10-28 10:58:34,812 - root - INFO - Starting training...
2024-10-28 10:58:34,859 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:35,799 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:36,576 - root - INFO -   Epoch 1/10	 Time: 1.762	 Loss: 466.54162598
2024-10-28 10:58:36,635 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:37,584 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:38,366 - root - INFO -   Epoch 2/10	 Time: 1.789	 Loss: 318.76940918
2024-10-28 10:58:38,426 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:39,378 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:40,160 - root - INFO -   Epoch 3/10	 Time: 1.793	 Loss: 218.05477905
2024-10-28 10:58:40,219 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:41,164 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:41,948 - root - INFO -   Epoch 4/10	 Time: 1.787	 Loss: 169.74790955
2024-10-28 10:58:42,008 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:42,925 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:43,708 - root - INFO -   Epoch 5/10	 Time: 1.760	 Loss: 135.75177002
2024-10-28 10:58:43,769 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:44,732 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:45,516 - root - INFO -   Epoch 6/10	 Time: 1.807	 Loss: 117.72888184
2024-10-28 10:58:45,577 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:46,544 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:47,324 - root - INFO -   Epoch 7/10	 Time: 1.808	 Loss: 98.66977692
2024-10-28 10:58:47,385 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:48,342 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:49,123 - root - INFO -   Epoch 8/10	 Time: 1.798	 Loss: 86.74471283
2024-10-28 10:58:49,184 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:50,139 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:50,920 - root - INFO -   Epoch 9/10	 Time: 1.796	 Loss: 79.18554688
2024-10-28 10:58:50,979 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:51,926 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:58:52,708 - root - INFO -   Epoch 10/10	 Time: 1.788	 Loss: 72.06694031
2024-10-28 10:58:52,709 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:58:52,709 - root - INFO - Final loss condition training = 50.67455946118571
2024-10-28 10:58:52,709 - root - INFO - Final loss condition validation = 35.75898020208115
2024-10-28 10:58:52,709 - root - INFO - Training time: 17.897
2024-10-28 10:58:52,709 - root - INFO - Finished training.
2024-10-28 10:58:52,727 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:52,727 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:52,727 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:52,728 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:52,728 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:52,729 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:52,729 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:52,730 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:52,730 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:52,730 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:52,731 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:52,745 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:52,745 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:52,745 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:52,745 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:52,746 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:52,746 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:52,746 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:52,747 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:52,747 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:52,748 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:52,748 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:52,749 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:58:52,761 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:52,761 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:52,761 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:52,762 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:52,762 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:52,763 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:52,763 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:52,763 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:52,764 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:52,764 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:52,764 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:52,777 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:58:52,777 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:58:52,777 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:58:52,777 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:58:52,778 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:58:52,778 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:58:52,778 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:58:52,779 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:58:52,779 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:58:52,780 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:58:52,780 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:58:52,784 - root - INFO - Starting testing...
2024-10-28 10:58:52,843 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:58:53,782 - root - INFO - Testing time: 0.998
2024-10-28 10:58:53,782 - root - INFO - Finished testing.
2024-10-28 10:58:53,906 - weaver - INFO - [1mWritten output to training/Test/20241028//105829_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:58:53,920 - weaver - INFO - [1mWritten output to training/Test/20241028//105829_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:59:03,827 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:59:03,827 - root - INFO - Data path is ../data.
2024-10-28 10:59:03,827 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:59:03,827 - root - INFO - Dataset: ParT
2024-10-28 10:59:03,827 - root - INFO - Normal class: 0
2024-10-28 10:59:03,827 - root - INFO - Network: ParT
2024-10-28 10:59:03,827 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:59:03,827 - root - INFO - Nu-paramerter: 0.26
2024-10-28 10:59:03,868 - root - INFO - Computation device: cuda
2024-10-28 10:59:03,868 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:59:03,869 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:59:03,907 - root - INFO - Pretraining: False
2024-10-28 10:59:03,907 - root - INFO - Training optimizer: adam
2024-10-28 10:59:03,907 - root - INFO - Training learning rate: 2.82829e-07
2024-10-28 10:59:03,907 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:59:03,907 - root - INFO - Training batch size: 512
2024-10-28 10:59:03,907 - root - INFO - Training weight decay: 6.97271e-05
2024-10-28 10:59:04,057 - root - INFO - Initializing center c...
2024-10-28 10:59:04,118 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:09,321 - root - INFO - Center c initialized.
2024-10-28 10:59:09,321 - root - INFO - Starting training...
2024-10-28 10:59:09,372 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:10,323 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:11,102 - root - INFO -   Epoch 1/10	 Time: 1.778	 Loss: 1125.00903320
2024-10-28 10:59:11,161 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:12,106 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:12,886 - root - INFO -   Epoch 2/10	 Time: 1.784	 Loss: 1140.01855469
2024-10-28 10:59:12,942 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:13,883 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:14,681 - root - INFO -   Epoch 3/10	 Time: 1.795	 Loss: 1133.73376465
2024-10-28 10:59:14,742 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:15,684 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:16,462 - root - INFO -   Epoch 4/10	 Time: 1.780	 Loss: 1133.78979492
2024-10-28 10:59:16,522 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:17,431 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:18,210 - root - INFO -   Epoch 5/10	 Time: 1.747	 Loss: 1130.23864746
2024-10-28 10:59:18,297 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:19,244 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:20,027 - root - INFO -   Epoch 6/10	 Time: 1.817	 Loss: 1118.41882324
2024-10-28 10:59:20,089 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:21,035 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:21,818 - root - INFO -   Epoch 7/10	 Time: 1.790	 Loss: 1121.59606934
2024-10-28 10:59:21,879 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:22,817 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:23,597 - root - INFO -   Epoch 8/10	 Time: 1.778	 Loss: 1111.61486816
2024-10-28 10:59:23,659 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:24,573 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:25,353 - root - INFO -   Epoch 9/10	 Time: 1.755	 Loss: 1128.29663086
2024-10-28 10:59:25,414 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:26,365 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:27,148 - root - INFO -   Epoch 10/10	 Time: 1.794	 Loss: 1100.76953125
2024-10-28 10:59:27,149 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 10:59:27,149 - root - INFO - Final loss condition training = 757.7412129044533
2024-10-28 10:59:27,149 - root - INFO - Final loss condition validation = 72.70205989852548
2024-10-28 10:59:27,149 - root - INFO - Training time: 17.828
2024-10-28 10:59:27,149 - root - INFO - Finished training.
2024-10-28 10:59:27,167 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:59:27,167 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:59:27,167 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:59:27,168 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:59:27,168 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:59:27,169 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:59:27,169 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:59:27,169 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:59:27,169 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:59:27,170 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:59:27,170 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:59:27,184 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:59:27,184 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:59:27,184 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:59:27,185 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:59:27,186 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:59:27,186 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:59:27,186 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:59:27,187 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:59:27,187 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:59:27,188 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:59:27,188 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:59:27,189 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 10:59:27,201 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:59:27,201 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:59:27,201 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:59:27,202 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:59:27,202 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:59:27,203 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:59:27,203 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:59:27,203 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:59:27,204 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:59:27,204 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:59:27,205 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:59:27,217 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 10:59:27,217 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 10:59:27,217 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 10:59:27,218 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 10:59:27,218 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 10:59:27,219 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 10:59:27,219 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 10:59:27,220 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 10:59:27,220 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 10:59:27,221 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 10:59:27,221 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 10:59:27,225 - root - INFO - Starting testing...
2024-10-28 10:59:27,283 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 10:59:28,219 - root - INFO - Testing time: 0.994
2024-10-28 10:59:28,220 - root - INFO - Finished testing.
2024-10-28 10:59:28,337 - weaver - INFO - [1mWritten output to training/Test/20241028//105903_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 10:59:28,350 - weaver - INFO - [1mWritten output to training/Test/20241028//105903_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 10:59:38,615 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 10:59:38,615 - root - INFO - Data path is ../data.
2024-10-28 10:59:38,615 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 10:59:38,615 - root - INFO - Dataset: ParT
2024-10-28 10:59:38,615 - root - INFO - Normal class: 0
2024-10-28 10:59:38,615 - root - INFO - Network: ParT
2024-10-28 10:59:38,615 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 10:59:38,615 - root - INFO - Nu-paramerter: 0.69
2024-10-28 10:59:38,667 - root - INFO - Computation device: cuda
2024-10-28 10:59:38,667 - root - INFO - Number of dataloader workers: 0
2024-10-28 10:59:38,668 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 10:59:38,703 - root - INFO - Pretraining: False
2024-10-28 10:59:38,703 - root - INFO - Training optimizer: adam
2024-10-28 10:59:38,703 - root - INFO - Training learning rate: 2.43598e-05
2024-10-28 10:59:38,703 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 10:59:38,703 - root - INFO - Training batch size: 512
2024-10-28 10:59:38,703 - root - INFO - Training weight decay: 0.0432199
2024-10-28 10:59:38,856 - root - INFO - Initializing center c...
2024-10-28 10:59:38,917 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:44,183 - root - INFO - Center c initialized.
2024-10-28 10:59:44,183 - root - INFO - Starting training...
2024-10-28 10:59:44,243 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:45,298 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:46,080 - root - INFO -   Epoch 1/10	 Time: 1.893	 Loss: 263.26333618
2024-10-28 10:59:46,139 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:47,084 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:47,868 - root - INFO -   Epoch 2/10	 Time: 1.788	 Loss: 213.12408447
2024-10-28 10:59:47,928 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:48,871 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:49,649 - root - INFO -   Epoch 3/10	 Time: 1.780	 Loss: 181.42391968
2024-10-28 10:59:49,710 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:50,633 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:51,412 - root - INFO -   Epoch 4/10	 Time: 1.762	 Loss: 152.54656982
2024-10-28 10:59:51,472 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:52,421 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:53,203 - root - INFO -   Epoch 5/10	 Time: 1.791	 Loss: 137.41673279
2024-10-28 10:59:53,264 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:54,214 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:54,998 - root - INFO -   Epoch 6/10	 Time: 1.794	 Loss: 120.98671722
2024-10-28 10:59:55,059 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:56,009 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:56,792 - root - INFO -   Epoch 7/10	 Time: 1.794	 Loss: 107.19931030
2024-10-28 10:59:56,853 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:57,795 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:58,577 - root - INFO -   Epoch 8/10	 Time: 1.784	 Loss: 98.88071442
2024-10-28 10:59:58,639 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 10:59:59,583 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:00,366 - root - INFO -   Epoch 9/10	 Time: 1.788	 Loss: 90.04666901
2024-10-28 11:00:00,427 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:01,377 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:02,170 - root - INFO -   Epoch 10/10	 Time: 1.803	 Loss: 82.61665344
2024-10-28 11:00:02,171 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:00:02,171 - root - INFO - Final loss condition training = 55.205131280759815
2024-10-28 11:00:02,171 - root - INFO - Final loss condition validation = 54.82429009885527
2024-10-28 11:00:02,172 - root - INFO - Training time: 17.988
2024-10-28 11:00:02,172 - root - INFO - Finished training.
2024-10-28 11:00:02,189 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:02,189 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:02,189 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:02,190 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:02,190 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:02,190 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:02,191 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:02,191 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:02,192 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:02,192 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:02,192 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:02,206 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:02,206 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:02,206 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:02,207 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:02,208 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:02,208 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:02,208 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:02,209 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:02,209 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:02,210 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:02,210 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:02,212 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:00:02,223 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:02,223 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:02,223 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:02,224 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:02,224 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:02,225 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:02,225 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:02,226 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:02,226 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:02,226 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:02,227 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:02,239 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:02,240 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:02,240 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:02,240 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:02,241 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:02,241 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:02,241 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:02,242 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:02,242 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:02,243 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:02,243 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:02,247 - root - INFO - Starting testing...
2024-10-28 11:00:02,306 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:00:03,243 - root - INFO - Testing time: 0.996
2024-10-28 11:00:03,243 - root - INFO - Finished testing.
2024-10-28 11:00:03,363 - weaver - INFO - [1mWritten output to training/Test/20241028//105938_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:00:03,377 - weaver - INFO - [1mWritten output to training/Test/20241028//105938_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:00:13,561 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:00:13,561 - root - INFO - Data path is ../data.
2024-10-28 11:00:13,562 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:00:13,562 - root - INFO - Dataset: ParT
2024-10-28 11:00:13,562 - root - INFO - Normal class: 0
2024-10-28 11:00:13,562 - root - INFO - Network: ParT
2024-10-28 11:00:13,562 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:00:13,562 - root - INFO - Nu-paramerter: 0.90
2024-10-28 11:00:13,613 - root - INFO - Computation device: cuda
2024-10-28 11:00:13,613 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:00:13,614 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:00:13,649 - root - INFO - Pretraining: False
2024-10-28 11:00:13,649 - root - INFO - Training optimizer: adam
2024-10-28 11:00:13,649 - root - INFO - Training learning rate: 0.0117334
2024-10-28 11:00:13,649 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:00:13,649 - root - INFO - Training batch size: 512
2024-10-28 11:00:13,649 - root - INFO - Training weight decay: 1.88046e-07
2024-10-28 11:00:13,801 - root - INFO - Initializing center c...
2024-10-28 11:00:13,862 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:19,183 - root - INFO - Center c initialized.
2024-10-28 11:00:19,183 - root - INFO - Starting training...
2024-10-28 11:00:19,239 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:20,299 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:21,083 - root - INFO -   Epoch 1/10	 Time: 1.897	 Loss: 244.20542908
2024-10-28 11:00:21,144 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:22,095 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:22,883 - root - INFO -   Epoch 2/10	 Time: 1.799	 Loss: 24243.77343750
2024-10-28 11:00:22,939 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:23,885 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:24,671 - root - INFO -   Epoch 3/10	 Time: 1.787	 Loss: 3625.33642578
2024-10-28 11:00:24,732 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:25,682 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:26,467 - root - INFO -   Epoch 4/10	 Time: 1.794	 Loss: 2495.10107422
2024-10-28 11:00:26,527 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:27,474 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:28,265 - root - INFO -   Epoch 5/10	 Time: 1.798	 Loss: 3858.79711914
2024-10-28 11:00:28,326 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:29,284 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:30,072 - root - INFO -   Epoch 6/10	 Time: 1.807	 Loss: 2675.95922852
2024-10-28 11:00:30,133 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:31,085 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:31,877 - root - INFO -   Epoch 7/10	 Time: 1.804	 Loss: 1696.57299805
2024-10-28 11:00:31,937 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:32,891 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:33,679 - root - INFO -   Epoch 8/10	 Time: 1.802	 Loss: 1373.10168457
2024-10-28 11:00:33,740 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:34,703 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:35,497 - root - INFO -   Epoch 9/10	 Time: 1.817	 Loss: 1602.77465820
2024-10-28 11:00:35,558 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:36,522 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:00:37,315 - root - INFO -   Epoch 10/10	 Time: 1.817	 Loss: 3255.42553711
2024-10-28 11:00:37,315 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:00:37,315 - root - INFO - Final loss condition training = 2731254.9275496006
2024-10-28 11:00:37,315 - root - INFO - Final loss condition validation = 4294860.581622183
2024-10-28 11:00:37,316 - root - INFO - Training time: 18.132
2024-10-28 11:00:37,316 - root - INFO - Finished training.
2024-10-28 11:00:37,333 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:37,334 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:37,334 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:37,334 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:37,335 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:37,335 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:37,335 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:37,336 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:37,336 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:37,337 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:37,337 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:37,351 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:37,351 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:37,351 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:37,351 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:37,352 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:37,352 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:37,352 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:37,353 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:37,353 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:37,354 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:37,354 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:37,356 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:00:37,367 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:37,367 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:37,367 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:37,368 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:37,368 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:37,369 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:37,369 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:37,370 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:37,370 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:37,370 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:37,371 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:37,383 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:00:37,383 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:00:37,383 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:00:37,384 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:00:37,384 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:00:37,385 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:00:37,385 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:00:37,385 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:00:37,386 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:00:37,386 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:00:37,386 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:00:37,390 - root - INFO - Starting testing...
2024-10-28 11:00:37,448 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:00:38,383 - root - INFO - Testing time: 0.993
2024-10-28 11:00:38,383 - root - INFO - Finished testing.
2024-10-28 11:00:38,501 - weaver - INFO - [1mWritten output to training/Test/20241028//110013_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:00:38,513 - weaver - INFO - [1mWritten output to training/Test/20241028//110013_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:23:35,657 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:23:35,657 - root - INFO - Data path is ../data.
2024-10-28 11:23:35,657 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:23:35,657 - root - INFO - Dataset: ParT
2024-10-28 11:23:35,657 - root - INFO - Normal class: 0
2024-10-28 11:23:35,657 - root - INFO - Network: ParT
2024-10-28 11:23:35,657 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:23:35,657 - root - INFO - Nu-paramerter: 0.01
2024-10-28 11:23:35,715 - root - INFO - Computation device: cuda
2024-10-28 11:23:35,715 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:23:35,715 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:23:35,750 - root - INFO - Pretraining: False
2024-10-28 11:23:35,750 - root - INFO - Training optimizer: adam
2024-10-28 11:23:35,750 - root - INFO - Training learning rate: 1.2429e-06
2024-10-28 11:23:35,750 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:23:35,750 - root - INFO - Training batch size: 512
2024-10-28 11:23:35,750 - root - INFO - Training weight decay: 7.10969e-05
2024-10-28 11:23:35,914 - root - INFO - Initializing center c...
2024-10-28 11:23:35,976 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:41,279 - root - INFO - Center c initialized.
2024-10-28 11:23:41,279 - root - INFO - Starting training...
2024-10-28 11:23:41,338 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:42,379 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:43,187 - root - INFO -   Epoch 1/10	 Time: 1.906	 Loss: 17182.14062500
2024-10-28 11:23:43,246 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:44,184 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:44,964 - root - INFO -   Epoch 2/10	 Time: 1.777	 Loss: 16921.28906250
2024-10-28 11:23:45,024 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:45,973 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:46,757 - root - INFO -   Epoch 3/10	 Time: 1.792	 Loss: 16737.72265625
2024-10-28 11:23:46,815 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:47,766 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:48,552 - root - INFO -   Epoch 4/10	 Time: 1.795	 Loss: 16556.21093750
2024-10-28 11:23:48,610 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:49,562 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:50,347 - root - INFO -   Epoch 5/10	 Time: 1.794	 Loss: 16386.93164062
2024-10-28 11:23:50,406 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:51,350 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:52,135 - root - INFO -   Epoch 6/10	 Time: 1.788	 Loss: 16169.06542969
2024-10-28 11:23:52,194 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:53,150 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:53,940 - root - INFO -   Epoch 7/10	 Time: 1.804	 Loss: 16102.10937500
2024-10-28 11:23:53,998 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:54,956 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:55,742 - root - INFO -   Epoch 8/10	 Time: 1.801	 Loss: 15857.48339844
2024-10-28 11:23:55,801 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:56,751 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:57,539 - root - INFO -   Epoch 9/10	 Time: 1.797	 Loss: 15787.12890625
2024-10-28 11:23:57,598 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:58,542 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:23:59,328 - root - INFO -   Epoch 10/10	 Time: 1.789	 Loss: 15633.02539062
2024-10-28 11:23:59,329 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:23:59,329 - root - INFO - Final loss condition training = 23747.89352798462
2024-10-28 11:23:59,329 - root - INFO - Final loss condition validation = 50125.700112342834
2024-10-28 11:23:59,329 - root - INFO - Training time: 18.050
2024-10-28 11:23:59,329 - root - INFO - Finished training.
2024-10-28 11:23:59,347 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:23:59,347 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:23:59,348 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:23:59,348 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:23:59,348 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:23:59,349 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:23:59,349 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:23:59,350 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:23:59,350 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:23:59,350 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:23:59,351 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:23:59,364 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:23:59,364 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:23:59,365 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:23:59,365 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:23:59,365 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:23:59,366 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:23:59,366 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:23:59,366 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:23:59,367 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:23:59,367 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:23:59,368 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:23:59,369 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:23:59,381 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:23:59,381 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:23:59,381 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:23:59,382 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:23:59,382 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:23:59,382 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:23:59,383 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:23:59,383 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:23:59,383 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:23:59,383 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:23:59,384 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:23:59,396 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:23:59,396 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:23:59,397 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:23:59,397 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:23:59,398 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:23:59,398 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:23:59,398 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:23:59,398 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:23:59,399 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:23:59,399 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:23:59,399 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:23:59,403 - root - INFO - Starting testing...
2024-10-28 11:23:59,460 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:24:00,402 - root - INFO - Testing time: 0.998
2024-10-28 11:24:00,402 - root - INFO - Finished testing.
2024-10-28 11:24:00,527 - weaver - INFO - [1mWritten output to training/Test/20241028//112335_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:24:00,543 - weaver - INFO - [1mWritten output to training/Test/20241028//112335_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:24:10,950 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:24:10,950 - root - INFO - Data path is ../data.
2024-10-28 11:24:10,950 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:24:10,950 - root - INFO - Dataset: ParT
2024-10-28 11:24:10,950 - root - INFO - Normal class: 0
2024-10-28 11:24:10,950 - root - INFO - Network: ParT
2024-10-28 11:24:10,950 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:24:10,950 - root - INFO - Nu-paramerter: 0.26
2024-10-28 11:24:11,005 - root - INFO - Computation device: cuda
2024-10-28 11:24:11,006 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:24:11,006 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:24:11,052 - root - INFO - Pretraining: False
2024-10-28 11:24:11,052 - root - INFO - Training optimizer: adam
2024-10-28 11:24:11,052 - root - INFO - Training learning rate: 0.000190211
2024-10-28 11:24:11,052 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:24:11,053 - root - INFO - Training batch size: 512
2024-10-28 11:24:11,053 - root - INFO - Training weight decay: 2.71868e-06
2024-10-28 11:24:11,210 - root - INFO - Initializing center c...
2024-10-28 11:24:11,270 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:16,428 - root - INFO - Center c initialized.
2024-10-28 11:24:16,428 - root - INFO - Starting training...
2024-10-28 11:24:16,481 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:17,458 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:18,229 - root - INFO -   Epoch 1/10	 Time: 1.798	 Loss: 1343.63659668
2024-10-28 11:24:18,290 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:19,224 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:19,998 - root - INFO -   Epoch 2/10	 Time: 1.769	 Loss: 1029.78381348
2024-10-28 11:24:20,059 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:21,005 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:21,783 - root - INFO -   Epoch 3/10	 Time: 1.784	 Loss: 670.93194580
2024-10-28 11:24:21,843 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:22,767 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:23,542 - root - INFO -   Epoch 4/10	 Time: 1.758	 Loss: 449.28347778
2024-10-28 11:24:23,601 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:24,555 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:25,334 - root - INFO -   Epoch 5/10	 Time: 1.792	 Loss: 342.23315430
2024-10-28 11:24:25,394 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:26,335 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:27,113 - root - INFO -   Epoch 6/10	 Time: 1.778	 Loss: 292.77600098
2024-10-28 11:24:27,173 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:28,126 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:28,908 - root - INFO -   Epoch 7/10	 Time: 1.795	 Loss: 265.97680664
2024-10-28 11:24:28,968 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:29,886 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:30,668 - root - INFO -   Epoch 8/10	 Time: 1.759	 Loss: 219.27037048
2024-10-28 11:24:30,729 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:31,668 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:32,448 - root - INFO -   Epoch 9/10	 Time: 1.780	 Loss: 173.24404907
2024-10-28 11:24:32,512 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:33,464 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:34,240 - root - INFO -   Epoch 10/10	 Time: 1.791	 Loss: 160.05621338
2024-10-28 11:24:34,241 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:24:34,241 - root - INFO - Final loss condition training = 173.91901027504355
2024-10-28 11:24:34,241 - root - INFO - Final loss condition validation = 39.2852133968845
2024-10-28 11:24:34,241 - root - INFO - Training time: 17.812
2024-10-28 11:24:34,241 - root - INFO - Finished training.
2024-10-28 11:24:34,259 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:24:34,259 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:24:34,259 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:24:34,260 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:24:34,260 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:24:34,260 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:24:34,261 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:24:34,261 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:24:34,261 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:24:34,261 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:24:34,262 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:24:34,275 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:24:34,276 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:24:34,276 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:24:34,276 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:24:34,276 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:24:34,277 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:24:34,277 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:24:34,277 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:24:34,277 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:24:34,278 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:24:34,278 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:24:34,280 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:24:34,291 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:24:34,292 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:24:34,292 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:24:34,292 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:24:34,293 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:24:34,293 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:24:34,294 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:24:34,294 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:24:34,294 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:24:34,295 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:24:34,295 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:24:34,308 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:24:34,308 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:24:34,308 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:24:34,308 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:24:34,309 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:24:34,309 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:24:34,310 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:24:34,310 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:24:34,311 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:24:34,311 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:24:34,312 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:24:34,316 - root - INFO - Starting testing...
2024-10-28 11:24:34,374 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:24:35,321 - root - INFO - Testing time: 1.005
2024-10-28 11:24:35,321 - root - INFO - Finished testing.
2024-10-28 11:24:35,439 - weaver - INFO - [1mWritten output to training/Test/20241028//112410_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:24:35,452 - weaver - INFO - [1mWritten output to training/Test/20241028//112410_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:24:46,487 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:24:46,487 - root - INFO - Data path is ../data.
2024-10-28 11:24:46,487 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:24:46,487 - root - INFO - Dataset: ParT
2024-10-28 11:24:46,487 - root - INFO - Normal class: 0
2024-10-28 11:24:46,487 - root - INFO - Network: ParT
2024-10-28 11:24:46,487 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:24:46,487 - root - INFO - Nu-paramerter: 0.91
2024-10-28 11:24:46,539 - root - INFO - Computation device: cuda
2024-10-28 11:24:46,539 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:24:46,539 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:24:46,574 - root - INFO - Pretraining: False
2024-10-28 11:24:46,575 - root - INFO - Training optimizer: adam
2024-10-28 11:24:46,575 - root - INFO - Training learning rate: 2.0333e-07
2024-10-28 11:24:46,575 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:24:46,575 - root - INFO - Training batch size: 512
2024-10-28 11:24:46,575 - root - INFO - Training weight decay: 0.00484869
2024-10-28 11:24:46,722 - root - INFO - Initializing center c...
2024-10-28 11:24:46,796 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:52,026 - root - INFO - Center c initialized.
2024-10-28 11:24:52,026 - root - INFO - Starting training...
2024-10-28 11:24:52,077 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:53,073 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:53,844 - root - INFO -   Epoch 1/10	 Time: 1.816	 Loss: 195.98001099
2024-10-28 11:24:53,903 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:54,830 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:55,608 - root - INFO -   Epoch 2/10	 Time: 1.763	 Loss: 190.80682373
2024-10-28 11:24:55,667 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:56,583 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:57,360 - root - INFO -   Epoch 3/10	 Time: 1.751	 Loss: 193.02374268
2024-10-28 11:24:57,421 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:58,366 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:24:59,141 - root - INFO -   Epoch 4/10	 Time: 1.781	 Loss: 190.82730103
2024-10-28 11:24:59,202 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:00,111 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:00,896 - root - INFO -   Epoch 5/10	 Time: 1.755	 Loss: 192.12097168
2024-10-28 11:25:00,948 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:01,895 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:02,672 - root - INFO -   Epoch 6/10	 Time: 1.775	 Loss: 189.55213928
2024-10-28 11:25:02,733 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:03,686 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:04,463 - root - INFO -   Epoch 7/10	 Time: 1.791	 Loss: 192.77807617
2024-10-28 11:25:04,524 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:05,464 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:06,250 - root - INFO -   Epoch 8/10	 Time: 1.786	 Loss: 192.32049561
2024-10-28 11:25:06,311 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:07,260 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:08,042 - root - INFO -   Epoch 9/10	 Time: 1.792	 Loss: 190.79106140
2024-10-28 11:25:08,104 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:09,054 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:09,838 - root - INFO -   Epoch 10/10	 Time: 1.795	 Loss: 192.99288940
2024-10-28 11:25:09,839 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:25:09,839 - root - INFO - Final loss condition training = 4.848046554485336
2024-10-28 11:25:09,839 - root - INFO - Final loss condition validation = 0.03355555818416178
2024-10-28 11:25:09,839 - root - INFO - Training time: 17.813
2024-10-28 11:25:09,839 - root - INFO - Finished training.
2024-10-28 11:25:09,857 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:09,857 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:09,857 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:09,858 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:09,858 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:09,859 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:09,859 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:09,859 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:09,860 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:09,860 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:09,861 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:09,875 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:09,875 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:09,875 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:09,875 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:09,876 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:09,876 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:09,876 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:09,876 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:09,877 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:09,877 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:09,877 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:09,879 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:25:09,890 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:09,891 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:09,891 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:09,891 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:09,892 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:09,892 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:09,893 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:09,893 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:09,893 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:09,894 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:09,894 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:09,907 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:09,907 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:09,907 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:09,907 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:09,908 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:09,908 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:09,908 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:09,908 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:09,909 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:09,910 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:09,910 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:09,914 - root - INFO - Starting testing...
2024-10-28 11:25:09,972 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:25:10,919 - root - INFO - Testing time: 1.005
2024-10-28 11:25:10,919 - root - INFO - Finished testing.
2024-10-28 11:25:11,041 - weaver - INFO - [1mWritten output to training/Test/20241028//112446_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:25:11,056 - weaver - INFO - [1mWritten output to training/Test/20241028//112446_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:25:20,617 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:25:20,617 - root - INFO - Data path is ../data.
2024-10-28 11:25:20,617 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:25:20,617 - root - INFO - Dataset: ParT
2024-10-28 11:25:20,617 - root - INFO - Normal class: 0
2024-10-28 11:25:20,617 - root - INFO - Network: ParT
2024-10-28 11:25:20,617 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:25:20,617 - root - INFO - Nu-paramerter: 0.12
2024-10-28 11:25:20,670 - root - INFO - Computation device: cuda
2024-10-28 11:25:20,670 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:25:20,670 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:25:20,705 - root - INFO - Pretraining: False
2024-10-28 11:25:20,705 - root - INFO - Training optimizer: adam
2024-10-28 11:25:20,705 - root - INFO - Training learning rate: 0.017871
2024-10-28 11:25:20,705 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:25:20,705 - root - INFO - Training batch size: 512
2024-10-28 11:25:20,705 - root - INFO - Training weight decay: 0.0552821
2024-10-28 11:25:20,852 - root - INFO - Initializing center c...
2024-10-28 11:25:20,913 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:26,182 - root - INFO - Center c initialized.
2024-10-28 11:25:26,182 - root - INFO - Starting training...
2024-10-28 11:25:26,239 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:27,248 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:28,029 - root - INFO -   Epoch 1/10	 Time: 1.843	 Loss: 1991.73229980
2024-10-28 11:25:28,085 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:29,025 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:29,812 - root - INFO -   Epoch 2/10	 Time: 1.783	 Loss: 196293.00000000
2024-10-28 11:25:29,870 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:30,828 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:31,603 - root - INFO -   Epoch 3/10	 Time: 1.790	 Loss: 26664.50976562
2024-10-28 11:25:31,664 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:32,606 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:33,390 - root - INFO -   Epoch 4/10	 Time: 1.787	 Loss: 54094.43359375
2024-10-28 11:25:33,452 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:34,392 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:35,176 - root - INFO -   Epoch 5/10	 Time: 1.785	 Loss: 48433.51562500
2024-10-28 11:25:35,238 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:36,193 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:36,980 - root - INFO -   Epoch 6/10	 Time: 1.804	 Loss: 52016.11718750
2024-10-28 11:25:37,041 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:37,998 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:38,782 - root - INFO -   Epoch 7/10	 Time: 1.801	 Loss: 56557.43359375
2024-10-28 11:25:38,844 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:39,795 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:40,581 - root - INFO -   Epoch 8/10	 Time: 1.798	 Loss: 20582.38671875
2024-10-28 11:25:40,641 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:41,595 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:42,382 - root - INFO -   Epoch 9/10	 Time: 1.801	 Loss: 177536.51562500
2024-10-28 11:25:42,443 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:43,373 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:25:44,153 - root - INFO -   Epoch 10/10	 Time: 1.771	 Loss: 71608.75000000
2024-10-28 11:25:44,154 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:25:44,154 - root - INFO - Final loss condition training = 11220691530.304932
2024-10-28 11:25:44,154 - root - INFO - Final loss condition validation = 816157629.9109039
2024-10-28 11:25:44,154 - root - INFO - Training time: 17.972
2024-10-28 11:25:44,155 - root - INFO - Finished training.
2024-10-28 11:25:44,172 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:44,172 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:44,172 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:44,173 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:44,173 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:44,174 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:44,174 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:44,174 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:44,175 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:44,175 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:44,175 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:44,189 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:44,189 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:44,189 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:44,190 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:44,191 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:44,191 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:44,191 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:44,192 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:44,192 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:44,193 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:44,193 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:44,194 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:25:44,206 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:44,206 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:44,206 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:44,207 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:44,207 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:44,207 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:44,207 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:44,207 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:44,207 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:44,207 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:44,208 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:44,220 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:25:44,220 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:25:44,220 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:25:44,221 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:25:44,221 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:25:44,222 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:25:44,222 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:25:44,223 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:25:44,223 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:25:44,223 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:25:44,224 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:25:44,228 - root - INFO - Starting testing...
2024-10-28 11:25:44,286 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:25:45,220 - root - INFO - Testing time: 0.993
2024-10-28 11:25:45,221 - root - INFO - Finished testing.
2024-10-28 11:25:45,354 - weaver - INFO - [1mWritten output to training/Test/20241028//112520_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:25:45,367 - weaver - INFO - [1mWritten output to training/Test/20241028//112520_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:25:55,708 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:25:55,708 - root - INFO - Data path is ../data.
2024-10-28 11:25:55,708 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:25:55,708 - root - INFO - Dataset: ParT
2024-10-28 11:25:55,708 - root - INFO - Normal class: 0
2024-10-28 11:25:55,708 - root - INFO - Network: ParT
2024-10-28 11:25:55,708 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:25:55,708 - root - INFO - Nu-paramerter: 0.77
2024-10-28 11:25:55,763 - root - INFO - Computation device: cuda
2024-10-28 11:25:55,764 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:25:55,764 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:25:55,810 - root - INFO - Pretraining: False
2024-10-28 11:25:55,810 - root - INFO - Training optimizer: adam
2024-10-28 11:25:55,810 - root - INFO - Training learning rate: 8.68193e-07
2024-10-28 11:25:55,811 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:25:55,811 - root - INFO - Training batch size: 512
2024-10-28 11:25:55,811 - root - INFO - Training weight decay: 0.00383703
2024-10-28 11:25:55,958 - root - INFO - Initializing center c...
2024-10-28 11:25:56,020 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:01,288 - root - INFO - Center c initialized.
2024-10-28 11:26:01,288 - root - INFO - Starting training...
2024-10-28 11:26:01,340 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:02,298 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:03,083 - root - INFO -   Epoch 1/10	 Time: 1.792	 Loss: 230.49322510
2024-10-28 11:26:03,144 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:04,094 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:04,884 - root - INFO -   Epoch 2/10	 Time: 1.800	 Loss: 229.61151123
2024-10-28 11:26:04,944 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:05,866 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:06,660 - root - INFO -   Epoch 3/10	 Time: 1.776	 Loss: 230.43951416
2024-10-28 11:26:06,720 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:07,661 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:08,456 - root - INFO -   Epoch 4/10	 Time: 1.795	 Loss: 227.32049561
2024-10-28 11:26:08,517 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:09,469 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:10,261 - root - INFO -   Epoch 5/10	 Time: 1.805	 Loss: 225.63063049
2024-10-28 11:26:10,322 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:11,276 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:12,075 - root - INFO -   Epoch 6/10	 Time: 1.813	 Loss: 226.44885254
2024-10-28 11:26:12,135 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:13,095 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:13,892 - root - INFO -   Epoch 7/10	 Time: 1.816	 Loss: 220.70809937
2024-10-28 11:26:13,952 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:14,907 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:15,702 - root - INFO -   Epoch 8/10	 Time: 1.810	 Loss: 222.41305542
2024-10-28 11:26:15,764 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:16,698 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:17,489 - root - INFO -   Epoch 9/10	 Time: 1.786	 Loss: 218.98237610
2024-10-28 11:26:17,550 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:18,519 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:19,314 - root - INFO -   Epoch 10/10	 Time: 1.825	 Loss: 217.31568909
2024-10-28 11:26:19,315 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:26:19,315 - root - INFO - Final loss condition training = 2.7778455950319767
2024-10-28 11:26:19,315 - root - INFO - Final loss condition validation = 3.123900905251503
2024-10-28 11:26:19,315 - root - INFO - Training time: 18.027
2024-10-28 11:26:19,316 - root - INFO - Finished training.
2024-10-28 11:26:19,333 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:19,333 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:19,334 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:19,334 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:19,334 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:19,335 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:19,335 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:19,336 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:19,336 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:19,336 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:19,336 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:19,350 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:19,351 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:19,351 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:19,351 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:19,352 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:19,352 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:19,352 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:19,353 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:19,353 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:19,354 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:19,354 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:19,355 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:26:19,367 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:19,367 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:19,367 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:19,368 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:19,369 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:19,369 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:19,370 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:19,370 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:19,370 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:19,371 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:19,371 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:19,384 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:19,384 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:19,384 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:19,384 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:19,385 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:19,385 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:19,385 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:19,386 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:19,386 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:19,387 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:19,387 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:19,391 - root - INFO - Starting testing...
2024-10-28 11:26:19,449 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:26:20,385 - root - INFO - Testing time: 0.993
2024-10-28 11:26:20,385 - root - INFO - Finished testing.
2024-10-28 11:26:20,503 - weaver - INFO - [1mWritten output to training/Test/20241028//112555_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:26:20,517 - weaver - INFO - [1mWritten output to training/Test/20241028//112555_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:26:30,695 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:26:30,695 - root - INFO - Data path is ../data.
2024-10-28 11:26:30,695 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:26:30,695 - root - INFO - Dataset: ParT
2024-10-28 11:26:30,695 - root - INFO - Normal class: 0
2024-10-28 11:26:30,695 - root - INFO - Network: ParT
2024-10-28 11:26:30,695 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:26:30,695 - root - INFO - Nu-paramerter: 0.39
2024-10-28 11:26:30,747 - root - INFO - Computation device: cuda
2024-10-28 11:26:30,747 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:26:30,748 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:26:30,782 - root - INFO - Pretraining: False
2024-10-28 11:26:30,783 - root - INFO - Training optimizer: adam
2024-10-28 11:26:30,783 - root - INFO - Training learning rate: 0.0208492
2024-10-28 11:26:30,783 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:26:30,783 - root - INFO - Training batch size: 512
2024-10-28 11:26:30,783 - root - INFO - Training weight decay: 0.00187198
2024-10-28 11:26:30,931 - root - INFO - Initializing center c...
2024-10-28 11:26:30,992 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:37,009 - root - INFO - Center c initialized.
2024-10-28 11:26:37,009 - root - INFO - Starting training...
2024-10-28 11:26:37,066 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:38,129 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:38,916 - root - INFO -   Epoch 1/10	 Time: 1.904	 Loss: 761.35308838
2024-10-28 11:26:38,977 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:39,929 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:40,719 - root - INFO -   Epoch 2/10	 Time: 1.802	 Loss: 76294.94531250
2024-10-28 11:26:40,777 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:41,717 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:42,515 - root - INFO -   Epoch 3/10	 Time: 1.796	 Loss: 13773.38769531
2024-10-28 11:26:42,577 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:43,543 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:44,340 - root - INFO -   Epoch 4/10	 Time: 1.824	 Loss: 11056.48632812
2024-10-28 11:26:44,395 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:45,354 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:46,151 - root - INFO -   Epoch 5/10	 Time: 1.810	 Loss: 19448.91015625
2024-10-28 11:26:46,211 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:47,165 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:47,956 - root - INFO -   Epoch 6/10	 Time: 1.805	 Loss: 54698.79687500
2024-10-28 11:26:48,018 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:48,975 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:49,769 - root - INFO -   Epoch 7/10	 Time: 1.812	 Loss: 21484.59765625
2024-10-28 11:26:49,829 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:50,779 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:51,576 - root - INFO -   Epoch 8/10	 Time: 1.806	 Loss: 17515.57617188
2024-10-28 11:26:51,636 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:52,592 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:53,389 - root - INFO -   Epoch 9/10	 Time: 1.813	 Loss: 10011.41503906
2024-10-28 11:26:53,448 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:54,411 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:26:55,208 - root - INFO -   Epoch 10/10	 Time: 1.819	 Loss: 13013.27050781
2024-10-28 11:26:55,208 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:26:55,209 - root - INFO - Final loss condition training = 9011136.255264282
2024-10-28 11:26:55,209 - root - INFO - Final loss condition validation = 5863.910099029541
2024-10-28 11:26:55,209 - root - INFO - Training time: 18.199
2024-10-28 11:26:55,209 - root - INFO - Finished training.
2024-10-28 11:26:55,227 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:55,227 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:55,227 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:55,227 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:55,228 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:55,228 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:55,229 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:55,229 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:55,229 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:55,230 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:55,230 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:55,245 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:55,245 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:55,245 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:55,246 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:55,246 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:55,247 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:55,247 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:55,247 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:55,248 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:55,248 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:55,248 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:55,250 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:26:55,262 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:55,262 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:55,262 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:55,263 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:55,264 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:55,264 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:55,264 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:55,265 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:55,265 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:55,266 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:55,266 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:55,279 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:26:55,279 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:26:55,279 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:26:55,280 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:26:55,280 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:26:55,281 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:26:55,281 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:26:55,282 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:26:55,282 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:26:55,283 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:26:55,283 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:26:55,288 - root - INFO - Starting testing...
2024-10-28 11:26:55,345 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:26:56,284 - root - INFO - Testing time: 0.996
2024-10-28 11:26:56,284 - root - INFO - Finished testing.
2024-10-28 11:26:56,425 - weaver - INFO - [1mWritten output to training/Test/20241028//112630_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:26:56,441 - weaver - INFO - [1mWritten output to training/Test/20241028//112630_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:27:06,914 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:27:06,914 - root - INFO - Data path is ../data.
2024-10-28 11:27:06,914 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:27:06,914 - root - INFO - Dataset: ParT
2024-10-28 11:27:06,915 - root - INFO - Normal class: 0
2024-10-28 11:27:06,915 - root - INFO - Network: ParT
2024-10-28 11:27:06,915 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:27:06,915 - root - INFO - Nu-paramerter: 0.69
2024-10-28 11:27:06,966 - root - INFO - Computation device: cuda
2024-10-28 11:27:06,966 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:27:06,967 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:27:07,002 - root - INFO - Pretraining: False
2024-10-28 11:27:07,002 - root - INFO - Training optimizer: adam
2024-10-28 11:27:07,002 - root - INFO - Training learning rate: 0.000136299
2024-10-28 11:27:07,002 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:27:07,002 - root - INFO - Training batch size: 512
2024-10-28 11:27:07,002 - root - INFO - Training weight decay: 0.000843181
2024-10-28 11:27:07,151 - root - INFO - Initializing center c...
2024-10-28 11:27:07,213 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:13,242 - root - INFO - Center c initialized.
2024-10-28 11:27:13,242 - root - INFO - Starting training...
2024-10-28 11:27:13,300 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:14,351 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:15,130 - root - INFO -   Epoch 1/10	 Time: 1.885	 Loss: 475.91003418
2024-10-28 11:27:15,190 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:16,133 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:16,913 - root - INFO -   Epoch 2/10	 Time: 1.782	 Loss: 313.17834473
2024-10-28 11:27:16,973 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:17,917 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:18,696 - root - INFO -   Epoch 3/10	 Time: 1.782	 Loss: 224.60438538
2024-10-28 11:27:18,756 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:19,705 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:20,491 - root - INFO -   Epoch 4/10	 Time: 1.794	 Loss: 150.22074890
2024-10-28 11:27:20,551 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:21,504 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:22,282 - root - INFO -   Epoch 5/10	 Time: 1.791	 Loss: 110.17355347
2024-10-28 11:27:22,342 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:23,297 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:24,079 - root - INFO -   Epoch 6/10	 Time: 1.796	 Loss: 95.50978088
2024-10-28 11:27:24,141 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:25,098 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:25,880 - root - INFO -   Epoch 7/10	 Time: 1.800	 Loss: 84.13822174
2024-10-28 11:27:25,942 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:26,869 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:27,651 - root - INFO -   Epoch 8/10	 Time: 1.771	 Loss: 76.78111267
2024-10-28 11:27:27,711 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:28,643 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:29,427 - root - INFO -   Epoch 9/10	 Time: 1.776	 Loss: 69.49341583
2024-10-28 11:27:29,488 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:30,449 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:31,232 - root - INFO -   Epoch 10/10	 Time: 1.804	 Loss: 62.72911835
2024-10-28 11:27:31,232 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:27:31,232 - root - INFO - Final loss condition training = 45.75572047033347
2024-10-28 11:27:31,232 - root - INFO - Final loss condition validation = 49.29454684643133
2024-10-28 11:27:31,233 - root - INFO - Training time: 17.990
2024-10-28 11:27:31,233 - root - INFO - Finished training.
2024-10-28 11:27:31,250 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:27:31,251 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:27:31,251 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:27:31,251 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:27:31,252 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:27:31,252 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:27:31,252 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:27:31,253 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:27:31,253 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:27:31,253 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:27:31,254 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:27:31,267 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:27:31,267 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:27:31,267 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:27:31,268 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:27:31,268 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:27:31,269 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:27:31,269 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:27:31,269 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:27:31,269 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:27:31,269 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:27:31,270 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:27:31,271 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:27:31,282 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:27:31,283 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:27:31,283 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:27:31,283 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:27:31,283 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:27:31,283 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:27:31,283 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:27:31,284 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:27:31,284 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:27:31,284 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:27:31,284 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:27:31,297 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:27:31,297 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:27:31,297 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:27:31,297 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:27:31,298 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:27:31,298 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:27:31,299 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:27:31,299 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:27:31,300 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:27:31,300 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:27:31,301 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:27:31,305 - root - INFO - Starting testing...
2024-10-28 11:27:31,364 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:27:32,311 - root - INFO - Testing time: 1.006
2024-10-28 11:27:32,311 - root - INFO - Finished testing.
2024-10-28 11:27:32,428 - weaver - INFO - [1mWritten output to training/Test/20241028//112706_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:27:32,441 - weaver - INFO - [1mWritten output to training/Test/20241028//112706_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:27:42,465 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:27:42,465 - root - INFO - Data path is ../data.
2024-10-28 11:27:42,465 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:27:42,465 - root - INFO - Dataset: ParT
2024-10-28 11:27:42,465 - root - INFO - Normal class: 0
2024-10-28 11:27:42,465 - root - INFO - Network: ParT
2024-10-28 11:27:42,465 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:27:42,465 - root - INFO - Nu-paramerter: 0.33
2024-10-28 11:27:42,517 - root - INFO - Computation device: cuda
2024-10-28 11:27:42,517 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:27:42,518 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:27:42,552 - root - INFO - Pretraining: False
2024-10-28 11:27:42,553 - root - INFO - Training optimizer: adam
2024-10-28 11:27:42,553 - root - INFO - Training learning rate: 0.0033447
2024-10-28 11:27:42,553 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:27:42,553 - root - INFO - Training batch size: 512
2024-10-28 11:27:42,553 - root - INFO - Training weight decay: 3.67441e-07
2024-10-28 11:27:42,700 - root - INFO - Initializing center c...
2024-10-28 11:27:42,762 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:48,121 - root - INFO - Center c initialized.
2024-10-28 11:27:48,121 - root - INFO - Starting training...
2024-10-28 11:27:48,182 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:49,247 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:50,032 - root - INFO -   Epoch 1/10	 Time: 1.908	 Loss: 871.52069092
2024-10-28 11:27:50,092 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:51,042 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:51,836 - root - INFO -   Epoch 2/10	 Time: 1.804	 Loss: 15913.93164062
2024-10-28 11:27:51,896 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:52,844 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:53,631 - root - INFO -   Epoch 3/10	 Time: 1.795	 Loss: 11930.85839844
2024-10-28 11:27:53,691 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:54,649 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:55,438 - root - INFO -   Epoch 4/10	 Time: 1.806	 Loss: 4718.87792969
2024-10-28 11:27:55,500 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:56,450 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:57,251 - root - INFO -   Epoch 5/10	 Time: 1.812	 Loss: 4427.51074219
2024-10-28 11:27:57,312 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:58,274 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:27:59,055 - root - INFO -   Epoch 6/10	 Time: 1.803	 Loss: 2923.57006836
2024-10-28 11:27:59,117 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:00,048 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:00,841 - root - INFO -   Epoch 7/10	 Time: 1.786	 Loss: 2031.98754883
2024-10-28 11:28:00,903 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:01,851 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:02,641 - root - INFO -   Epoch 8/10	 Time: 1.799	 Loss: 955.89379883
2024-10-28 11:28:02,702 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:03,655 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:04,447 - root - INFO -   Epoch 9/10	 Time: 1.806	 Loss: 588.84570312
2024-10-28 11:28:04,507 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:05,459 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:06,250 - root - INFO -   Epoch 10/10	 Time: 1.802	 Loss: 399.22024536
2024-10-28 11:28:06,250 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:28:06,250 - root - INFO - Final loss condition training = 35957.814232082106
2024-10-28 11:28:06,250 - root - INFO - Final loss condition validation = 1438.496830389835
2024-10-28 11:28:06,251 - root - INFO - Training time: 18.130
2024-10-28 11:28:06,251 - root - INFO - Finished training.
2024-10-28 11:28:06,269 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:06,269 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:06,269 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:06,270 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:06,270 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:06,270 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:06,271 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:06,271 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:06,272 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:06,272 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:06,272 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:06,287 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:06,287 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:06,287 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:06,288 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:06,288 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:06,288 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:06,289 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:06,289 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:06,290 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:06,290 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:06,291 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:06,292 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:28:06,304 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:06,304 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:06,304 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:06,305 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:06,305 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:06,306 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:06,306 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:06,307 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:06,307 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:06,308 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:06,308 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:06,321 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:06,321 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:06,321 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:06,321 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:06,322 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:06,322 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:06,323 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:06,323 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:06,324 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:06,324 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:06,324 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:06,329 - root - INFO - Starting testing...
2024-10-28 11:28:06,388 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:28:07,328 - root - INFO - Testing time: 0.999
2024-10-28 11:28:07,329 - root - INFO - Finished testing.
2024-10-28 11:28:07,445 - weaver - INFO - [1mWritten output to training/Test/20241028//112742_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:28:07,459 - weaver - INFO - [1mWritten output to training/Test/20241028//112742_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:28:17,904 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:28:17,904 - root - INFO - Data path is ../data.
2024-10-28 11:28:17,904 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:28:17,904 - root - INFO - Dataset: ParT
2024-10-28 11:28:17,904 - root - INFO - Normal class: 0
2024-10-28 11:28:17,904 - root - INFO - Network: ParT
2024-10-28 11:28:17,904 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:28:17,904 - root - INFO - Nu-paramerter: 0.11
2024-10-28 11:28:17,958 - root - INFO - Computation device: cuda
2024-10-28 11:28:17,958 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:28:17,958 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:28:17,993 - root - INFO - Pretraining: False
2024-10-28 11:28:17,993 - root - INFO - Training optimizer: adam
2024-10-28 11:28:17,993 - root - INFO - Training learning rate: 0.00060347
2024-10-28 11:28:17,993 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:28:17,993 - root - INFO - Training batch size: 512
2024-10-28 11:28:17,993 - root - INFO - Training weight decay: 6.29898e-05
2024-10-28 11:28:18,145 - root - INFO - Initializing center c...
2024-10-28 11:28:18,240 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:23,536 - root - INFO - Center c initialized.
2024-10-28 11:28:23,537 - root - INFO - Starting training...
2024-10-28 11:28:23,593 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:24,640 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:25,405 - root - INFO -   Epoch 1/10	 Time: 1.866	 Loss: 1616.00354004
2024-10-28 11:28:25,466 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:26,364 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:27,140 - root - INFO -   Epoch 2/10	 Time: 1.734	 Loss: 5756.69042969
2024-10-28 11:28:27,203 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:28,154 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:28,934 - root - INFO -   Epoch 3/10	 Time: 1.793	 Loss: 3157.00170898
2024-10-28 11:28:28,994 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:29,929 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:30,703 - root - INFO -   Epoch 4/10	 Time: 1.768	 Loss: 2484.08105469
2024-10-28 11:28:30,764 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:31,716 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:32,494 - root - INFO -   Epoch 5/10	 Time: 1.791	 Loss: 2377.12597656
2024-10-28 11:28:32,555 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:33,506 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:34,284 - root - INFO -   Epoch 6/10	 Time: 1.789	 Loss: 1546.44873047
2024-10-28 11:28:34,344 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:35,304 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:36,083 - root - INFO -   Epoch 7/10	 Time: 1.799	 Loss: 1130.02587891
2024-10-28 11:28:36,144 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:37,095 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:37,879 - root - INFO -   Epoch 8/10	 Time: 1.796	 Loss: 723.91174316
2024-10-28 11:28:37,942 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:38,900 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:39,687 - root - INFO -   Epoch 9/10	 Time: 1.807	 Loss: 592.07525635
2024-10-28 11:28:39,748 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:40,703 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:41,487 - root - INFO -   Epoch 10/10	 Time: 1.800	 Loss: 574.97393799
2024-10-28 11:28:41,488 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:28:41,488 - root - INFO - Final loss condition training = 292.45508962869644
2024-10-28 11:28:41,488 - root - INFO - Final loss condition validation = 174.68049289286137
2024-10-28 11:28:41,488 - root - INFO - Training time: 17.952
2024-10-28 11:28:41,489 - root - INFO - Finished training.
2024-10-28 11:28:41,506 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:41,506 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:41,507 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:41,507 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:41,507 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:41,508 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:41,508 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:41,508 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:41,508 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:41,508 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:41,509 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:41,523 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:41,523 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:41,523 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:41,523 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:41,524 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:41,524 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:41,524 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:41,524 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:41,525 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:41,525 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:41,525 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:41,526 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:28:41,538 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:41,538 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:41,538 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:41,539 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:41,539 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:41,539 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:41,539 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:41,539 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:41,539 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:41,540 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:41,540 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:41,552 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:28:41,552 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:28:41,553 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:28:41,553 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:28:41,553 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:28:41,554 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:28:41,554 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:28:41,554 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:28:41,554 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:28:41,555 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:28:41,555 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:28:41,559 - root - INFO - Starting testing...
2024-10-28 11:28:41,618 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:28:42,556 - root - INFO - Testing time: 0.996
2024-10-28 11:28:42,556 - root - INFO - Finished testing.
2024-10-28 11:28:42,676 - weaver - INFO - [1mWritten output to training/Test/20241028//112817_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:28:42,690 - weaver - INFO - [1mWritten output to training/Test/20241028//112817_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:28:52,517 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:28:52,517 - root - INFO - Data path is ../data.
2024-10-28 11:28:52,517 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:28:52,517 - root - INFO - Dataset: ParT
2024-10-28 11:28:52,517 - root - INFO - Normal class: 0
2024-10-28 11:28:52,517 - root - INFO - Network: ParT
2024-10-28 11:28:52,517 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:28:52,518 - root - INFO - Nu-paramerter: 0.95
2024-10-28 11:28:52,569 - root - INFO - Computation device: cuda
2024-10-28 11:28:52,569 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:28:52,570 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:28:52,605 - root - INFO - Pretraining: False
2024-10-28 11:28:52,605 - root - INFO - Training optimizer: adam
2024-10-28 11:28:52,605 - root - INFO - Training learning rate: 1.26165e-07
2024-10-28 11:28:52,605 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:28:52,605 - root - INFO - Training batch size: 512
2024-10-28 11:28:52,605 - root - INFO - Training weight decay: 1.63842e-05
2024-10-28 11:28:52,769 - root - INFO - Initializing center c...
2024-10-28 11:28:52,830 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:58,115 - root - INFO - Center c initialized.
2024-10-28 11:28:58,115 - root - INFO - Starting training...
2024-10-28 11:28:58,172 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:59,212 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:28:59,995 - root - INFO -   Epoch 1/10	 Time: 1.878	 Loss: 267.84024048
2024-10-28 11:29:00,053 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:00,967 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:01,750 - root - INFO -   Epoch 2/10	 Time: 1.754	 Loss: 267.57659912
2024-10-28 11:29:01,810 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:02,773 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:03,555 - root - INFO -   Epoch 3/10	 Time: 1.805	 Loss: 270.41119385
2024-10-28 11:29:03,618 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:04,561 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:05,343 - root - INFO -   Epoch 4/10	 Time: 1.787	 Loss: 266.58645630
2024-10-28 11:29:05,405 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:06,336 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:07,120 - root - INFO -   Epoch 5/10	 Time: 1.776	 Loss: 268.55148315
2024-10-28 11:29:07,182 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:08,130 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:08,915 - root - INFO -   Epoch 6/10	 Time: 1.795	 Loss: 266.49865723
2024-10-28 11:29:08,973 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:09,925 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:10,710 - root - INFO -   Epoch 7/10	 Time: 1.794	 Loss: 265.71664429
2024-10-28 11:29:10,772 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:11,729 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:12,514 - root - INFO -   Epoch 8/10	 Time: 1.803	 Loss: 266.72994995
2024-10-28 11:29:12,575 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:13,513 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:14,297 - root - INFO -   Epoch 9/10	 Time: 1.783	 Loss: 264.07595825
2024-10-28 11:29:14,355 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:15,310 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:29:16,097 - root - INFO -   Epoch 10/10	 Time: 1.799	 Loss: 261.61972046
2024-10-28 11:29:16,097 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:29:16,097 - root - INFO - Final loss condition training = 6.033104095607996
2024-10-28 11:29:16,098 - root - INFO - Final loss condition validation = 0.45806309790350497
2024-10-28 11:29:16,098 - root - INFO - Training time: 17.983
2024-10-28 11:29:16,098 - root - INFO - Finished training.
2024-10-28 11:29:16,116 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:29:16,117 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:29:16,117 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:29:16,117 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:29:16,118 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:29:16,118 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:29:16,118 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:29:16,119 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:29:16,119 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:29:16,119 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:29:16,120 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:29:16,134 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:29:16,134 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:29:16,134 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:29:16,135 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:29:16,135 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:29:16,135 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:29:16,136 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:29:16,136 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:29:16,137 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:29:16,137 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:29:16,137 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:29:16,139 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:29:16,151 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:29:16,151 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:29:16,151 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:29:16,151 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:29:16,151 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:29:16,152 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:29:16,152 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:29:16,152 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:29:16,152 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:29:16,152 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:29:16,152 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:29:16,165 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:29:16,165 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:29:16,165 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:29:16,165 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:29:16,166 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:29:16,166 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:29:16,167 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:29:16,167 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:29:16,168 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:29:16,168 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:29:16,168 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:29:16,173 - root - INFO - Starting testing...
2024-10-28 11:29:16,238 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:29:17,178 - root - INFO - Testing time: 1.005
2024-10-28 11:29:17,178 - root - INFO - Finished testing.
2024-10-28 11:29:17,296 - weaver - INFO - [1mWritten output to training/Test/20241028//112852_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:29:17,309 - weaver - INFO - [1mWritten output to training/Test/20241028//112852_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:30:02,925 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:30:02,926 - root - INFO - Data path is ../data.
2024-10-28 11:30:02,926 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:30:02,926 - root - INFO - Dataset: ParT
2024-10-28 11:30:02,926 - root - INFO - Normal class: 0
2024-10-28 11:30:02,926 - root - INFO - Network: ParT
2024-10-28 11:30:02,926 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:30:02,926 - root - INFO - Nu-paramerter: 0.33
2024-10-28 11:30:02,979 - root - INFO - Computation device: cuda
2024-10-28 11:30:02,979 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:30:02,979 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:30:03,014 - root - INFO - Pretraining: False
2024-10-28 11:30:03,014 - root - INFO - Training optimizer: adam
2024-10-28 11:30:03,014 - root - INFO - Training learning rate: 0.00136959
2024-10-28 11:30:03,014 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:30:03,014 - root - INFO - Training batch size: 512
2024-10-28 11:30:03,014 - root - INFO - Training weight decay: 0.015102
2024-10-28 11:30:03,182 - root - INFO - Initializing center c...
2024-10-28 11:30:03,244 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:08,551 - root - INFO - Center c initialized.
2024-10-28 11:30:08,551 - root - INFO - Starting training...
2024-10-28 11:30:08,611 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:09,654 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:10,433 - root - INFO -   Epoch 1/10	 Time: 1.879	 Loss: 585.71191406
2024-10-28 11:30:10,493 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:11,439 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:12,226 - root - INFO -   Epoch 2/10	 Time: 1.793	 Loss: 4206.57714844
2024-10-28 11:30:12,287 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:13,203 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:13,991 - root - INFO -   Epoch 3/10	 Time: 1.764	 Loss: 2538.47070312
2024-10-28 11:30:14,051 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:14,966 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:15,753 - root - INFO -   Epoch 4/10	 Time: 1.762	 Loss: 2387.33496094
2024-10-28 11:30:15,813 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:16,706 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:17,491 - root - INFO -   Epoch 5/10	 Time: 1.738	 Loss: 1995.53710938
2024-10-28 11:30:17,551 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:18,487 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:19,279 - root - INFO -   Epoch 6/10	 Time: 1.787	 Loss: 1091.40026855
2024-10-28 11:30:19,338 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:20,280 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:21,067 - root - INFO -   Epoch 7/10	 Time: 1.788	 Loss: 675.27209473
2024-10-28 11:30:21,127 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:22,079 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:22,866 - root - INFO -   Epoch 8/10	 Time: 1.798	 Loss: 388.76159668
2024-10-28 11:30:22,926 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:23,867 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:24,648 - root - INFO -   Epoch 9/10	 Time: 1.782	 Loss: 231.19735718
2024-10-28 11:30:24,708 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:25,659 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:26,448 - root - INFO -   Epoch 10/10	 Time: 1.799	 Loss: 238.57157898
2024-10-28 11:30:26,448 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:30:26,448 - root - INFO - Final loss condition training = 54.37914718152024
2024-10-28 11:30:26,448 - root - INFO - Final loss condition validation = 481.8773933521006
2024-10-28 11:30:26,449 - root - INFO - Training time: 17.897
2024-10-28 11:30:26,449 - root - INFO - Finished training.
2024-10-28 11:30:26,467 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:30:26,467 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:30:26,467 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:30:26,468 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:30:26,468 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:30:26,468 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:30:26,469 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:30:26,469 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:30:26,469 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:30:26,470 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:30:26,470 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:30:26,484 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:30:26,484 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:30:26,484 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:30:26,485 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:30:26,485 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:30:26,486 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:30:26,486 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:30:26,486 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:30:26,487 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:30:26,487 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:30:26,487 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:30:26,488 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:30:26,500 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:30:26,500 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:30:26,500 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:30:26,501 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:30:26,501 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:30:26,501 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:30:26,502 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:30:26,502 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:30:26,502 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:30:26,502 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:30:26,503 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:30:26,515 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:30:26,515 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:30:26,515 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:30:26,516 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:30:26,517 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:30:26,517 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:30:26,517 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:30:26,517 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:30:26,518 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:30:26,518 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:30:26,518 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:30:26,522 - root - INFO - Starting testing...
2024-10-28 11:30:26,580 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:30:27,517 - root - INFO - Testing time: 0.995
2024-10-28 11:30:27,517 - root - INFO - Finished testing.
2024-10-28 11:30:27,636 - weaver - INFO - [1mWritten output to training/Test/20241028//113002_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:30:27,650 - weaver - INFO - [1mWritten output to training/Test/20241028//113002_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:30:37,838 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:30:37,838 - root - INFO - Data path is ../data.
2024-10-28 11:30:37,838 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:30:37,838 - root - INFO - Dataset: ParT
2024-10-28 11:30:37,838 - root - INFO - Normal class: 0
2024-10-28 11:30:37,838 - root - INFO - Network: ParT
2024-10-28 11:30:37,838 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:30:37,839 - root - INFO - Nu-paramerter: 1.00
2024-10-28 11:30:37,890 - root - INFO - Computation device: cuda
2024-10-28 11:30:37,891 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:30:37,891 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:30:37,926 - root - INFO - Pretraining: False
2024-10-28 11:30:37,926 - root - INFO - Training optimizer: adam
2024-10-28 11:30:37,926 - root - INFO - Training learning rate: 0.000961361
2024-10-28 11:30:37,926 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:30:37,926 - root - INFO - Training batch size: 512
2024-10-28 11:30:37,926 - root - INFO - Training weight decay: 3.27065e-07
2024-10-28 11:30:38,075 - root - INFO - Initializing center c...
2024-10-28 11:30:38,156 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:43,489 - root - INFO - Center c initialized.
2024-10-28 11:30:43,489 - root - INFO - Starting training...
2024-10-28 11:30:43,547 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:44,530 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:45,319 - root - INFO -   Epoch 1/10	 Time: 1.827	 Loss: 198.53950500
2024-10-28 11:30:45,380 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:46,334 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:47,129 - root - INFO -   Epoch 2/10	 Time: 1.809	 Loss: 1100.71423340
2024-10-28 11:30:47,190 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:48,146 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:48,944 - root - INFO -   Epoch 3/10	 Time: 1.814	 Loss: 643.96911621
2024-10-28 11:30:49,004 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:49,941 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:50,731 - root - INFO -   Epoch 4/10	 Time: 1.787	 Loss: 415.74060059
2024-10-28 11:30:50,793 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:51,728 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:52,526 - root - INFO -   Epoch 5/10	 Time: 1.794	 Loss: 329.45404053
2024-10-28 11:30:52,588 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:53,559 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:54,351 - root - INFO -   Epoch 6/10	 Time: 1.825	 Loss: 218.95767212
2024-10-28 11:30:54,413 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:55,374 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:56,169 - root - INFO -   Epoch 7/10	 Time: 1.817	 Loss: 138.80908203
2024-10-28 11:30:56,230 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:57,200 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:57,999 - root - INFO -   Epoch 8/10	 Time: 1.830	 Loss: 90.29293060
2024-10-28 11:30:58,059 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:59,008 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:30:59,801 - root - INFO -   Epoch 9/10	 Time: 1.801	 Loss: 61.07899857
2024-10-28 11:30:59,859 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:00,800 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:01,597 - root - INFO -   Epoch 10/10	 Time: 1.796	 Loss: 60.73517609
2024-10-28 11:31:01,597 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:31:01,597 - root - INFO - Final loss condition training = 0.11821389723627362
2024-10-28 11:31:01,597 - root - INFO - Final loss condition validation = 290.6435501995147
2024-10-28 11:31:01,598 - root - INFO - Training time: 18.109
2024-10-28 11:31:01,598 - root - INFO - Finished training.
2024-10-28 11:31:01,615 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:01,616 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:01,616 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:01,616 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:01,617 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:01,617 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:01,617 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:01,617 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:01,618 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:01,618 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:01,618 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:01,632 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:01,632 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:01,632 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:01,633 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:01,633 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:01,633 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:01,634 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:01,634 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:01,635 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:01,635 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:01,635 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:01,637 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:31:01,649 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:01,649 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:01,649 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:01,649 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:01,650 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:01,650 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:01,650 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:01,650 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:01,650 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:01,650 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:01,651 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:01,663 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:01,664 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:01,664 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:01,664 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:01,665 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:01,665 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:01,665 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:01,666 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:01,666 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:01,667 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:01,667 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:01,671 - root - INFO - Starting testing...
2024-10-28 11:31:01,731 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:31:02,675 - root - INFO - Testing time: 1.003
2024-10-28 11:31:02,675 - root - INFO - Finished testing.
2024-10-28 11:31:02,792 - weaver - INFO - [1mWritten output to training/Test/20241028//113037_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:31:02,806 - weaver - INFO - [1mWritten output to training/Test/20241028//113037_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:31:13,102 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:31:13,102 - root - INFO - Data path is ../data.
2024-10-28 11:31:13,102 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:31:13,102 - root - INFO - Dataset: ParT
2024-10-28 11:31:13,102 - root - INFO - Normal class: 0
2024-10-28 11:31:13,102 - root - INFO - Network: ParT
2024-10-28 11:31:13,102 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:31:13,102 - root - INFO - Nu-paramerter: 0.23
2024-10-28 11:31:13,153 - root - INFO - Computation device: cuda
2024-10-28 11:31:13,153 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:31:13,154 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:31:13,188 - root - INFO - Pretraining: False
2024-10-28 11:31:13,188 - root - INFO - Training optimizer: adam
2024-10-28 11:31:13,188 - root - INFO - Training learning rate: 1.63544e-05
2024-10-28 11:31:13,188 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:31:13,188 - root - INFO - Training batch size: 512
2024-10-28 11:31:13,188 - root - INFO - Training weight decay: 6.7768e-06
2024-10-28 11:31:13,343 - root - INFO - Initializing center c...
2024-10-28 11:31:13,405 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:18,668 - root - INFO - Center c initialized.
2024-10-28 11:31:18,668 - root - INFO - Starting training...
2024-10-28 11:31:18,725 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:19,768 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:20,536 - root - INFO -   Epoch 1/10	 Time: 1.865	 Loss: 906.46044922
2024-10-28 11:31:20,596 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:21,530 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:22,304 - root - INFO -   Epoch 2/10	 Time: 1.767	 Loss: 794.31970215
2024-10-28 11:31:22,365 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:23,307 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:24,080 - root - INFO -   Epoch 3/10	 Time: 1.775	 Loss: 702.81195068
2024-10-28 11:31:24,140 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:25,070 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:25,845 - root - INFO -   Epoch 4/10	 Time: 1.765	 Loss: 635.27917480
2024-10-28 11:31:25,907 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:26,824 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:27,598 - root - INFO -   Epoch 5/10	 Time: 1.752	 Loss: 570.51342773
2024-10-28 11:31:27,659 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:28,604 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:29,380 - root - INFO -   Epoch 6/10	 Time: 1.781	 Loss: 526.74060059
2024-10-28 11:31:29,442 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:30,383 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:31,162 - root - INFO -   Epoch 7/10	 Time: 1.781	 Loss: 484.50302124
2024-10-28 11:31:31,223 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:32,167 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:32,946 - root - INFO -   Epoch 8/10	 Time: 1.784	 Loss: 452.41845703
2024-10-28 11:31:33,007 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:33,949 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:34,731 - root - INFO -   Epoch 9/10	 Time: 1.784	 Loss: 423.38031006
2024-10-28 11:31:34,792 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:35,736 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:36,513 - root - INFO -   Epoch 10/10	 Time: 1.782	 Loss: 385.73486328
2024-10-28 11:31:36,514 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:31:36,514 - root - INFO - Final loss condition training = 1417.179663065821
2024-10-28 11:31:36,514 - root - INFO - Final loss condition validation = 366.4803598076105
2024-10-28 11:31:36,514 - root - INFO - Training time: 17.846
2024-10-28 11:31:36,514 - root - INFO - Finished training.
2024-10-28 11:31:36,532 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:36,532 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:36,532 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:36,533 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:36,533 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:36,533 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:36,534 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:36,534 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:36,535 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:36,535 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:36,536 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:36,550 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:36,550 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:36,550 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:36,550 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:36,551 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:36,551 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:36,551 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:36,552 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:36,552 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:36,552 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:36,552 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:36,553 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:31:36,566 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:36,566 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:36,566 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:36,567 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:36,567 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:36,567 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:36,567 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:36,567 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:36,567 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:36,568 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:36,568 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:36,580 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:31:36,580 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:31:36,580 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:31:36,581 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:31:36,581 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:31:36,581 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:31:36,582 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:31:36,582 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:31:36,583 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:31:36,583 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:31:36,583 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:31:36,588 - root - INFO - Starting testing...
2024-10-28 11:31:36,645 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:31:37,578 - root - INFO - Testing time: 0.990
2024-10-28 11:31:37,578 - root - INFO - Finished testing.
2024-10-28 11:31:37,700 - weaver - INFO - [1mWritten output to training/Test/20241028//113112_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:31:37,714 - weaver - INFO - [1mWritten output to training/Test/20241028//113112_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:31:47,639 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:31:47,639 - root - INFO - Data path is ../data.
2024-10-28 11:31:47,640 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:31:47,640 - root - INFO - Dataset: ParT
2024-10-28 11:31:47,640 - root - INFO - Normal class: 0
2024-10-28 11:31:47,640 - root - INFO - Network: ParT
2024-10-28 11:31:47,640 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:31:47,640 - root - INFO - Nu-paramerter: 0.81
2024-10-28 11:31:47,691 - root - INFO - Computation device: cuda
2024-10-28 11:31:47,691 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:31:47,691 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:31:47,726 - root - INFO - Pretraining: False
2024-10-28 11:31:47,726 - root - INFO - Training optimizer: adam
2024-10-28 11:31:47,726 - root - INFO - Training learning rate: 1.64352e-07
2024-10-28 11:31:47,726 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:31:47,726 - root - INFO - Training batch size: 512
2024-10-28 11:31:47,726 - root - INFO - Training weight decay: 3.62413e-07
2024-10-28 11:31:47,877 - root - INFO - Initializing center c...
2024-10-28 11:31:47,939 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:53,612 - root - INFO - Center c initialized.
2024-10-28 11:31:53,612 - root - INFO - Starting training...
2024-10-28 11:31:53,671 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:54,750 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:55,528 - root - INFO -   Epoch 1/10	 Time: 1.912	 Loss: 283.21365356
2024-10-28 11:31:55,589 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:56,536 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:57,316 - root - INFO -   Epoch 2/10	 Time: 1.787	 Loss: 282.99642944
2024-10-28 11:31:57,375 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:58,339 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:31:59,128 - root - INFO -   Epoch 3/10	 Time: 1.811	 Loss: 284.90005493
2024-10-28 11:31:59,189 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:00,137 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:00,924 - root - INFO -   Epoch 4/10	 Time: 1.795	 Loss: 260.32120467
2024-10-28 11:32:00,984 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:01,944 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:02,728 - root - INFO -   Epoch 5/10	 Time: 1.804	 Loss: 260.86972967
2024-10-28 11:32:02,789 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:03,751 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:04,535 - root - INFO -   Epoch 6/10	 Time: 1.806	 Loss: 258.16204740
2024-10-28 11:32:04,595 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:05,560 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:06,350 - root - INFO -   Epoch 7/10	 Time: 1.814	 Loss: 263.49336772
2024-10-28 11:32:06,411 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:07,376 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:08,158 - root - INFO -   Epoch 8/10	 Time: 1.807	 Loss: 263.50390591
2024-10-28 11:32:08,220 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:09,186 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:09,969 - root - INFO -   Epoch 9/10	 Time: 1.810	 Loss: 264.01772371
2024-10-28 11:32:10,031 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:10,995 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:11,780 - root - INFO -   Epoch 10/10	 Time: 1.811	 Loss: 260.27271044
2024-10-28 11:32:11,781 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:32:11,781 - root - INFO - Final loss condition training = 14.025124393996592
2024-10-28 11:32:11,781 - root - INFO - Final loss condition validation = 0.05544950046936021
2024-10-28 11:32:11,781 - root - INFO - Training time: 18.169
2024-10-28 11:32:11,782 - root - INFO - Finished training.
2024-10-28 11:32:11,799 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:11,799 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:11,799 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:11,800 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:11,800 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:11,801 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:11,801 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:11,801 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:11,802 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:11,802 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:11,803 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:11,817 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:11,817 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:11,817 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:11,818 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:11,818 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:11,818 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:11,819 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:11,819 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:11,820 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:11,820 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:11,820 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:11,821 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:32:11,833 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:11,833 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:11,833 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:11,834 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:11,834 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:11,835 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:11,835 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:11,836 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:11,836 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:11,836 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:11,837 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:11,849 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:11,849 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:11,850 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:11,850 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:11,851 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:11,851 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:11,852 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:11,852 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:11,852 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:11,853 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:11,853 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:11,858 - root - INFO - Starting testing...
2024-10-28 11:32:11,917 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:32:12,852 - root - INFO - Testing time: 0.994
2024-10-28 11:32:12,852 - root - INFO - Finished testing.
2024-10-28 11:32:12,966 - weaver - INFO - [1mWritten output to training/Test/20241028//113147_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:32:12,979 - weaver - INFO - [1mWritten output to training/Test/20241028//113147_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:32:23,292 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:32:23,292 - root - INFO - Data path is ../data.
2024-10-28 11:32:23,292 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:32:23,292 - root - INFO - Dataset: ParT
2024-10-28 11:32:23,292 - root - INFO - Normal class: 0
2024-10-28 11:32:23,292 - root - INFO - Network: ParT
2024-10-28 11:32:23,293 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:32:23,293 - root - INFO - Nu-paramerter: 0.31
2024-10-28 11:32:23,347 - root - INFO - Computation device: cuda
2024-10-28 11:32:23,348 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:32:23,348 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:32:23,394 - root - INFO - Pretraining: False
2024-10-28 11:32:23,394 - root - INFO - Training optimizer: adam
2024-10-28 11:32:23,395 - root - INFO - Training learning rate: 3.63885e-07
2024-10-28 11:32:23,395 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:32:23,395 - root - INFO - Training batch size: 512
2024-10-28 11:32:23,395 - root - INFO - Training weight decay: 0.0044997
2024-10-28 11:32:23,545 - root - INFO - Initializing center c...
2024-10-28 11:32:23,607 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:28,880 - root - INFO - Center c initialized.
2024-10-28 11:32:28,881 - root - INFO - Starting training...
2024-10-28 11:32:28,942 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:29,996 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:30,776 - root - INFO -   Epoch 1/10	 Time: 1.892	 Loss: 796.64642334
2024-10-28 11:32:30,837 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:31,790 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:32,580 - root - INFO -   Epoch 2/10	 Time: 1.804	 Loss: 804.43957520
2024-10-28 11:32:32,637 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:33,566 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:34,344 - root - INFO -   Epoch 3/10	 Time: 1.763	 Loss: 792.27691650
2024-10-28 11:32:34,406 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:35,351 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:36,133 - root - INFO -   Epoch 4/10	 Time: 1.789	 Loss: 806.46276855
2024-10-28 11:32:36,195 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:37,140 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:37,930 - root - INFO -   Epoch 5/10	 Time: 1.796	 Loss: 774.36059570
2024-10-28 11:32:37,993 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:38,937 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:39,720 - root - INFO -   Epoch 6/10	 Time: 1.789	 Loss: 802.23474121
2024-10-28 11:32:39,781 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:40,924 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:41,712 - root - INFO -   Epoch 7/10	 Time: 1.991	 Loss: 783.80993652
2024-10-28 11:32:41,769 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:42,716 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:43,495 - root - INFO -   Epoch 8/10	 Time: 1.783	 Loss: 786.74987793
2024-10-28 11:32:43,554 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:44,495 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:45,282 - root - INFO -   Epoch 9/10	 Time: 1.786	 Loss: 775.89794922
2024-10-28 11:32:45,344 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:46,303 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:32:47,084 - root - INFO -   Epoch 10/10	 Time: 1.802	 Loss: 770.99450684
2024-10-28 11:32:47,084 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:32:47,085 - root - INFO - Final loss condition training = 24.043747201561928
2024-10-28 11:32:47,085 - root - INFO - Final loss condition validation = 13.747511446475983
2024-10-28 11:32:47,085 - root - INFO - Training time: 18.204
2024-10-28 11:32:47,085 - root - INFO - Finished training.
2024-10-28 11:32:47,103 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:47,103 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:47,103 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:47,104 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:47,104 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:47,104 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:47,105 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:47,105 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:47,105 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:47,105 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:47,106 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:47,119 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:47,120 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:47,120 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:47,120 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:47,120 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:47,120 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:47,121 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:47,121 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:47,122 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:47,122 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:47,122 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:47,123 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:32:47,135 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:47,135 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:47,135 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:47,135 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:47,136 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:47,136 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:47,136 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:47,136 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:47,137 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:47,137 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:47,137 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:47,149 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:32:47,149 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:32:47,149 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:32:47,149 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:32:47,150 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:32:47,150 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:32:47,150 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:32:47,150 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:32:47,151 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:32:47,151 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:32:47,152 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:32:47,155 - root - INFO - Starting testing...
2024-10-28 11:32:47,215 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:32:48,156 - root - INFO - Testing time: 1.000
2024-10-28 11:32:48,156 - root - INFO - Finished testing.
2024-10-28 11:32:48,274 - weaver - INFO - [1mWritten output to training/Test/20241028//113223_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:32:48,287 - weaver - INFO - [1mWritten output to training/Test/20241028//113223_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:32:57,840 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:32:57,840 - root - INFO - Data path is ../data.
2024-10-28 11:32:57,840 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:32:57,840 - root - INFO - Dataset: ParT
2024-10-28 11:32:57,840 - root - INFO - Normal class: 0
2024-10-28 11:32:57,841 - root - INFO - Network: ParT
2024-10-28 11:32:57,841 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:32:57,841 - root - INFO - Nu-paramerter: 0.23
2024-10-28 11:32:57,895 - root - INFO - Computation device: cuda
2024-10-28 11:32:57,895 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:32:57,896 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:32:57,943 - root - INFO - Pretraining: False
2024-10-28 11:32:57,943 - root - INFO - Training optimizer: adam
2024-10-28 11:32:57,943 - root - INFO - Training learning rate: 8.96449e-07
2024-10-28 11:32:57,943 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:32:57,943 - root - INFO - Training batch size: 512
2024-10-28 11:32:57,943 - root - INFO - Training weight decay: 0.00252852
2024-10-28 11:32:58,103 - root - INFO - Initializing center c...
2024-10-28 11:32:58,165 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:03,456 - root - INFO - Center c initialized.
2024-10-28 11:33:03,456 - root - INFO - Starting training...
2024-10-28 11:33:03,513 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:04,564 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:05,342 - root - INFO -   Epoch 1/10	 Time: 1.883	 Loss: 1068.71655273
2024-10-28 11:33:05,403 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:06,348 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:07,137 - root - INFO -   Epoch 2/10	 Time: 1.794	 Loss: 1052.73132324
2024-10-28 11:33:07,197 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:08,140 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:08,928 - root - INFO -   Epoch 3/10	 Time: 1.791	 Loss: 1056.52331543
2024-10-28 11:33:08,987 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:09,937 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:10,725 - root - INFO -   Epoch 4/10	 Time: 1.796	 Loss: 1053.68542480
2024-10-28 11:33:10,786 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:11,731 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:12,518 - root - INFO -   Epoch 5/10	 Time: 1.793	 Loss: 1035.41870117
2024-10-28 11:33:12,578 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:13,511 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:14,297 - root - INFO -   Epoch 6/10	 Time: 1.779	 Loss: 1034.34399414
2024-10-28 11:33:14,359 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:15,306 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:16,093 - root - INFO -   Epoch 7/10	 Time: 1.795	 Loss: 1035.66247559
2024-10-28 11:33:16,154 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:17,101 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:17,893 - root - INFO -   Epoch 8/10	 Time: 1.800	 Loss: 1006.78472900
2024-10-28 11:33:17,955 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:18,910 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:19,702 - root - INFO -   Epoch 9/10	 Time: 1.809	 Loss: 1029.13745117
2024-10-28 11:33:19,763 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:20,731 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:21,521 - root - INFO -   Epoch 10/10	 Time: 1.818	 Loss: 997.62213135
2024-10-28 11:33:21,521 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:33:21,521 - root - INFO - Final loss condition training = 993.2153836227953
2024-10-28 11:33:21,522 - root - INFO - Final loss condition validation = 140.94170585647225
2024-10-28 11:33:21,522 - root - INFO - Training time: 18.066
2024-10-28 11:33:21,522 - root - INFO - Finished training.
2024-10-28 11:33:21,539 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:21,540 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:21,540 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:21,540 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:21,541 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:21,541 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:21,542 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:21,542 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:21,542 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:21,542 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:21,542 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:21,556 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:21,556 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:21,556 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:21,557 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:21,557 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:21,557 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:21,557 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:21,558 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:21,558 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:21,558 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:21,558 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:21,560 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:33:21,571 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:21,571 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:21,571 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:21,572 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:21,572 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:21,572 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:21,572 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:21,573 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:21,573 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:21,573 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:21,573 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:21,585 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:21,586 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:21,586 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:21,586 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:21,586 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:21,587 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:21,587 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:21,587 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:21,588 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:21,588 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:21,588 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:21,592 - root - INFO - Starting testing...
2024-10-28 11:33:21,651 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:33:22,587 - root - INFO - Testing time: 0.995
2024-10-28 11:33:22,588 - root - INFO - Finished testing.
2024-10-28 11:33:22,707 - weaver - INFO - [1mWritten output to training/Test/20241028//113257_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:33:22,719 - weaver - INFO - [1mWritten output to training/Test/20241028//113257_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:33:33,056 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:33:33,056 - root - INFO - Data path is ../data.
2024-10-28 11:33:33,056 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:33:33,056 - root - INFO - Dataset: ParT
2024-10-28 11:33:33,056 - root - INFO - Normal class: 0
2024-10-28 11:33:33,056 - root - INFO - Network: ParT
2024-10-28 11:33:33,056 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:33:33,056 - root - INFO - Nu-paramerter: 0.80
2024-10-28 11:33:33,108 - root - INFO - Computation device: cuda
2024-10-28 11:33:33,108 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:33:33,108 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:33:33,144 - root - INFO - Pretraining: False
2024-10-28 11:33:33,144 - root - INFO - Training optimizer: adam
2024-10-28 11:33:33,144 - root - INFO - Training learning rate: 6.35139e-06
2024-10-28 11:33:33,144 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:33:33,144 - root - INFO - Training batch size: 512
2024-10-28 11:33:33,144 - root - INFO - Training weight decay: 1.14472e-07
2024-10-28 11:33:33,299 - root - INFO - Initializing center c...
2024-10-28 11:33:33,362 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:39,488 - root - INFO - Center c initialized.
2024-10-28 11:33:39,488 - root - INFO - Starting training...
2024-10-28 11:33:39,548 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:40,603 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:41,388 - root - INFO -   Epoch 1/10	 Time: 1.897	 Loss: 247.07759094
2024-10-28 11:33:41,447 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:42,393 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:43,182 - root - INFO -   Epoch 2/10	 Time: 1.793	 Loss: 232.75851440
2024-10-28 11:33:43,245 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:44,187 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:44,977 - root - INFO -   Epoch 3/10	 Time: 1.795	 Loss: 222.68835449
2024-10-28 11:33:45,040 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:45,988 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:46,775 - root - INFO -   Epoch 4/10	 Time: 1.797	 Loss: 215.31282043
2024-10-28 11:33:46,837 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:47,786 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:48,574 - root - INFO -   Epoch 5/10	 Time: 1.799	 Loss: 205.91539001
2024-10-28 11:33:48,635 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:49,583 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:50,373 - root - INFO -   Epoch 6/10	 Time: 1.799	 Loss: 196.79122925
2024-10-28 11:33:50,434 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:51,382 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:52,171 - root - INFO -   Epoch 7/10	 Time: 1.797	 Loss: 190.65798950
2024-10-28 11:33:52,233 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:53,171 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:53,964 - root - INFO -   Epoch 8/10	 Time: 1.793	 Loss: 180.61436462
2024-10-28 11:33:54,025 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:54,969 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:55,759 - root - INFO -   Epoch 9/10	 Time: 1.794	 Loss: 175.30616760
2024-10-28 11:33:55,821 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:56,767 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:33:57,557 - root - INFO -   Epoch 10/10	 Time: 1.797	 Loss: 169.30192566
2024-10-28 11:33:57,557 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:33:57,557 - root - INFO - Final loss condition training = 36.050921314395964
2024-10-28 11:33:57,557 - root - INFO - Final loss condition validation = 8.91150401928462
2024-10-28 11:33:57,558 - root - INFO - Training time: 18.069
2024-10-28 11:33:57,558 - root - INFO - Finished training.
2024-10-28 11:33:57,576 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:57,576 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:57,576 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:57,577 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:57,577 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:57,577 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:57,577 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:57,578 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:57,578 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:57,578 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:57,578 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:57,592 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:57,592 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:57,592 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:57,593 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:57,593 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:57,593 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:57,594 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:57,594 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:57,594 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:57,595 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:57,595 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:57,596 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:33:57,608 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:57,608 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:57,608 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:57,609 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:57,609 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:57,609 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:57,609 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:57,609 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:57,610 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:57,610 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:57,610 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:57,622 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:33:57,622 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:33:57,622 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:33:57,623 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:33:57,624 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:33:57,624 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:33:57,624 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:33:57,624 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:33:57,625 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:33:57,625 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:33:57,625 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:33:57,629 - root - INFO - Starting testing...
2024-10-28 11:33:57,689 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:33:58,635 - root - INFO - Testing time: 1.006
2024-10-28 11:33:58,635 - root - INFO - Finished testing.
2024-10-28 11:33:58,753 - weaver - INFO - [1mWritten output to training/Test/20241028//113332_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:33:58,767 - weaver - INFO - [1mWritten output to training/Test/20241028//113332_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:34:08,396 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:34:08,396 - root - INFO - Data path is ../data.
2024-10-28 11:34:08,396 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:34:08,397 - root - INFO - Dataset: ParT
2024-10-28 11:34:08,397 - root - INFO - Normal class: 0
2024-10-28 11:34:08,397 - root - INFO - Network: ParT
2024-10-28 11:34:08,397 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:34:08,397 - root - INFO - Nu-paramerter: 0.72
2024-10-28 11:34:08,449 - root - INFO - Computation device: cuda
2024-10-28 11:34:08,449 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:34:08,449 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:34:08,484 - root - INFO - Pretraining: False
2024-10-28 11:34:08,484 - root - INFO - Training optimizer: adam
2024-10-28 11:34:08,484 - root - INFO - Training learning rate: 7.9594e-06
2024-10-28 11:34:08,484 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:34:08,485 - root - INFO - Training batch size: 512
2024-10-28 11:34:08,485 - root - INFO - Training weight decay: 0.000284192
2024-10-28 11:34:08,643 - root - INFO - Initializing center c...
2024-10-28 11:34:08,706 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:14,055 - root - INFO - Center c initialized.
2024-10-28 11:34:14,055 - root - INFO - Starting training...
2024-10-28 11:34:14,111 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:15,159 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:15,948 - root - INFO -   Epoch 1/10	 Time: 1.890	 Loss: 237.45646667
2024-10-28 11:34:16,009 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:16,962 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:17,749 - root - INFO -   Epoch 2/10	 Time: 1.801	 Loss: 223.81886292
2024-10-28 11:34:17,812 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:18,765 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:19,555 - root - INFO -   Epoch 3/10	 Time: 1.805	 Loss: 206.84457397
2024-10-28 11:34:19,618 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:20,569 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:21,360 - root - INFO -   Epoch 4/10	 Time: 1.805	 Loss: 193.76631165
2024-10-28 11:34:21,423 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:22,383 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:23,175 - root - INFO -   Epoch 5/10	 Time: 1.814	 Loss: 185.04884338
2024-10-28 11:34:23,236 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:24,195 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:24,992 - root - INFO -   Epoch 6/10	 Time: 1.816	 Loss: 180.22154236
2024-10-28 11:34:25,054 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:26,014 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:26,800 - root - INFO -   Epoch 7/10	 Time: 1.808	 Loss: 169.05317688
2024-10-28 11:34:26,859 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:27,796 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:28,584 - root - INFO -   Epoch 8/10	 Time: 1.783	 Loss: 163.93084717
2024-10-28 11:34:28,641 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:29,587 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:30,379 - root - INFO -   Epoch 9/10	 Time: 1.795	 Loss: 154.79830933
2024-10-28 11:34:30,441 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:31,406 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:32,199 - root - INFO -   Epoch 10/10	 Time: 1.820	 Loss: 148.73068237
2024-10-28 11:34:32,200 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:34:32,200 - root - INFO - Final loss condition training = 36.81609684228897
2024-10-28 11:34:32,200 - root - INFO - Final loss condition validation = 15.048281285911798
2024-10-28 11:34:32,201 - root - INFO - Training time: 18.145
2024-10-28 11:34:32,201 - root - INFO - Finished training.
2024-10-28 11:34:32,218 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:34:32,219 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:34:32,219 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:34:32,219 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:34:32,220 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:34:32,220 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:34:32,220 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:34:32,221 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:34:32,221 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:34:32,222 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:34:32,222 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:34:32,236 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:34:32,236 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:34:32,236 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:34:32,237 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:34:32,237 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:34:32,238 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:34:32,238 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:34:32,239 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:34:32,239 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:34:32,239 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:34:32,239 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:34:32,241 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:34:32,253 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:34:32,253 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:34:32,253 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:34:32,254 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:34:32,254 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:34:32,254 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:34:32,255 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:34:32,255 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:34:32,255 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:34:32,255 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:34:32,256 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:34:32,268 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:34:32,268 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:34:32,268 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:34:32,269 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:34:32,269 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:34:32,270 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:34:32,270 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:34:32,271 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:34:32,271 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:34:32,272 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:34:32,272 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:34:32,276 - root - INFO - Starting testing...
2024-10-28 11:34:32,335 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:34:33,274 - root - INFO - Testing time: 0.998
2024-10-28 11:34:33,274 - root - INFO - Finished testing.
2024-10-28 11:34:33,390 - weaver - INFO - [1mWritten output to training/Test/20241028//113408_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:34:33,405 - weaver - INFO - [1mWritten output to training/Test/20241028//113408_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:34:43,713 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:34:43,713 - root - INFO - Data path is ../data.
2024-10-28 11:34:43,713 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:34:43,713 - root - INFO - Dataset: ParT
2024-10-28 11:34:43,713 - root - INFO - Normal class: 0
2024-10-28 11:34:43,713 - root - INFO - Network: ParT
2024-10-28 11:34:43,713 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:34:43,714 - root - INFO - Nu-paramerter: 0.14
2024-10-28 11:34:43,766 - root - INFO - Computation device: cuda
2024-10-28 11:34:43,766 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:34:43,766 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:34:43,801 - root - INFO - Pretraining: False
2024-10-28 11:34:43,801 - root - INFO - Training optimizer: adam
2024-10-28 11:34:43,801 - root - INFO - Training learning rate: 3.37795e-05
2024-10-28 11:34:43,801 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:34:43,801 - root - INFO - Training batch size: 512
2024-10-28 11:34:43,802 - root - INFO - Training weight decay: 1.33018e-07
2024-10-28 11:34:43,957 - root - INFO - Initializing center c...
2024-10-28 11:34:44,052 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:50,147 - root - INFO - Center c initialized.
2024-10-28 11:34:50,148 - root - INFO - Starting training...
2024-10-28 11:34:50,203 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:51,263 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:52,046 - root - INFO -   Epoch 1/10	 Time: 1.895	 Loss: 1105.14562988
2024-10-28 11:34:52,105 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:53,062 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:53,855 - root - INFO -   Epoch 2/10	 Time: 1.809	 Loss: 863.24291992
2024-10-28 11:34:53,916 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:54,868 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:55,657 - root - INFO -   Epoch 3/10	 Time: 1.801	 Loss: 717.86669922
2024-10-28 11:34:55,718 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:56,679 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:57,465 - root - INFO -   Epoch 4/10	 Time: 1.808	 Loss: 601.31781006
2024-10-28 11:34:57,526 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:58,488 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:34:59,276 - root - INFO -   Epoch 5/10	 Time: 1.810	 Loss: 521.09765625
2024-10-28 11:34:59,337 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:00,304 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:01,097 - root - INFO -   Epoch 6/10	 Time: 1.821	 Loss: 455.22109985
2024-10-28 11:35:01,159 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:02,114 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:02,906 - root - INFO -   Epoch 7/10	 Time: 1.808	 Loss: 408.98950195
2024-10-28 11:35:02,968 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:03,937 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:04,733 - root - INFO -   Epoch 8/10	 Time: 1.826	 Loss: 362.56890869
2024-10-28 11:35:04,795 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:05,762 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:06,550 - root - INFO -   Epoch 9/10	 Time: 1.816	 Loss: 324.20880127
2024-10-28 11:35:06,611 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:07,574 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:08,369 - root - INFO -   Epoch 10/10	 Time: 1.819	 Loss: 300.31918335
2024-10-28 11:35:08,370 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:35:08,370 - root - INFO - Final loss condition training = 570.7138443598524
2024-10-28 11:35:08,370 - root - INFO - Final loss condition validation = 539.749680169858
2024-10-28 11:35:08,370 - root - INFO - Training time: 18.222
2024-10-28 11:35:08,370 - root - INFO - Finished training.
2024-10-28 11:35:08,388 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:08,388 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:08,388 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:08,388 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:08,388 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:08,389 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:08,389 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:08,389 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:08,390 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:08,390 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:08,391 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:08,404 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:08,405 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:08,405 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:08,405 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:08,406 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:08,406 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:08,406 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:08,407 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:08,407 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:08,407 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:08,408 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:08,409 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:35:08,420 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:08,420 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:08,421 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:08,421 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:08,421 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:08,421 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:08,421 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:08,421 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:08,422 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:08,422 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:08,422 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:08,435 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:08,435 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:08,435 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:08,436 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:08,436 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:08,436 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:08,437 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:08,437 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:08,438 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:08,438 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:08,438 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:08,443 - root - INFO - Starting testing...
2024-10-28 11:35:08,501 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:35:09,441 - root - INFO - Testing time: 0.999
2024-10-28 11:35:09,442 - root - INFO - Finished testing.
2024-10-28 11:35:09,559 - weaver - INFO - [1mWritten output to training/Test/20241028//113443_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:35:09,571 - weaver - INFO - [1mWritten output to training/Test/20241028//113443_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-28 11:35:19,397 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-28 11:35:19,397 - root - INFO - Data path is ../data.
2024-10-28 11:35:19,398 - root - INFO - Export path is ../log/mnist_test.
2024-10-28 11:35:19,398 - root - INFO - Dataset: ParT
2024-10-28 11:35:19,398 - root - INFO - Normal class: 0
2024-10-28 11:35:19,398 - root - INFO - Network: ParT
2024-10-28 11:35:19,398 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-28 11:35:19,398 - root - INFO - Nu-paramerter: 0.62
2024-10-28 11:35:19,450 - root - INFO - Computation device: cuda
2024-10-28 11:35:19,450 - root - INFO - Number of dataloader workers: 0
2024-10-28 11:35:19,451 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-28 11:35:19,485 - root - INFO - Pretraining: False
2024-10-28 11:35:19,486 - root - INFO - Training optimizer: adam
2024-10-28 11:35:19,486 - root - INFO - Training learning rate: 2.71824e-07
2024-10-28 11:35:19,486 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-28 11:35:19,486 - root - INFO - Training batch size: 512
2024-10-28 11:35:19,486 - root - INFO - Training weight decay: 3.43407e-07
2024-10-28 11:35:19,638 - root - INFO - Initializing center c...
2024-10-28 11:35:19,734 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:25,034 - root - INFO - Center c initialized.
2024-10-28 11:35:25,034 - root - INFO - Starting training...
2024-10-28 11:35:25,092 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:26,161 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:26,941 - root - INFO -   Epoch 1/10	 Time: 1.904	 Loss: 382.35922241
2024-10-28 11:35:27,003 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:27,952 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:28,739 - root - INFO -   Epoch 2/10	 Time: 1.797	 Loss: 379.12966919
2024-10-28 11:35:28,800 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:29,747 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:30,531 - root - INFO -   Epoch 3/10	 Time: 1.791	 Loss: 380.16516113
2024-10-28 11:35:30,592 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:31,537 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:32,320 - root - INFO -   Epoch 4/10	 Time: 1.788	 Loss: 382.64227295
2024-10-28 11:35:32,381 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:33,328 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:34,114 - root - INFO -   Epoch 5/10	 Time: 1.794	 Loss: 387.65017700
2024-10-28 11:35:34,176 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:35,082 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:35,866 - root - INFO -   Epoch 6/10	 Time: 1.752	 Loss: 370.83767700
2024-10-28 11:35:35,927 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:36,866 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:37,649 - root - INFO -   Epoch 7/10	 Time: 1.782	 Loss: 375.37722778
2024-10-28 11:35:37,710 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:38,658 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:39,440 - root - INFO -   Epoch 8/10	 Time: 1.790	 Loss: 374.62649536
2024-10-28 11:35:39,500 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:40,449 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:41,231 - root - INFO -   Epoch 9/10	 Time: 1.790	 Loss: 372.87826538
2024-10-28 11:35:41,292 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:42,241 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-28 11:35:43,026 - root - INFO -   Epoch 10/10	 Time: 1.795	 Loss: 373.61984253
2024-10-28 11:35:43,027 - root - INFO - Algorithm failed: not done learning in max = 10 epochs
2024-10-28 11:35:43,027 - root - INFO - Final loss condition training = 0.5499366670846939
2024-10-28 11:35:43,027 - root - INFO - Final loss condition validation = 9.896331363357604
2024-10-28 11:35:43,027 - root - INFO - Training time: 17.993
2024-10-28 11:35:43,027 - root - INFO - Finished training.
2024-10-28 11:35:43,045 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:43,045 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:43,045 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:43,045 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:43,046 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:43,046 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:43,046 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:43,047 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:43,047 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:43,047 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:43,047 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:43,061 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:43,061 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:43,061 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:43,062 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:43,062 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:43,062 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:43,063 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:43,063 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:43,063 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:43,064 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:43,064 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:43,066 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-28 11:35:43,077 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:43,077 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:43,078 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:43,078 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:43,078 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:43,079 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:43,079 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:43,080 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:43,080 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:43,080 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:43,081 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:43,093 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-28 11:35:43,093 - weaver - INFO - [0;37mselection: None[0m
2024-10-28 11:35:43,093 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-28 11:35:43,094 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-28 11:35:43,094 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-28 11:35:43,094 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-28 11:35:43,095 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-28 11:35:43,095 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-28 11:35:43,095 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-28 11:35:43,096 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-28 11:35:43,096 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-28 11:35:43,100 - root - INFO - Starting testing...
2024-10-28 11:35:43,158 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-28 11:35:44,098 - root - INFO - Testing time: 0.998
2024-10-28 11:35:44,098 - root - INFO - Finished testing.
2024-10-28 11:35:44,231 - weaver - INFO - [1mWritten output to training/Test/20241028//113519_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-28 11:35:44,244 - weaver - INFO - [1mWritten output to training/Test/20241028//113519_ranger_lr0.005_batch512/predict_output/test_results.root[0m
2024-10-29 10:13:56,523 - root - INFO - Log file is ../log/mnist_test/log.txt.
2024-10-29 10:13:56,523 - root - INFO - Data path is ../data.
2024-10-29 10:13:56,523 - root - INFO - Export path is ../log/mnist_test.
2024-10-29 10:13:56,524 - root - INFO - Dataset: ParT
2024-10-29 10:13:56,524 - root - INFO - Normal class: 0
2024-10-29 10:13:56,525 - root - INFO - Network: ParT
2024-10-29 10:13:56,525 - root - INFO - Deep SVDD objective: soft-boundary
2024-10-29 10:13:56,526 - root - INFO - Nu-paramerter: 0.02
2024-10-29 10:13:56,581 - root - INFO - Computation device: cuda
2024-10-29 10:13:56,581 - root - INFO - Number of dataloader workers: 0
2024-10-29 10:13:56,582 - weaver - INFO - cfg_block: {'embed_dim': 128, 'num_heads': 8, 'ffn_ratio': 4, 'dropout': 0.1, 'attn_dropout': 0.1, 'activation_dropout': 0.1, 'add_bias_kv': False, 'activation': 'gelu', 'scale_fc': True, 'scale_attn': True, 'scale_heads': True, 'scale_resids': True}
2024-10-29 10:13:56,617 - root - INFO - Pretraining: False
2024-10-29 10:13:56,617 - root - INFO - Training optimizer: adam
2024-10-29 10:13:56,617 - root - INFO - Training learning rate: 0.0001
2024-10-29 10:13:56,618 - root - INFO - Training learning rate scheduler milestones: [50]
2024-10-29 10:13:56,618 - root - INFO - Training batch size: 512
2024-10-29 10:13:56,619 - root - INFO - Training weight decay: 5e-07
2024-10-29 10:13:56,796 - root - INFO - Initializing center c...
2024-10-29 10:13:56,859 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:02,178 - root - INFO - Center c initialized.
2024-10-29 10:14:02,178 - root - INFO - Starting training...
2024-10-29 10:14:02,230 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:06,960 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:07,730 - root - INFO -   Epoch 1/22	 Time: 5.549	 Loss: 3280.69650065
2024-10-29 10:14:07,789 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:12,419 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:13,194 - root - INFO -   Epoch 2/22	 Time: 5.463	 Loss: 975.43307292
2024-10-29 10:14:13,253 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:17,915 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:18,692 - root - INFO -   Epoch 3/22	 Time: 5.498	 Loss: 654.71827393
2024-10-29 10:14:18,753 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:23,413 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:24,190 - root - INFO -   Epoch 4/22	 Time: 5.497	 Loss: 529.86731974
2024-10-29 10:14:24,250 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:28,920 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:29,703 - root - INFO -   Epoch 5/22	 Time: 5.512	 Loss: 458.36017049
2024-10-29 10:14:29,763 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:34,425 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:35,210 - root - INFO -   Epoch 6/22	 Time: 5.506	 Loss: 415.44344482
2024-10-29 10:14:35,269 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:39,939 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:40,718 - root - INFO -   Epoch 7/22	 Time: 5.507	 Loss: 388.32208455
2024-10-29 10:14:40,781 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:45,423 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:46,194 - root - INFO -   Epoch 8/22	 Time: 5.476	 Loss: 366.03030802
2024-10-29 10:14:46,253 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:50,918 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:51,693 - root - INFO -   Epoch 9/22	 Time: 5.498	 Loss: 345.84155477
2024-10-29 10:14:51,752 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:56,419 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:14:57,189 - root - INFO -   Epoch 10/22	 Time: 5.496	 Loss: 328.50052897
2024-10-29 10:14:57,249 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:01,947 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:02,724 - root - INFO -   Epoch 11/22	 Time: 5.534	 Loss: 317.16567586
2024-10-29 10:15:02,789 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:07,416 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:08,190 - root - INFO -   Epoch 12/22	 Time: 5.466	 Loss: 304.49931641
2024-10-29 10:15:08,249 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:12,911 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:13,692 - root - INFO -   Epoch 13/22	 Time: 5.501	 Loss: 292.43806763
2024-10-29 10:15:13,752 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:18,401 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:19,179 - root - INFO -   Epoch 14/22	 Time: 5.486	 Loss: 281.64692993
2024-10-29 10:15:19,238 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:23,898 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:24,666 - root - INFO -   Epoch 15/22	 Time: 5.487	 Loss: 272.76801147
2024-10-29 10:15:24,727 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:29,401 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:30,178 - root - INFO -   Epoch 16/22	 Time: 5.511	 Loss: 266.07639364
2024-10-29 10:15:30,237 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:34,894 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:35,673 - root - INFO -   Epoch 17/22	 Time: 5.494	 Loss: 257.73496501
2024-10-29 10:15:35,736 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:40,358 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:41,140 - root - INFO -   Epoch 18/22	 Time: 5.466	 Loss: 250.45651550
2024-10-29 10:15:41,206 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:45,821 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:46,597 - root - INFO -   Epoch 19/22	 Time: 5.457	 Loss: 243.86363322
2024-10-29 10:15:46,653 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:51,271 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:52,051 - root - INFO -   Epoch 20/22	 Time: 5.453	 Loss: 237.56859029
2024-10-29 10:15:52,112 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:56,763 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:15:57,537 - root - INFO -   Epoch 21/22	 Time: 5.485	 Loss: 231.62982381
2024-10-29 10:15:57,598 - weaver - INFO - Restarted DataIter train_worker0, load_range=(0.0, 0.8889), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:16:02,244 - weaver - INFO - Restarted DataIter val_worker0, load_range=(0.8889, 1.0), file_list:
{
  "_": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Train_klein.root"
  ]
}
2024-10-29 10:16:03,021 - root - INFO -   Epoch 22/22	 Time: 5.483	 Loss: 227.44465027
2024-10-29 10:16:03,021 - root - INFO - Algorithm failed: not done learning in max = 22 epochs
2024-10-29 10:16:03,022 - root - INFO - Final loss condition training = 17.515677587490305
2024-10-29 10:16:03,022 - root - INFO - Final loss condition validation = 39.11248851660639
2024-10-29 10:16:03,027 - root - INFO - Training time: 120.846
2024-10-29 10:16:03,027 - root - INFO - Finished training.
2024-10-29 10:16:03,053 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-29 10:16:03,054 - weaver - INFO - [0;37mselection: None[0m
2024-10-29 10:16:03,054 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-29 10:16:03,054 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-29 10:16:03,055 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-29 10:16:03,055 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-29 10:16:03,055 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-29 10:16:03,056 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-29 10:16:03,056 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-29 10:16:03,056 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-29 10:16:03,057 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-29 10:16:03,070 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-29 10:16:03,070 - weaver - INFO - [0;37mselection: None[0m
2024-10-29 10:16:03,070 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-29 10:16:03,070 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-29 10:16:03,071 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-29 10:16:03,071 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-29 10:16:03,071 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-29 10:16:03,072 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-29 10:16:03,072 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-29 10:16:03,073 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-29 10:16:03,073 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-29 10:16:03,074 - weaver - INFO - Running on test file group  with 1 files:
.../data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root
2024-10-29 10:16:03,086 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-29 10:16:03,086 - weaver - INFO - [0;37mselection: None[0m
2024-10-29 10:16:03,086 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-29 10:16:03,087 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-29 10:16:03,087 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-29 10:16:03,087 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-29 10:16:03,088 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-29 10:16:03,088 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-29 10:16:03,088 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-29 10:16:03,089 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-29 10:16:03,089 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-29 10:16:03,101 - weaver - INFO - [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 0.5, 'params': None}[0m
2024-10-29 10:16:03,101 - weaver - INFO - [0;37mselection: None[0m
2024-10-29 10:16:03,102 - weaver - INFO - [0;37mtest_time_selection: None[0m
2024-10-29 10:16:03,102 - weaver - INFO - [0;37mvar_funcs:
 - ('part_mask', 'ak.ones_like(part_deta)')
 - ('part_pt', 'np.hypot(part_px, part_py)')
 - ('part_pt_log', 'np.log(part_pt)')
 - ('part_e_log', 'np.log(part_energy)')
 - ('part_logptrel', 'np.log(part_pt/jet_pt)')
 - ('part_logerel', 'np.log(part_energy/jet_energy)')
 - ('part_deltaR', 'np.hypot(part_deta, part_dphi)')
 - ('jet_isQ', 'label')
 - ('jet_isG', '1-label')
 - ('_label_', 'np.argmax(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(jet_isQ),ak.to_numpy(jet_isG)], axis=1), axis=1)')[0m
2024-10-29 10:16:03,103 - weaver - INFO - [0;37minput_names: ('pf_features', 'pf_vectors', 'pf_mask')[0m
2024-10-29 10:16:03,103 - weaver - INFO - [0;37minput_dicts:
 - ('pf_features', ['part_pt_log', 'part_e_log', 'part_logptrel', 'part_logerel', 'part_deltaR', 'part_deta', 'part_dphi'])
 - ('pf_vectors', ['part_px', 'part_py', 'part_pz', 'part_energy'])
 - ('pf_mask', ['part_mask'])[0m
2024-10-29 10:16:03,103 - weaver - INFO - [0;37minput_shapes:
 - ('pf_features', (-1, 7, 64))
 - ('pf_vectors', (-1, 4, 64))
 - ('pf_mask', (-1, 1, 64))[0m
2024-10-29 10:16:03,103 - weaver - INFO - [0;37mpreprocess_params:
 - ('part_pt_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_e_log', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logptrel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_logerel', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deltaR', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_deta', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_dphi', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_px', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_py', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_pz', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_energy', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('part_mask', {'length': 64, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
2024-10-29 10:16:03,104 - weaver - INFO - [0;37mlabel_names: ('_label_',)[0m
2024-10-29 10:16:03,104 - weaver - INFO - [0;37mobserver_names: ('nparticles', 'width', 'jet_mass', 'jet_phi', 'jet_pt', 'jet_eta')[0m
2024-10-29 10:16:03,105 - weaver - INFO - [0;37mmonitor_variables: ()[0m
2024-10-29 10:16:03,109 - root - INFO - Starting testing...
2024-10-29 10:16:03,166 - weaver - INFO - Restarted DataIter test__worker0, load_range=(0, 1), file_list:
{
  "": [
    "/data/alice/tqwsavelkoel/soft/JetToyHI/Data_Test_klein.root"
  ]
}
2024-10-29 10:16:04,105 - root - INFO - Testing time: 0.996
2024-10-29 10:16:04,105 - root - INFO - Finished testing.
2024-10-29 10:16:04,247 - weaver - INFO - [1mWritten output to training/Test/20241029//101356_ranger_lr0.005_batch512/predict_output/train_results.root[0m
2024-10-29 10:16:04,260 - weaver - INFO - [1mWritten output to training/Test/20241029//101356_ranger_lr0.005_batch512/predict_output/test_results.root[0m
